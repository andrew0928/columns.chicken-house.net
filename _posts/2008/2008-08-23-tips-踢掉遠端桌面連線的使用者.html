---
layout: post
title: "Tips: 踢掉遠端桌面連線的使用者"
categories:
- "Tips"
- "有的沒的"
tags: ["Tips","有的沒的"]
published: true
comments: true
permalink: "/2008/08/22/tips-踢掉遠端桌面連線的使用者/"
redirect_from:
  - /columns/post/2008/08/23/Tips-TSDISCON.aspx/
  - /post/2008/08/23/Tips-TSDISCON.aspx/
  - /post/Tips-TSDISCON.aspx/
  - /columns/2008/08/23/Tips-TSDISCON.aspx/
  - /columns/Tips-TSDISCON.aspx/
wordpress_postid: 78
---
<p>
近日同事連不進 SERVER，因為連線人數已滿，又摸不到本機，正在那邊苦惱...。原來大家都知道怎麼連，但是都不知道怎麼砍人... 。從 windows 2000 開始就有 RDP 可以用了，當時學到的一個指令一直到現在都可以用，就藉這個機會貼一下。 
</p>
<p>
什麼秘技都一樣，說穿了就不值錢。半年前貼了一篇 [<a href="/post/Tips-e981a0e7abafe6a18ce99da2e980a3e7b79ae79a84e5b08fe68a80e5b7a7.aspx">遠端桌面連線的小技巧</a>]，裡面講到加上 /console 這參數就能連到 console session，不會跟其它人去搶那兩個連線，就可以把不順眼的 USER 砍了。連進去後要砍人很簡單，工作管理員叫出來，最後一頁 [USER] 就會列出有多少人掛在上面... 
</p>
<p>
<img style="border: 0px" src="/wp-content/be-files/WindowsLiveWriter/Tips_D86B/image_5.png" border="0" alt="image" width="511" height="242" /> 
</p>
<p>
通常這樣就能解決 90% 的問題了。如果連這個秘密連線都被用掉了，那只剩另一招: TSDISCON.exe 
</p>
<p>
&nbsp;
</p>
<p>
<img style="border: 0px" src="/wp-content/be-files/WindowsLiveWriter/Tips_D86B/image_6.png" border="0" alt="image" width="660" height="257" /> 
</p>
<p>
TSDISCON: Disconnects a terminal session. 讚! 就是要這種東西... 用法很簡單，如果你有遠端 SERVER 的管理者權限，防火牆又沒把 NETBIOS 關掉，那麼可以這樣用: 
</p>
<p>
&nbsp;
</p>
<ol>
	<li>先登入遠端 server<br />
	NET USE <a href="file://\\MYSERVER">\\MYSERVER</a> /user:MYACCOUNT *</li>
	<li>踢掉其它人<br />
	TSDISCON 1 /SERVER:MYSERVER</li>
</ol>
<p>
BINGO，其中要注意一下就是 SESSION ID，也就是上面工作管理員 ID 那一欄。0 代表 console，其它就是額外的連線。不過除非你有另外買 LICENCE，否則 OS 內建的授權只有兩個連線，意思就是亂猜一通，1 跟 2 隨便挑一個砍了就好... 
</p>
<p>
指令成功的話，被你挑中的連線就會中斷了。趁對方還沒重新連上去之前，快點連進去佔名額吧 :D 
</p>
