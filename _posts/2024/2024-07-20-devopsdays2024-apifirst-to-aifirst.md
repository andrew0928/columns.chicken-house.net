---
layout: post
title: "從 API First 到 AI First"
categories:
- "系列文章: 架構師的修練"
tags: []
published: false
comments_disqus: false
comments_facebook: false
comments_gitalk: false
redirect_from:
logo: 
---

這篇的內容，主要就是我在今年的 DevOpsDays Taipei 2024 擔任 Keynoye 講的內容。 半年前我花了些時間在研究的 LLM Application, 寫了三篇落落長的文章, 這次投稿, 我想延續 2022, 2023 談的 "API First", 延伸到 AI 應用程式開發，剛好 API / AI 只差一個字，就用了這標題來聊聊這內容。

Generative AI 爆紅後, 各行各業, 流程的每個環節, 大家都在想怎麼善用 AI 可以帶來改變, 頓時間所有資訊都爆量, 大家都不曉得哪一條路才是正確的 (這不就是機會所在嗎)，對我這種軟體開發領域的人，我看的是 AI 是個強而有力的元件，要掌握清楚它的特性，你才有機會在你的應用程式好好的利用他，這也是過去這半年我下班時間都在摸索的事情。我試過好幾種想法，那段時間 Chat GPT plus 的額度每天都被我用光了 (前陣子準備簡報時也差不多)，也算是有點心得了。

整篇的心得，其實摘要起來只有一段話，就是: 

> 未來 AI 充分運用在各個領域的年代，你現在的軟體開發基礎只會越來越重要 (不會不見，不用擔心)。
> 要確保未來 AI 盛行的世代還保有競爭力，請把基礎的功夫做好。

我這篇是拿 API 當作案例 (因為 API 最有代表性)，未來 AI 大量使用，你的 API 可能會被更多 "AI Agent" 呼叫。決勝的關鍵就在於 AI 需不需要你的服務? 當他需要時你的服務品質夠不夠好? 目前 AI 的推理能力仍然跟真人有好一段距離，因此你的 API 設計是否夠乾淨簡潔，清楚明確，讓 AI 知道怎麼正確使用，將會是接下來這幾年 (直到 AI 真的夠聰明為止) 的重要關鍵。

現在的生成式 AI 可以補足很多瑣碎的事務 (我會示範)，因此你的服務也該轉移，可以比以前更專注在核心事務身上。這時 AI 的應用將會是個照妖鏡，會凸顯出你沒有確實做好的基礎環節。如果你想在 AI 世代維持競爭力，請好好思考這些問題。

不過這次要聊的東西有點多 (AI 帶來的改變太大了，每個環節其實都有顛覆過去的作法)，當天其實略過了不少我認為很重要的環節。不過這就是寫部落格文章的好處，沒人限制我篇幅啊 (喂...)，趁著記憶猶新，也有現成的投影片，我就來補完這些遺珠之憾，於是就有了這篇文章...。我就不囉嗦了，直接開始看內容吧~

<!--more-->


# 1. 寫在前面

// P2

演講時的 Agenda, 我花了 5 分鐘做前情提要，摘要的說了 2023, 2022 都談了些什麼, 不過這些我在這邊就跳過了，我直接給參考資料，有興趣的朋友自己看，我這篇就只講正題就好。

這整篇文章，我打算用實際的 demo (主要是 GPTs 的形式，因為它最方便散播我的 POC 讓大家體驗) 來帶出我想談的幾個議題，都是讓各位了解未來 AI 大量應用在產品內的時候，會有哪些基本層面的改變。

我想帶的主題有這幾個:

1. 自然語言帶來的 UX 改變 ( demo #1 )
1. (延伸) 體驗改善之外, 也能更直接的掌握使用者的滿意度; 也能更精準地做到個人化 ( demo #2 )
1. AI 作為輔助的角色 ( copilot ), LLM 必須與應用程式高度整合，開發人員該掌握的基本設計技巧 ( demo #3 )
1. 最後, 帶出 AI 處理資料的基本技巧 ( demo #4 )

demo 的過程，我會穿插說明背後用到的技巧，觀念的改變，以及未來開發人員該掌握的新時代基礎能力。後面我會帶我老闆 Happy 在 Generative AI 年會 ( 2024 / 05 ) 他的場次，說明零售業該如何應用 AI 的案例，來跟果提到的幾個觀念搭配說明。你會發現，原來活生生的應用案例，就是這樣跟基礎的技術發展搭配起來的。

在演講的當下，我覺得很可惜的一點就是: 實際應用案例這段，因為時間關係我沒有機會補充說明，兩者的關聯才是最重要的環節。因此，我就在文章把這些關聯補上來了。如果你有聽過我 DevOpsDaysTaipei 的演講，我也建議你再看一次這篇文章，我相信你會多看到 (體會) 到不一樣的內容。


// P5

Generative AI 對大部分的軟體開發人員 (除了本來就在鑽研 AI 相關領域的之外) 而言，都算是新東西。面對新東西，社群與新聞媒體的討論自然也很熱烈。不過我很在意其中一點，就是在社群與媒體上，大家討論的熱度都集中在: 

1. 各種主流 LLM 的評比與介紹
1. 各硬體大廠 AI 算力的提升 (GPU / NPU 等) 的進步
1. 各種生成式工具的介紹，使用技巧 ( ChatGPT, Stable Diffusion 等 )

仔細想想，這些類型的討論，都還沒直接面對: "AI 真正變成軟體開發的重要元件，成為軟體開發中的重要一環" 這願景啊。模型、算力、工具都快速發展中，不過應用到軟體這環節卻還遠遠落後 (不是，話說 GAI 真正讓全世界跌破眼鏡也才一年多，軟體發展的步調沒那麼快啊)。

這些問題，我逐一反問自己:
1. 模型越來越強: 我需要訓練自己的模型嗎? 如果業界的模型成熟到某一個程度，我知道我該拿它來幹嘛嗎?
1. GPU / NPU 等運算能力越來越強，等到算力普及了 ( 雲端的 token 夠便宜、雲端的 GPU 算力夠便宜、終端的 NPU 夠普及 )，我想好我的產品或服務該如何運用它了嗎?
1. 工具的成熟: 現在的 AI 相關工具，都在強化 "你" 自身的能力，但你準備好寫未來需要的 code 了嗎? (不是寫現在的 code 寫 10x 快)

做到這樣，才是我心裡認定的 "AI 世代"，各位軟體開發人員都是重要的一環，你們能充分掌握 AI 世代的基礎，並應用在你們的服務上，這才能推動真正的變革。這才是我這主題真正想聊的。AI 是個強力的武器，LLM 是個有效的通用元件，你必須先掌握他的能力，你才知道在你的系統架構裡該把它擺在哪裡，這才是軟體架構師該做的事情。

如果你能理解我的想法，那就繼續往下看吧! 




# 2. 示範案例: 安德魯小舖 GPTs

有看過我前面幾篇文章的朋友，應該對 "安德魯小舖 GPTs" 不陌生吧! 時隔半年，基本結構沒有太大改變，但是我多嘗試了幾種應用方式。基本能力介紹我就不再多說，有興趣的可以參考這一篇，第一段我都在介紹這個應用:

* [架構師觀點 - 開發人員該如何看待 AI 帶來的改變?](/2024/01/15/archview-llm/)


## Demo #1, 出一張嘴就能買東西的魔法

不過，DEMO 我還是有重新安排啦，為了方便在 Keynote 當下展示，我預先錄好了影片，也做了一頁簡報說明案例，大家可以對照看。簡報左邊我標上影片的時間跟對應的案例情境，右邊則是實際的影片播放。

// P15

我想傳達的情境，其實都寫在這頁簡報左邊了。我背後的想法只有一個，就是 GPTs 已能用對話 (自然語言) 的介面，讓使用者能用口語的方式真正的 "要求" AI 處理購物需求了。我想像中的 "要求" 跟 "下指令" 是不同的兩種概念，如果你看完這段影片，你應該會理解我的差別。

所謂的 "要求"，就是影片示範，我說我想買什麼 (我說明的是我的意圖)，而 AI 替我轉譯成對應的動作 (就是 API call)，自動替我完成目的。案例中我講了預算跟目的，GPTs 替我計算後挑選商品加入購物車並結帳；替我改變適合我觀看的資訊呈列方式；替我用我希望的方式整理資訊 (按照商品統計) 後呈現等等都算。

而所謂的 "下指令"，則少了翻譯意圖這層，我自己要很清楚我要要求 GPTs 執行甚麼指令，GPTs 頂多做到辨識我下了什麼指令，精準執行而已。例如前幾年很流行的語音助理，你大概都得這樣下指令:

Hey XXXX, 告訴我今天的天氣
OK XXXXX, 打開客廳的電燈

多了這層 "意圖" 的轉譯，我覺得是個很大的變革。背後主要的機制都是 LLM 如何從對話解析出意圖，然後呼叫對應 API 的一連串機制。簡報的 P15 ~ P18 就是在說明這些過程，而細節我也在上面那篇文章說明過了，這裡就先跳過。後面我會有一段說明 AI 開發的基礎技能，會再談談 LLM 是如何做到 function calling ( 講白話就是讓 AI 直接呼叫需要的 API  )。



## 降維打擊: 透過 AI 來提升使用者體驗

// P19, 降為打擊

第一個 demo 的心得，就是這標題講的: "降維打擊"。用 AI 來提升使用者體驗 (UX)，我覺得跟傳統提升 UX 的方法完全不同層次。並不是說 UX 以後都要靠 AI 了，而是藉由這個案例，我看到了在 "猜測" 使用者意圖這範圍內，用 LLM 來處理，可以比起大量的訪談，流程設計，介面設計等手法，來的更準確更有效。如果你有能力辨識出那些情境該用傳統手法，那些情境該善用 AI 來解決，你就能得到兩者加乘的效果。

我用兩頁簡報來總結這些想法:


## THINK: 你覺得安德魯小舖的 UX 夠好嗎?

// P20, P21

以 LLM 改善 UX 的路線，靠的是 LLM 理解對話上下文的能力，邏輯推論的能力，再搭配呼叫 API 執行動作的能力組合而成的。這些能力組合起來，你會開始有種錯覺，GPTs 聽得懂你 "想" 幹嘛，同時還能 "替你" 代勞操作系統 (挑選商品，加入購物車，結帳)。

過去你寫的很多程式，都沒有 "真正" 從行為或對話去 "理解" 使用者的意圖。靠的都是大量的流程與介面 "引導"，去猜測大部分使用者會想要的結果是什麼而設計的，一來不夠直接，驗證很花時間；二來小眾的想法容易被忽略，因為這些小眾的需求不容易在統計數據與行為追蹤被凸顯出來，並且被設計在 UI 之內解決。而直接解析個別對話的做法，恰巧避開了這些盲點，因此這也是我所謂 "不同維度" 就是這個意思。

當然，我再說一次，不是傳統作法就不需要了。你畢竟還是需要人機介面，對於很基礎的操作，用畫面點選還是直觀且有效率的多了，認清怎麼組合，怎麼應用 AI 是很重要的。目前 AI 還不夠成熟，速度也慢，費用也高。不過這些問題會在未來被解決掉。到我寫這篇文章為止 (2024/07)，NVIDIA 黃仁勳說 AI 運算能力每 2 年會提升 10 倍，OpenAI 每次的更新都會讓模型的費用減半，速度提升，功能提升，而 Intel / AMD / Qualcomm 等 CPU + NPU 廠商也不斷地在提升 NPU 的運算能力，這些 LLM 的推論可能都不再需要支付雲端費用..，這時快點了解這些結構問題，做好對應的準備是很好的時間點。



## Demo #2, 偵測購買滿意度的魔法

繼續往下感嘆之前，再來看第二段 demo 吧。這就是半年前文章沒有提及的範圍了。一樣來看看這段 demo 我準備的示範情境。

// P23

這次我想挑戰兩個期待:

1. 一個是 GPTs 能否掌握我的習性 (從對話中捕捉我的喜好)，並且在我提出需求時能按照我的習性給我量身訂製的回應 (包含內容跟 API 呼叫)
1. 另一個是已經完成的交易，我希望 GPTs 能從過程中 (從使用者的回應捕捉) 記錄下每次交易的使用者感受，以及替這些感受評分 (滿意度)

同樣的，回想一下，各位過去想要做到個人化，想要得到滿意度回饋，都是怎麼做的?

不外乎:
1. 收集數據 (購買內容，操作行為，跨站的追蹤，廣告喜好等等)，善用各種大數據或是機器學習的技巧來替使用者貼標分類
1. 指標監控 (跳出率，轉換率等) 用各種監控指標，來看看某些特定商品，或是某些介面或功能設計，是否更獲得使用者喜好?
1. 滿意度問券，搭配各種誘因 (例如打卡送小菜，填問券送贈品或是累計點數) 讓使用者願意回饋評分或是評價

不過，經過前面 UX 的思考，我開始也有同樣的感覺: 這也是透過大量事前的布置，或是事後的統計，試圖在外圍累計的數字上來 "猜測" 使用者真正的想法。然而是否有機會跟前面案例一樣，如果有了成熟的 LLM，能否直接從赤裸裸的上下文歷程，捕捉到使用者背後的情緒，喜好，感受?

也許現在 LLM 做的還不夠好，但是我還是想試試。好不好的問題，時間會解決 (對，我就相信還沒踩到理論極限，就交給 OpenAI 吧)，然而可不可行這件事，我覺得現在就能開始嘗試了。嘗試的結果，我發現事情遠比我想像的簡單得多... (作法很簡單，但是正確性還有待提升)。

同樣的，我覺得這又是另一個 "降維打擊" 了。過去是透過事前事後的設計，以及大量的數據來推測這些結果；LLM 開始有能力透過單一歷程，用自然語言的理解能力，直接抽出這對話過程中我們需要的資訊。正確度，效率，運算成本等等來看現在都還不值得立刻採用，但是我一樣看到另一個不同的 "新路線" 出現了，發展下去必定能做到目前方法遠遠不可及的成效。

這邊的案例，我特地花點值間，用文字來描述一下我看到的改變。先來看第一個案例:

> 使用者說明自身喜好，店長推薦商品。店長自己記下會員摘要註記 (下次會記得)

// AI 從對話過程中，擷取並摘要我的喜好描述 ""，並且呼叫 API 記錄在我的客戶註記欄位

> 三天後使用者再次來訪，只描述情境，店長能根據使用者喜好 (上次留下的註記) + 情境給予推薦商品

// AI 在我詢問內容，要回答我之前，先嘗試透過 API 讀取我的客戶註記資訊，並且把它併入上下文，綜合之後給我推薦建議，並且代替我執行對應的 API


> 店長口頭給了錯誤的折扣資訊，導致使用者表達不滿。訂單的註記與消費滿意度給了 2 分，並記錄不滿意的原因

// 結帳完成後，AI 總結這次購物過程的對話歷程，擷取並且摘要跟 "滿意度" 相關的註記，並且給了一個主觀的分數，呼叫 API 註記在訂單身上

## THINK AGAIN: 你覺得 UX 夠好嗎?

這個案例，我看到幾個地方:

過去用收集大量資訊 + 統計或是機器學習的手法達成的目的，現在換成透過一個訓練良好的 LLM 直接從單次的歷程給出判斷。給我的感覺就像是老練的業務員，他會有先天敏銳的直覺，這些人不需要透過大量統計，就能察覺客人背後的想法。其實這也是需要數據 (經驗) 的累積，只是不是為了這個功能收集數據，而是 LLM 已經從更龐大 (全 internet 上可取得的訓練來源) 直接訓練出來的通用型 LLM，而我拿它來面對這個問題而已。講白了也是數據訓練，但是訓練的內容更龐大 (某系統內的操作數據 vs 整個 GPT4 的訓練內容)，應用範圍更龐大 (從行為推測滿意度分數 vs 從完整對話推論滿意度摘要與分數)，如此而已。

我看到的改變，也是不同 "維度" 的做法。從單一系統累積的數據用機器學習訓練 (ML，自己收集資料，自己訓練模型，自己預測解讀結果)，改為用世界級的資料訓練的大模型 LLM 來解析 (LLM，AI 廠商收集資料，訓練出通用的大模型，軟體開發商拿來解讀單次歷程背後隱藏的訊息)。模型訓練更往前了，模型訓練規模更大了，而模型的效益也更通用了，後面的應用就直接拿案例 + 自訂的 Prompt 就能得到結果了，這就是不同規模的競賽。比起來應用的層次不同了，解讀資訊的層級也不同了，才會造成這樣的落差。

也因為想通了這背後的差異，我開始理解 "降維打擊" 這句話背後要講的差別了。三次元的生物 (例如: 人)，看待二次元的生物 (例如: 螞蟻)，當人要從上面踩死螞蟻的時候，螞蟻其實完全沒有反抗能力的，甚至不知道發生什麼事情，這就是維度的差距。這差距大到不可能被突破，再多的努力跟改善都不會改變這現實。因此認清各自擅長的領域，"正確" 的使用這些技術是很重要的。

// 不對，夠宅的話就會說: 2 次元的老婆可以輾壓 3 次元的老婆 XDDD


## demo 小結

// P25

看完這兩個 demo


