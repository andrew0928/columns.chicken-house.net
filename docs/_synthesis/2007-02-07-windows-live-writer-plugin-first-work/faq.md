---
layout: synthesis
title: "Windows Live Writer - Plugin 處女作..."
synthesis_type: faq
source_post: /2007/02/07/windows-live-writer-plugin-first-work/
redirect_from:
  - /2007/02/07/windows-live-writer-plugin-first-work/faq/
postid: 2007-02-07-windows-live-writer-plugin-first-work
---

# Windows Live Writer - Plugin 處女作...

## 問題與答案 (FAQ)

### Q&A 類別 A: 概念理解類

A-Q1: 什麼是 Windows Live Writer（WLW）？
- A簡: 微軟推出的部落格編輯器，支援離線寫作、預覽與發佈，並具備外掛擴充能力。
- A詳: Windows Live Writer 是微軟的所見即所得部落格編輯器。使用者可在離線環境撰寫、插入圖片與排版，完成後再發佈至部落格平台。WLW 支援多種發佈通道（如 MetaBlog API 或 FTP），並提供外掛架構擴充編輯功能。其易用性高，能提升寫作效率，因此深受部落客喜愛。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: A-Q2, A-Q10, B-Q1

A-Q2: WLW 的主要優點是什麼？
- A簡: 所見即所得編輯、離線撰寫、擴充彈性高，提升寫作體驗與效率。
- A詳: WLW 最大的優點包括直覺的 WYSIWYG 編輯體驗、離線撰寫與預覽、安裝即用的外掛生態，以及與多平台相容的發佈能力。這些優點讓內容創作者能專注於文字與排版，不必被後端技術細節干擾，進而提升產出效率與穩定性。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: A-Q1, A-Q3, A-Q10

A-Q3: WLW 上傳圖片的最大缺點是什麼？
- A簡: 圖片會被強制重存為 JPEG，品質可能下降且檔案可能變大。
- A詳: 無論使用 MetaBlog API 或 FTP，WLW 會在上傳前重新儲存圖片為 JPEG。由於 JPEG 屬於破壞性壓縮，重複編碼將累積失真，導致畫質變差。此外，WLW 的壓縮品質預設不低，可能導致某些原圖反而變更大，造成「畫質變差、檔案變肥」的雙重問題。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: A-Q4, B-Q1, B-Q11

A-Q4: 為什麼 JPEG 會越存越糟？
- A簡: JPEG 為破壞性壓縮，每次重編碼都會累積不可逆的失真。
- A詳: JPEG 透過離散餘弦轉換（DCT）與量化壓縮影像資料，這是不可逆的過程。每次重存都會重新量化與取捨細節，產生量化誤差與塊狀或鋸齒等失真。重複儲存累積損傷，尤其在細節豐富或高對比區域更明顯，因此建議盡量避免多次重編碼。
- 難度: 中級
- 學習階段: 基礎
- 關聯概念: A-Q3, B-Q3, B-Q15

A-Q5: 使用 WLW 重存圖片會造成哪些影響？
- A簡: 畫質下降、檔案可能變大、流量與儲存成本增加，整體體驗變差。
- A詳: 重存的影響包括：細節損失與色帶感加重，視覺品質下降；在高品質參數下，檔案大小可能不減反增；增加網站頻寬與儲存成本；若作者原圖已最佳化（如 100% 品質或特定壓縮流程），被 WLW 接管後會破壞既有最佳化策略，導致「人財兩失」的不良體驗。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: A-Q3, B-Q1, B-Q15

A-Q6: 什麼是 MetaBlog API（MetaWeblog API）？
- A簡: 一種部落格遠端發佈 API，WLW 用它來傳送文章與媒體。
- A詳: MetaBlog API（常見名為 MetaWeblog API）是早期部落格平台支援的 XML-RPC 介面，允許客戶端程式遠端建立、編輯與發佈文章，並上傳圖片等媒體。WLW 透過此 API 與部落格互動。然而在該案例中，經 API 或 FTP 上傳的圖片都會先被 WLW 重存為 JPEG。
- 難度: 中級
- 學習階段: 基礎
- 關聯概念: A-Q3, B-Q1, B-Q11

A-Q7: FTP 與 MetaBlog API 在 WLW 圖片處理上的差異？
- A簡: 在 WLW 內兩者皆會觸發圖片重存，差在傳輸通道不同。
- A詳: 從 WLW 的行為來看，無論走 FTP 或 MetaBlog API，上傳前都會進行 JPEG 重存。差異在於傳輸方式：FTP 直接寫入站台檔案系統，API 透過平台端處理媒體。由於重存發生於客戶端，故兩者都無法避免畫質與大小的問題，除非改變插入方式以繞過上傳流程。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q3, B-Q11, B-Q3

A-Q8: 什麼是 UNC 路徑？為何用它？
- A簡: 網路共用路徑格式（如 \\server\share），便於跨機器複製檔案。
- A詳: UNC（Universal Naming Convention）是 Windows 網路共用路徑格式，例如 \\server\share\path。使用 UNC 可直接對網路分享進行檔案存取，不依賴磁碟代號。本文以 UNC 指向網站的圖檔資料夾，外掛先把檔案複製到該位置，再插入對應的 URL，避開 WLW 的上傳與重存流程。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: A-Q9, B-Q8, C-Q2

A-Q9: 為什麼要建立 UNC 與 URL 的對應？
- A簡: 讓複製後能組出正確網址，直接在文章中連結顯示圖片。
- A詳: 網站可同時有「檔案系統路徑」與「對外網址」兩種表示。外掛在本機將圖檔複製至網站的 UNC 目錄後，需能把該路徑映射成對應的 HTTP/HTTPS URL，插入至文章內容。此對應使圖片不經 WLW 上傳與重存，仍能在頁面中正確顯示，兼顧品質與便利。
- 難度: 初級
- 學習階段: 核心
- 關聯概念: A-Q8, B-Q7, C-Q6

A-Q10: WLW 外掛在整體工作流程中的定位？
- A簡: 作為編輯期增益工具，簡化插圖流程，非發佈層存取。
- A詳: 文中外掛定位於「編輯階段」：提供選單操作、設定對映、複製檔案與插入 URL。它不介入 WLW 的發佈與帳密流程，因此也無法取得帳號資訊。這種定位避免安全風險，專注於改善插圖體驗，並以繞道方式解決 WLW 圖片重存的問題。
- 難度: 初級
- 學習階段: 核心
- 關聯概念: A-Q11, B-Q9, C-Q3

A-Q11: 為何作者放棄以 API 直接上傳？
- A簡: 外掛無法取得 WLW 帳密與發佈資訊，安全與定位限制所致。
- A詳: 作者嘗試以 MetaBlog API 上傳，但發現 WLW 外掛被定位在編輯層，拿不到 WLW 內部的網站帳號與密碼等設定，可能出於安全考量與職責劃分。因此若走 API 需另外自行設定帳密與站台資訊，增加複雜度。作者遂改用 UNC + URL 對映的簡化路徑。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q10, B-Q9, C-Q9

A-Q12: 什麼是「Insert Picture From Web」？與外掛差異？
- A簡: WLW 內建由網址插圖功能；外掛自動複製並產生網址。
- A詳: Insert Picture From Web 是 WLW 內建從網頁 URL 插入圖片的功能。本文外掛則先把本機選取的檔案複製到網站的共用資料夾，再自動產生對應 URL 插入編輯器，省去手動上傳與手填網址的麻煩，達到「懶人用」的一鍵作業體驗。
- 難度: 初級
- 學習階段: 核心
- 關聯概念: A-Q9, C-Q3, B-Q4

A-Q13: WLW 的 Tools→Preferences→Plugins 有何用途？
- A簡: 管理外掛啟用、設定選項，提供外掛編輯畫面入口。
- A詳: 在 WLW 的偏好設定中，Plugins 頁籤會列出已安裝外掛，使用者可啟用/停用並進入各外掛的 Options 畫面。本文外掛在此提供 UNC 與 URL 對映設定，並於插入菜單中新增「插入圖片（從網路芳鄰）」的指令以供使用。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: C-Q1, C-Q2, B-Q4

A-Q14: 外掛選項需設定哪些核心資訊？
- A簡: 設定網站圖庫的 UNC 路徑與對應的公開 URL 前綴。
- A詳: 選項畫面僅需兩項：1) UNC 路徑（如 \\server\share\images），外掛將把選取的檔案複製到此處；2) 對應 URL（如 https://site/img/），用以把複製後的實際檔名拼接為可公開存取的網址。完成設定後即可從選單插入圖片。
- 難度: 初級
- 學習階段: 核心
- 關聯概念: A-Q9, C-Q2, C-Q6

A-Q15: 外掛的核心價值與邏輯是什麼？
- A簡: 以「先複製檔案，再插入網址」繞過 WLW 重存，保真省事。
- A詳: 核心邏輯是將圖片上傳轉化為「檔案複製＋URL 插入」兩步。先把本機檔案透過 UNC 複製到網站，然後依對映規則組出網址並插入文章。此法避開 WLW 的上傳與重編碼流程，保留原始畫質與檔案大小，同時簡化操作，提升整體體驗。
- 難度: 初級
- 學習階段: 核心
- 關聯概念: A-Q3, B-Q3, C-Q3

### Q&A 類別 B: 技術原理類

B-Q1: WLW 圖片上傳的標準流程如何運作？
- A簡: 插入圖片後，WLW 會重存為 JPEG，再經由 API 或 FTP 上傳。
- A詳: 一般情境下，使用者插入圖片（本機或剪貼），WLW 會在本機建立媒體資產，統一轉為 JPEG 並套用預設品質設定。接著依帳號設定選用 MetaBlog API 或 FTP 將檔案上傳到部落格平台或站台，最後在文章中插入指向該檔案的連結或內嵌標記。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q3, B-Q11, A-Q1

B-Q2: WLW 為何會強制以 JPEG 重存？
- A簡: 為一致化媒體處理與相容性，採統一格式與品質策略。
- A詳: WLW 採用統一的媒體處理流程，將多樣來源格式標準化為 JPEG，以降低平台相容性風險，並提供可預期的顯示結果。此設計簡化了上傳與相容性問題，但犧牲了影像保真與自訂壓縮控制，造成多次重編碼的品質與檔案大小問題。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: B-Q1, A-Q3, B-Q11

B-Q3: JPEG 重壓縮的技術機制是什麼？
- A簡: 每次經 DCT 與量化重編碼都丟失細節，失真累積難逆。
- A詳: JPEG 以區塊為單位進行 DCT 轉換，將空間域信號轉頻率域，再透過量化矩陣丟棄高頻細節，最後熵編碼。重複重存會再次量化，疊加量化誤差與塊狀化、邊緣鋸齒、色帶等失真。品質參數越低或次數越多，視覺劣化越明顯且不可逆。
- 難度: 高級
- 學習階段: 進階
- 關聯概念: A-Q4, B-Q15, A-Q5

B-Q4: 外掛的技術架構包含哪些組件？
- A簡: 設定儲存、插入命令、檔案複製與 URL 產生、UI 對話框。
- A詳: 架構包括：1) 設定模組，儲存 UNC 與 URL 對映；2) 編輯器命令，於選單提供「插入圖片（從網路芳鄰）」；3) 檔案對話框，選取本機檔案；4) 檔案複製器，將檔案複製到 UNC；5) URL 產生器，依對映規則組出可公開的連結；6) 錯誤處理與提示 UI。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: C-Q5, C-Q6, A-Q14

B-Q5: 外掛執行流程的關鍵步驟？
- A簡: 觸發指令→選檔→驗證→複製→組 URL→插入→回饋結果。
- A詳: 使用者點擊外掛命令後，流程為：1) 開啟檔案對話框；2) 檢查設定與路徑有效性（UNC 存取、URL 合法）；3) 檔案存在且大小合理；4) 複製到 UNC 目標，處理同名覆蓋或改名；5) 根據設定組出 URL 並插入到編輯器內容；6) 顯示成功或錯誤訊息。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: B-Q4, C-Q3, C-Q7

B-Q6: 選項設定的儲存和載入原理？
- A簡: 外掛將設定序列化至本機，開啟時載入，供流程使用。
- A詳: 外掛的 Options 介面讓使用者輸入 UNC 與 URL。儲存時序列化到本機（例如設定檔、註冊表或 WLW 提供的外掛設定存放），下次開啟 WLW 或呼叫外掛時載入，並在流程中用於權限驗證、目標路徑與 URL 組裝等核心操作。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: C-Q5, C-Q6, A-Q14

B-Q7: UNC 與 URL 對映如何正規化處理？
- A簡: 移除尾端分隔、統一路徑大小寫與斜線，確保拼接可靠。
- A詳: 正規化包含：1) UNC 去除尾端反斜線，轉一致分隔符；2) URL 確保有協定與尾端斜線；3) 組 URL 時只拼接檔名與相對路徑，避免重複分隔；4) 比對時採大小寫不敏感處理 Windows 路徑，並處理空白與特殊字元的編碼。這些確保 URL 產出正確可用。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: C-Q6, B-Q13, D-Q5

B-Q8: 檔案複製與權限控管的機制？
- A簡: 透過 SMB 存取 UNC，共享需具寫入權；處理覆蓋與鎖定。
- A詳: 複製動作使用 SMB 協定寫入 UNC 共享目錄。需確保帳號對目標具寫入權，且目錄可用。對同名檔案可採覆蓋策略或自動更名，並處理檔案占用與網路中斷等例外。權限不足時應提示使用者並提供測試連線的功能。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: C-Q7, D-Q2, A-Q8

B-Q9: 插件為何無法讀取 WLW 帳密與發佈設定？
- A簡: 外掛被限制於編輯層，安全與邊界設計不暴露敏感資訊。
- A詳: WLW 的外掛模型將編輯與發佈層分離。為避免外掛濫用或竊取敏感資料，WLW 不提供帳號、密碼與發佈設定給編輯期外掛。因此外掛無法藉此走 MetaBlog API 上傳，只能自備設定或改走不需憑證的檔案複製方案。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q11, C-Q9, B-Q1

B-Q10: 使用 Open File Dialog 的流程與驗證？
- A簡: 篩選圖片、確認存在、檢查大小與路徑，再進複製程序。
- A詳: 開啟檔案對話框後，設定濾鏡（如 JPG/PNG），取得使用者選擇的路徑。進行檢查：檔案是否存在、大小是否在上限內、是否可讀取、檔名是否合法。若通過，交由複製模組與 URL 產生模組處理；否則回報錯誤並允許重新選擇。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: C-Q3, C-Q6, C-Q7

B-Q11: 為何使用 FTP/API 上傳會被重壓？
- A簡: 因 WLW 在客戶端先統一重存圖片，再走傳輸通道。
- A詳: 重壓發生於上傳前的本機階段，屬於 WLW 的媒體處理管線。無論後續採用 FTP 或 MetaBlog API，傳輸的都是 WLW 重存後的檔案。因此只要走 WLW 的上傳流程，就難以避免重壓行為，需改變流程（如改插入 URL）才能保留原檔。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q7, B-Q1, A-Q12

B-Q12: 防呆設計應涵蓋哪些檢查？
- A簡: 設定必填、路徑可達、權限足夠、網址合法、重名與編碼。
- A詳: 防呆包含：1) UNC 與 URL 必填且格式正確；2) 測試 UNC 可寫、URL 可通；3) 檔案大小與類型限制；4) 同名策略（覆蓋或改名）；5) URL 編碼處理空白與特殊字；6) 例外處理與回滾；7) 顯示清楚的錯誤訊息與重試選項，降低失敗成本。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: C-Q7, D-Q2, D-Q5

B-Q13: 檔名與網址編碼應如何處理？
- A簡: 使用百分比編碼處理空白與非 ASCII，保持網址合法可達。
- A詳: 在組 URL 時，應對空白（%20）與中文或特殊字元做百分比編碼，避免瀏覽器或伺服器誤判。檔名正規化建議移除不安全字元，統一大小寫並保留副檔名。必要時可產生 slug 或時間戳避免衝突，確保連結穩定與可移植性。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: B-Q7, C-Q6, D-Q5

B-Q14: 快速原型開發帶來的風險與好處？
- A簡: 快速驗證想法、回饋快；但功能陽春、防呆不足、相容不確定。
- A詳: 作者用兩小時邊讀 SDK 邊實作，迅速完成能解痛點的最小可行版本。優點是快、學習曲線短、可立即投入使用；風險在於錯誤處理薄弱、邊界條件未覆蓋、未來 WLW 變更可能致失效。因此需規劃後續硬化與維護策略。
- 難度: 初級
- 學習階段: 核心
- 關聯概念: D-Q10, C-Q10, B-Q12

B-Q15: 品質與檔案大小的技術權衡？
- A簡: 高品質保細節但檔案大；低品質小但易失真，需視情境折衷。
- A詳: 影像壓縮本質是品質與大小的平衡。對照片或細節豐富畫面，高品質能保留細節但佔用空間；對網頁縮圖或圖示，中低品質可顯著減少流量。若 WLW 強制重存，使用者就失去主動權。本文外掛的價值在於保留原始最佳化成果，由作者自行掌控。
- 難度: 初級
- 學習階段: 核心
- 關聯概念: A-Q5, B-Q3, C-Q4

### Q&A 類別 C: 實作應用類

C-Q1: 如何安裝此 WLW 外掛 DLL？
- A簡: 將外掛 DLL 放入 WLW Plugins 目錄，重啟 WLW 並於 Plugins 啟用。
- A詳: 步驟：1) 取得外掛 DLL；2) 複製至 WLW 的 Plugins 目錄；3) 重啟 WLW；4) 至 Tools→Preferences→Plugins 確認外掛出現並啟用；5) 若提供 Options，進入設定。注意：DLL 若被 Windows 封鎖需解除；版本不符可能無法載入，請確認相容性與依賴。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: A-Q13, D-Q1, C-Q2

C-Q2: 如何設定 UNC 與 URL 對映？
- A簡: 在外掛 Options 輸入 UNC 根路徑與公開 URL 前綴並儲存。
- A詳: 步驟：1) 開啟 Plugins→Options；2) UNC 例：\\server\share\images；3) URL 例：https://site/images/；4) 測試 UNC 可寫入（建立/刪除測試檔）；5) 測試 URL 可讀（訪問示例檔）；6) 儲存設定。最佳實踐：路徑尾端一致化、限制子資料夾、設定檔案大小上限。
- 難度: 初級
- 學習階段: 核心
- 關聯概念: A-Q14, B-Q7, D-Q4

C-Q3: 如何用外掛插入圖片避免重存？
- A簡: 選單執行外掛→挑檔→外掛複製→插入對應網址到文章。
- A詳: 步驟：1) 在 WLW 選單選 Insert→插入圖片（從網路芳鄰）；2) 於對話框選擇本機圖片；3) 外掛驗證設定與權限；4) 複製檔案到 UNC 目標；5) 依對映規則組出 URL；6) 插入到文章；7) 預覽。注意：確認插入結果為 URL 參照，而非本機檔案內嵌，避免 WLW 介入重存。
- 難度: 初級
- 學習階段: 核心
- 關聯概念: A-Q12, B-Q5, C-Q4

C-Q4: 如何驗證圖片未被 WLW 重存？
- A簡: 比對伺服器檔案與原檔大小與雜湊，並檢視文章連結型態。
- A詳: 步驟：1) 於伺服器目錄查看新檔大小；2) 與原檔比較大小與修改時間；3) 計算雜湊（MD5/SHA-1）驗證一致；4) 在 WLW 文章 HTML 檢視確認 img src 指向網站 URL；5) 發佈後以瀏覽器另存圖片，比對檔案。若一致，代表未經 WLW 重存。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: B-Q11, B-Q15, D-Q3

C-Q5: 如何以 .NET 實作外掛的選項畫面？
- A簡: 使用 WinForms 建立兩欄輸入（UNC、URL），序列化儲存設定。
- A詳: 範例：建立 WinForms Form 包含 txtUnc、txtUrl 與「測試」按鈕。儲存時驗證格式與可達性後寫入設定存放。示意碼：ValidatePath(txtUnc.Text); ValidateUrl(txtUrl.Text); SaveSettings(new {Unc, Url});。最佳實踐：即時驗證、禁用無效儲存、提供測試結果訊息。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: B-Q6, B-Q12, D-Q2

C-Q6: 如何以 .NET 複製檔案並組出網址？
- A簡: 以 File.Copy 複製至 UNC，取檔名拼接至 URL 前綴並編碼。
- A詳: 示意碼：var name=Path.GetFileName(src); var dst=Path.Combine(uncRoot, name); File.Copy(src, dst, overwrite); var url=baseUrl.TrimEnd('/')+"/"+Uri.EscapeDataString(name); 回傳 url 供插入。注意：處理同名檔、長檔名、非法字元與例外，並確保 uncRoot 可寫且連線穩定。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: B-Q8, B-Q13, D-Q5

C-Q7: 如何新增基本防呆與錯誤處理？
- A簡: 檢查設定、權限與網路，處理重名與編碼，提供回饋。
- A詳: 作法：1) 前置檢查 UNC/URL 格式；2) 測試 UNC 寫入（建/刪臨時檔）；3) 檔案大小與副檔名白名單；4) 同名改名策略（加時間戳）；5) URL 編碼檔名；6) try-catch 包裹複製與插入，失敗顯示明確訊息；7) 記錄日誌以便除錯。預防：提供健康檢查按鈕。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: B-Q12, D-Q2, D-Q5

C-Q8: 如何支援多組對映與站台？
- A簡: 設計多筆 UNC/URL 設定，提供下拉選擇並記錄最近使用。
- A詳: 作法：1) 設定資料結構改為清單[{Name,UNC,URL}]；2) UI 加入下拉清單與新增/刪除；3) 插入時以選定項執行；4) 記錄最近使用；5) 匹配子資料夾支援。注意：避免名稱重複、提供匯入/匯出設定，並在插入時顯示目前對映摘要以降低誤用。
- 難度: 中級
- 學習階段: 進階
- 關聯概念: B-Q4, C-Q2, D-Q7

C-Q9: 若要走 MetaBlog API，自行實作需怎麼做？
- A簡: 自備 Blog URL/帳密設定，呼叫 API 上傳，避開 WLW 帳密。
- A詳: 步驟：1) 在外掛 Options 增加 Blog URL、帳號、密碼；2) 於外掛中自行實作 MetaBlog API（XML-RPC）客戶端，上傳媒體；3) 拿回伺服器回應的 URL 插入文章；4) 安全存放憑證（加密）；注意：此路徑未使用 WLW 內建帳密，且仍須避免客端重存，改以原檔上傳。
- 難度: 高級
- 學習階段: 進階
- 關聯概念: A-Q11, B-Q9, D-Q9

C-Q10: 如何維護與更新外掛以因應 WLW 變動？
- A簡: 版本偵測、回退機制、紀錄相容性，定期測試關鍵流程。
- A詳: 策略：1) 監控 WLW 更新，回歸測試「選檔→複製→插入」流程；2) 加入功能偵測，若 WLW 已支援保留原圖，則引導使用者改用內建；3) 提供錯誤診斷日誌；4) 版本註記與相容性矩陣；5) 自動更新或手動升級指引。預防：持續硬化防呆與權限檢查。
- 難度: 中級
- 學習階段: 進階
- 關聯概念: B-Q14, D-Q10, C-Q7

### Q&A 類別 D: 問題解決類

D-Q1: 外掛安裝後在 Plugins 看不到怎麼辦？
- A簡: 檢查放置路徑、解除封鎖、版本相容，重啟 WLW 並查看日誌。
- A詳: 症狀：Plugins 清單無外掛。原因：DLL 置錯資料夾、被系統封鎖、缺少相依、版本不符。解法：確認 DLL 在 WLW Plugins 目錄；檔案內容→解除封鎖；安裝必要相依；重啟 WLW。預防：提供安裝檢查清單與記錄載入錯誤日誌以利排查。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: C-Q1, B-Q14, C-Q10

D-Q2: 插入圖片時複製失敗怎麼辦？
- A簡: 檢查 UNC 可寫、權限與網路，處理同名與檔案占用例外。
- A詳: 症狀：插入時出錯。原因：無寫入權、網路中斷、目標滿、檔案占用、同名衝突。解法：測試 UNC 建/刪臨時檔、確認權限與容量、關閉占用程式、啟用自動改名。預防：在 Options 提供「測試連線」與「同名策略」設定。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: B-Q8, C-Q7, C-Q2

D-Q3: 插入後圖片仍被重存，原因與解法？
- A簡: 可能插入為本機檔而非 URL；確認使用外掛的 URL 插入。
- A詳: 症狀：畫質仍差、檔案大小變化類似 WLW 重存。原因：插入的是本機檔案，WLW 於發佈時接管上傳並重存。解法：確認外掛插入的是 http(s) URL；在 HTML 檢視檢查 img src；必要時關閉 WLW 的自動上傳本地圖。預防：外掛插入前顯示將插入的 URL 預覽。
- 難度: 初級
- 學習階段: 核心
- 關聯概念: C-Q3, C-Q4, B-Q11

D-Q4: 網址 404 或顯示不了圖片怎麼辦？
- A簡: 檢查 URL 對映是否正確、檔案是否存在與可被網站存取。
- A詳: 症狀：頁面顯示破圖或 404。原因：URL 前綴錯誤、網站路由未對應、檔案未成功複製或被權限阻擋。解法：用瀏覽器直接訪問 URL；比對伺服器檔案存在；修正 URL 前綴與資料夾對應；設定網站靜態檔案權限。預防：設定測試連結按鈕與健康檢查。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: C-Q2, C-Q6, B-Q7

D-Q5: 檔名含空白或中文導致網址錯誤？
- A簡: 將檔名做 URL 編碼或轉換安全字元，避免瀏覽器解析錯誤。
- A詳: 症狀：部分瀏覽器顯示不了或連結斷。原因：未做百分比編碼，空白、中文或特殊字元被誤解。解法：在組 URL 時使用 Uri.EscapeDataString；或先正規化檔名（移除不安全字元）。預防：外掛加入自動編碼與檔名規範策略。
- 難度: 初級
- 學習階段: 核心
- 關聯概念: B-Q13, C-Q6, B-Q7

D-Q6: 插入圖片動作很慢或卡住？
- A簡: 可能網路延遲、檔案過大或共享擁塞，建議壓縮與分時操作。
- A詳: 症狀：選檔後等待過久。原因：UNC 網路延遲、檔案過大、伺服器忙碌、病毒掃描攔截。解法：先用離線工具最佳化圖片；避免尖峰時段；於外掛加入進度與逾時處理；必要時改為背景複製。預防：設定大小上限與快取暫存。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: B-Q8, C-Q7, B-Q15

D-Q7: 多台電腦使用導致路徑不一致？
- A簡: 統一使用 UNC 而非磁碟代號，或建立多個對映設定檔。
- A詳: 症狀：某台可用、另一台失敗。原因：本機磁碟代號不同、權限不一致。解法：改用 UNC；在外掛支援多組對映，依電腦或站台切換；統一網域權限與群組。預防：導入設定匯入/匯出，維護同一套配置。
- 難度: 初級
- 學習階段: 核心
- 關聯概念: C-Q8, C-Q2, B-Q8

D-Q8: 外掛與其他外掛衝突如何處理？
- A簡: 逐一停用測試、檢查快捷鍵與選單衝突，查看錯誤日誌。
- A詳: 症狀：功能失效或介面異常。原因：命令註冊衝突、共享相依版本不合。解法：啟動最小外掛集逐一排除；調整熱鍵與選單；更新相依程式庫；查看 WLW 或外掛日誌定位問題。預防：避免侵入式變更，遵循外掛 API 規範。
- 難度: 中級
- 學習階段: 進階
- 關聯概念: B-Q4, C-Q10, B-Q14

D-Q9: 若需儲存帳密，有哪些安全作法？
- A簡: 加密保存、最小權限、避免平文，提供顯示/重設機制。
- A詳: 情境：自行實作 API 上傳。作法：使用作業系統保護機制（如 DPAPI）加密存放；採最小權限帳號；避免平文顯示與記錄；提供安全的重設流程；於記憶體中短期持有敏感資訊。預防：定期安檢與密碼輪替。若能，仍建議使用不需憑證的 UNC 路徑方案。
- 難度: 高級
- 學習階段: 進階
- 關聯概念: C-Q9, B-Q9, C-Q7

D-Q10: WLW 更新後外掛失效如何因應？
- A簡: 快速回退到內建功能、檢視變更、修補相容並發布更新。
- A詳: 症狀：外掛命令消失或執行錯誤。原因：WLW 介面或外掛 API 變更。解法：指引使用者暫用「Insert Picture From Web」；檢閱更新說明與 API 差異；調整外掛、增加容錯與版本偵測；發布修正版。預防：建立回歸測試與相容性矩陣。
- 難度: 中級
- 學習階段: 進階
- 關聯概念: B-Q14, C-Q10, A-Q12

### 學習路徑索引
- 初學者：建議先學習哪 15 題
    - A-Q1: 什麼是 Windows Live Writer（WLW）？
    - A-Q2: WLW 的主要優點是什麼？
    - A-Q3: WLW 上傳圖片的最大缺點是什麼？
    - A-Q4: 為什麼 JPEG 會越存越糟？
    - A-Q5: 使用 WLW 重存圖片會造成哪些影響？
    - A-Q8: 什麼是 UNC 路徑？為何用它？
    - A-Q9: 為什麼要建立 UNC 與 URL 的對應？
    - A-Q12: 什麼是「Insert Picture From Web」？與外掛差異？
    - A-Q13: WLW 的 Tools→Preferences→Plugins 有何用途？
    - A-Q14: 外掛選項需設定哪些核心資訊？
    - A-Q15: 外掛的核心價值與邏輯是什麼？
    - B-Q1: WLW 圖片上傳的標準流程如何運作？
    - C-Q1: 如何安裝此 WLW 外掛 DLL？
    - C-Q2: 如何設定 UNC 與 URL 對映？
    - C-Q3: 如何用外掛插入圖片避免重存？

- 中級者：建議學習哪 20 題
    - B-Q2: WLW 為何會強制以 JPEG 重存？
    - B-Q3: JPEG 重壓縮的技術機制是什麼？
    - B-Q4: 外掛的技術架構包含哪些組件？
    - B-Q5: 外掛執行流程的關鍵步驟？
    - B-Q6: 選項設定的儲存和載入原理？
    - B-Q7: UNC 與 URL 對映如何正規化處理？
    - B-Q8: 檔案複製與權限控管的機制？
    - B-Q11: 為何使用 FTP/API 上傳會被重壓？
    - B-Q12: 防呆設計應涵蓋哪些檢查？
    - B-Q13: 檔名與網址編碼應如何處理？
    - B-Q15: 品質與檔案大小的技術權衡？
    - C-Q4: 如何驗證圖片未被 WLW 重存？
    - C-Q5: 如何以 .NET 實作外掛的選項畫面？
    - C-Q6: 如何以 .NET 複製檔案並組出網址？
    - C-Q7: 如何新增基本防呆與錯誤處理？
    - C-Q8: 如何支援多組對映與站台？
    - D-Q1: 外掛安裝後在 Plugins 看不到怎麼辦？
    - D-Q2: 插入圖片時複製失敗怎麼辦？
    - D-Q3: 插入後圖片仍被重存，原因與解法？
    - D-Q5: 檔名含空白或中文導致網址錯誤？

- 高級者：建議關注哪 15 題
    - A-Q7: FTP 與 MetaBlog API 在 WLW 圖片處理上的差異？
    - A-Q11: 為何作者放棄以 API 直接上傳？
    - B-Q9: 插件為何無法讀取 WLW 帳密與發佈設定？
    - B-Q14: 快速原型開發帶來的風險與好處？
    - C-Q8: 如何支援多組對映與站台？
    - C-Q9: 若要走 MetaBlog API，自行實作需怎麼做？
    - C-Q10: 如何維護與更新外掛以因應 WLW 變動？
    - D-Q4: 網址 404 或顯示不了圖片怎麼辦？
    - D-Q6: 插入圖片動作很慢或卡住？
    - D-Q7: 多台電腦使用導致路徑不一致？
    - D-Q8: 外掛與其他外掛衝突如何處理？
    - D-Q9: 若需儲存帳密，有哪些安全作法？
    - D-Q10: WLW 更新後外掛失效如何因應？
    - B-Q3: JPEG 重壓縮的技術機制是什麼？
    - B-Q15: 品質與檔案大小的技術權衡？