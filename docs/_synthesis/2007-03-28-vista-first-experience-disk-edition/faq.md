---
layout: synthesis
title: "Vista 初體驗 - (DISK篇)..."
synthesis_type: faq
source_post: /2007/03/28/vista-first-experience-disk-edition/
redirect_from:
  - /2007/03/28/vista-first-experience-disk-edition/faq/
---

# Vista 初體驗 - (DISK篇)...

## 問題與答案 (FAQ)

### Q&A 類別 A: 概念理解類

A-Q1: 什麼是 Volume Shadow Copy（VSS）？
- A簡: VSS 是 Windows 的快照技術，建立一致時間點副本，利於檔案還原與備份。
- A詳: Volume Shadow Copy（VSS）是 Windows 的快照機制，能在不長時間中斷的情況下，為磁碟分割區建立「一致時間點」的可讀快照。它讓使用者可從「先前版本」快速還原誤刪誤改的檔案，也讓備份軟體獲得一致性資料副本以避免檔案被鎖定。對家庭與工作站而言，VSS 提供補位於 RAID 的人為疏失防護；對伺服器，則是備份與容錯流程的關鍵基礎。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: A-Q2, A-Q3, B-Q1, C-Q1

A-Q2: 為何 Vista 將 VSS 納入用戶端？
- A簡: 讓桌面也具備「先前版本」還原能力，補足誤刪誤改風險。
- A詳: 作者將檔案伺服器職能移到桌面後，最在意的是人為誤刪與誤改的風險。Vista 納入 VSS，等於把伺服器常見的「先前版本」帶到桌面，讓非 IT 環境也能就地復原檔案，縮短復原時間並降低備援門檻。相較於 XP 缺乏 VSS 的不安，Vista 的加入讓單機檔案保護更完整，特別適用於照片、文件等個人關鍵資料。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: A-Q1, A-Q3, C-Q1, D-Q1

A-Q3: VSS 與 RAID-1 有何差異？
- A簡: RAID-1 防硬體故障，VSS 防誤刪誤改；兩者互補非互斥。
- A詳: RAID-1 透過磁碟鏡像提供硬體層的容錯，當單顆磁碟損壞時仍可維持運作；但它會同步複製錯誤動作，無法防止誤刪或勒索加密。VSS 則在檔案系統層建立時間點快照，能回溯變更，補足人為與應用程式誤動作。兩者著力點不同：RAID-1 管硬體可用性，VSS 管資料版本與還原。最佳實務是搭配使用，強化整體資料韌性。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: A-Q4, B-Q4, C-Q9, D-Q7

A-Q4: 有了 RAID-1 為何仍需要 VSS？
- A簡: RAID-1 同步錯誤，VSS 可回溯版本，能救回被誤刪的檔案。
- A詳: 當使用者誤刪照片或覆寫文件，RAID-1 會即時把錯誤寫到鏡像上，造成「兩份一樣錯」。VSS 透過快照保留舊版本，能在事後取回正確副本。作者原以伺服器端組合 RAID-1 與 VSS 雙重保護，換至 XP 時缺 VSS 而不安，改用 Vista 後重獲快照還原能力。因此，VSS 在人為失誤的緩解上不可或缺。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: A-Q3, C-Q1, D-Q1

A-Q5: 什麼是 Windows Complete PC？
- A簡: Vista 內建的整機映像備份，建立可還原的磁碟映像。
- A詳: Windows Complete PC 是 Vista（文中指 Ultimate 版限定）提供的整機映像備份工具，能將系統與資料以區塊層級打包成映像。它像 Ghost 一樣可在災難時完整還原，差異是產出檔案採用 VHD 格式，與 Microsoft 虛擬化工具鏈相容。此工具讓一般用戶也能快速備份整台機器，並為日後虛擬化遷移鋪路。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: A-Q6, A-Q7, B-Q5, C-Q3

A-Q6: 磁碟映像與檔案層級備份差在哪？
- A簡: 映像抓整碟區塊可完整還原；檔案備份抓檔案，細粒度但不含系統狀態。
- A詳: 檔案層級備份以檔案為單位選擇性複製，適合日常文件保護與細粒度還原；磁碟映像則逐區塊擷取，能重建分割、開機記錄與系統設定，適合災難復原與同機還原。映像檔通常較大、還原需重開機；檔案備份較輕量、無法單獨還原作業系統。兩者常搭配，長期靠映像，日常靠檔案備份。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: B-Q5, D-Q8

A-Q7: 什麼是 VHD（Virtual Hard Disk）？
- A簡: VHD 是 Microsoft 推廣的虛擬磁碟檔案格式，供 VM 使用。
- A詳: VHD（Virtual Hard Disk）是 Microsoft 推出的虛擬磁碟檔格式，Virtual PC 與 Virtual Server 以此作為虛擬磁碟。其規格公開，便於各方採用與工具互通。文中指出 Vista 的 Windows Complete PC 也輸出 VHD，讓備份映像可直接被虛擬機掛載使用，促成「備份即虛擬化資產」的重用效益。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: A-Q5, B-Q6, B-Q7, C-Q5

A-Q8: 為何 Vista 的映像會用 VHD 格式？
- A簡: 統一格式利於跨產品重用，備份就能直接成虛擬磁碟。
- A詳: 採用 VHD 可讓 Windows Complete PC 的映像與 Microsoft 虛擬化堆疊無縫銜接。使用者不必轉檔，就能將實體機映像掛到 Virtual PC/Server 測試或啟動。對生態系來說，統一格式帶來互通、降低遷移成本與加強鎖定力；對個人用戶，則讓災難復原與 P2V 更直接。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q7, B-Q5, B-Q13, C-Q6

A-Q9: 什麼是 Microsoft iSCSI Initiator？
- A簡: 它是 iSCSI 用戶端，讓 Windows 連上遠端區塊儲存裝置。
- A詳: Microsoft iSCSI Initiator 是 Windows 端的 iSCSI 用戶端元件，能透過 TCP/IP 網路把遠端儲存（Target）當作本機磁碟使用。文中提到 Vista 內建此元件，顯示用戶端已為 iSCSI 準備妥當，利於未來與伺服器端 iSCSI Target 搭配，並可能與 VHD、生態系工具整合，形成網路化的虛擬磁碟工作流。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: A-Q10, B-Q9, C-Q7, D-Q5

A-Q10: iSCSI 的 Initiator 與 Target 有何差異？
- A簡: Initiator 是用戶端發起連線；Target 提供區塊儲存服務。
- A詳: 在 iSCSI 架構中，Initiator 為用戶端，負責發起連線與發送 SCSI 命令；Target 為伺服端，提供邏輯單元（LUN）並回應命令。兩者透過 TCP/IP 溝通，讓遠端儲存像本地磁碟般被分割與格式化。Vista 內建 Initiator，若伺服器端提供 Target，客戶端即可將 LUN 掛載、開機或提供給虛擬機使用。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: A-Q9, B-Q9, B-Q14, C-Q7

A-Q11: 內建 iSCSI Initiator 有何意義？
- A簡: 降低部署門檻，鋪路給 iSCSI 與虛擬化、VHD 的整合。
- A詳: 以系統內建取代另行下載，能縮短上手時間並普及 iSCSI 的使用。配合 VHD 的策略統一，未來可望出現以 iSCSI Target 直接提供 .vhd 的場景，使虛擬機從網路磁碟啟動、移動工作負載更容易。對個人與企業，這代表更靈活的儲存與虛擬化佈局，與更高的資產重用性。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: B-Q14, C-Q7, D-Q9

A-Q12: 什麼是 Virtual PC / Virtual Server？
- A簡: Microsoft 的虛擬化產品，皆以 VHD 作為虛擬磁碟。
- A詳: Virtual PC 與 Virtual Server 是 Microsoft 早期的桌面與伺服器虛擬化解決方案。兩者皆使用 VHD 作為虛擬磁碟格式，支援將現有 VHD 掛載、建立新 VM、測試與隔離工作負載。文中強調 Complete PC 亦輸出 VHD，使實體映像與虛擬化資產一致，簡化 P2V 與測試場景。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: A-Q7, A-Q8, B-Q7, C-Q6

A-Q13: 如何概念上將 Vista 實體機移入 VM（P2V）？
- A簡: 先做映像成 VHD，再在 VM 掛載啟動並修復驅動。
- A詳: 核心思路是「備份即資產」。先用 Windows Complete PC 建立整機映像（VHD），在虛擬化平台建立 VM，選擇「使用既有磁碟」掛上該 VHD，開機後以系統修復調整開機載入與驅動，最後安裝增強工具。過程藉由 VHD 的跨產品一致性，省去轉檔與資料抽取的麻煩。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: B-Q12, C-Q10, D-Q3

A-Q14: 什麼是 VHD 掛載（VHD Mount）？
- A簡: 不啟動 VM，直接把 VHD 當磁碟掛上讀寫。
- A詳: VHD 掛載是一種將 VHD 檔案以邏輯磁碟方式附加到系統的機制，使用者可直接存取其內容而無須啟動虛擬機。文中提到 Virtual Server 2005 R2 SP1 將提供 VHD Mount 工具，讓備份映像（VHD）更易於檢視、救援檔案與離線維護，擴大 VHD 的通用性。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q7, B-Q8, C-Q5, D-Q4

A-Q15: Ghost 與 Windows Complete PC 有何不同？
- A簡: 兩者皆成像，但 Complete PC 產出 VHD，便於虛擬化重用。
- A詳: 兩者本質都做磁碟映像備份與還原。差異在於 Windows Complete PC 為 Vista 內建、與系統相容性最佳，且輸出 VHD 格式，能直接被 Microsoft 虛擬化產品使用；Ghost 傾向跨平台、獨立工具鏈。採 VHD 使備份、測試、虛擬化共用一個格式，降低跨環境摩擦成本。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: A-Q5, A-Q7, B-Q5, B-Q13

A-Q16: 為何主機板內建 RAID 讓人卻步？
- A簡: 依賴驅動與廠商實作，容錯與移轉風險較高。
- A詳: 主機板 RAID（俗稱假硬 RAID）高度依賴特定晶片與驅動。當主機板損壞或更換型號，陣列可能難以在他處復原；韌體成熟度與監控工具也不如專業卡。作者因此認為「可怕」，偏好 OS 層或專用卡。對個人資料而言，可靠度與可攜性往往比表面效能更重要。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q3, B-Q17, D-Q7

A-Q17: 什麼是 Microsoft 的「重用（reuse）」策略？
- A簡: 以通用元件與格式在各產品重複利用，放大價值。
- A詳: 文中指出 Microsoft 擅長把技術投資化整為零件與格式，再在多處重用：IE 作為可嵌入元件、VHD 作為備份與虛擬化共通格式、iSCSI 與虛擬化結合等。此策略降低開發與整合成本，建立生態系黏著，讓競爭不只比單一產品，而是比整體平台能力。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: A-Q8, B-Q13, B-Q22

A-Q18: Microsoft 如何以 IE 對抗 Netscape？
- A簡: 不只做更好的瀏覽器，還把 IE 變成可重用的平台。
- A詳: 作者觀察，Microsoft 將 IE 打造成可嵌入元件並提供 SDK，讓各處都能利用其渲染能力：HTML Help、檔案總管、桌面、管理工具與應用。如此即便使用者改用他牌瀏覽器，仍離不開 IE 的元件與平台功能。這種平台化重用策略，強化了生態系與競爭優勢。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: B-Q15, B-Q22

---

### Q&A 類別 B: 技術原理類

B-Q1: VSS 如何運作？
- A簡: 以 copy-on-write 建立一致快照，由 Requester/Writer/Provider 協作。
- A詳: VSS 透過 Requester（備份程式）發起，協調各 Writer（如 SQL Writer）凍結 I/O，Provider 以 copy-on-write 或 redirect-on-write 方式保留變更前資料，形成一致快照。流程包含準備、凍結、建立快照與解凍。快照完成後，應用恢復寫入，Requester 讀取快照進行備份或還原。核心組件：VSS Service、Writer、Provider。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q1, B-Q2, C-Q2

B-Q2: VSS 的組件各自扮演什麼角色？
- A簡: Requester 發起，Writer 保證一致性，Provider 實作快照。
- A詳: Requester（如備份工具）控制整體流程；Writer 是應用端外掛，確保應用一致性（快照前 flush/commit）；Provider 為快照實作者，可為系統、硬體或軟體 Provider。VSS Service 負責仲裁協調，確保凍結時間短與還原一致。這三者配合，才能在不停機下獲得可用的時間點資料。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: B-Q1, C-Q2

B-Q3: Vista「先前版本」的執行流程為何？
- A簡: 透過系統保護建立快照，右鍵檔案即可回溯版本。
- A詳: 啟用系統保護後，系統在還原點或觸發時刻建立卷影快照。使用者在檔案或資料夾上右鍵選「先前版本」，可瀏覽快照中的版本並還原或複製。流程：1) 啟用保護；2) 產生快照；3) 透過外殼擷取快照內容。核心組件：System Protection、VSS、殼層整合。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: A-Q2, C-Q1, D-Q1

B-Q4: RAID-1 的技術原理與侷限是什麼？
- A簡: 寫入同時鏡像至兩碟，抗單顆故障；不防誤刪。
- A詳: RAID-1 將相同資料寫入兩顆磁碟，提供讀取擴展與單顆失效容忍。重建時以存活磁碟複製回新碟。侷限：人為錯誤與邏輯損毀會被同步複製；控制器相依性影響移植；寫入效能受限。核心組件：控制器/驅動、鏡像集、重建流程。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: A-Q3, A-Q16, D-Q7

B-Q5: Windows Complete PC 成像的技術流程？
- A簡: 以 VSS 凍結一致性，區塊層複製成 VHD 格式映像。
- A詳: 工具先呼叫 VSS 建立一致快照，確保系統檔不變動；接著以區塊層掃描並複製使用中的區塊，寫入 VHD 容器；最後記錄分割與開機結構以利還原。關鍵步驟：VSS 協調、區塊複製、VHD 生成、驗證。核心組件：Backup Engine、VSS、VHD 寫入器。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q5, A-Q8, B-Q6, C-Q3

B-Q6: VHD 的格式種類與結構是什麼？
- A簡: 常見有固定與動態兩類，皆含磁區表頭與資料區。
- A詳: 固定大小 VHD 於建立時配置完整容量；動態 VHD 隨寫入成長，節省空間。兩者包含表頭（識別與幾何資訊）、區塊配置表（動態檔用）與資料區。此結構讓 VHD 能模擬實體磁碟供 VM 開機與 I/O。核心組件：Footer/Header、BAT、Data Blocks。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q7, B-Q7, C-Q5

B-Q7: 虛擬機如何以 VHD 開機？
- A簡: VM 將 VHD 當虛擬磁碟，BIOS/UEFI 載入其開機記錄。
- A詳: 虛擬機的控制器（IDE/SCSI 等）掛載 VHD，虛擬 BIOS/UEFI 從其 MBR/BCD 載入開機程式，之後 OS 掛載虛擬硬體並驅動。流程：建立 VM→附加 VHD→設定開機順序→啟動載入器→進 OS。核心組件：虛擬控制器、VHD、韌體、載入器。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q12, C-Q6, D-Q10

B-Q8: VHD Mount 的機制與用途？
- A簡: 透過驅動將 VHD 映射為磁碟裝置，供檔案存取。
- A詳: VHD Mount 工具安裝虛擬磁碟驅動，將 VHD 檔映射成邏輯磁碟，由檔案系統掛載供應用使用。用途：取檔、維護、離線掃描。流程：安裝工具→指令或 GUI 掛載→指派磁碟機代號。核心組件：VHD 解析器、虛擬磁碟驅動、卷管理。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q14, C-Q5, D-Q4

B-Q9: iSCSI 的基本協定與會話流程？
- A簡: 以 TCP/IP 承載 SCSI 命令，建立 Session/Connection 傳輸。
- A詳: iSCSI 將 SCSI CDB 封裝於 TCP，Initiator 與 Target 透過協商（Login/NOP）建立 Session，可含多個 Connection 平行傳輸。命名以 IQN 表示，安全可用 CHAP。流程：Discovery→Login→認證→命令/資料交換。核心組件：Initiator 驅動、Target 服務、TCP 堆疊。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q9, A-Q10, C-Q7

B-Q10: Windows iSCSI Initiator 的架構？
- A簡: 由服務、驅動與控制台組成，管理連線與裝置。
- A詳: 結構包含核心驅動（iscsiprt.sys）處理 I/O 與連線，使用者模式服務管理工作階段與持久設定，控制台（iscsicpl）提供 GUI。支援開機後自動重連、CHAP 認證與裝置持續對應。核心組件：驅動、服務、管理工具。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q9, C-Q7, D-Q9

B-Q11: 如何以 VSS 產生一致性的映像？
- A簡: 先凍結 I/O 建快照，再從快照讀取區塊成像。
- A詳: 備份引擎呼叫 VSS，Writer 完成應用一致性動作（flush/commit），Provider 建立快照。成像程式從快照讀取，避免被開啟檔案鎖定或資料競態。完成後釋放快照。關鍵在於在短時間凍結中完成快照，降低停頓。核心組件：VSS API、Writer、Provider。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: B-Q1, B-Q5, C-Q3

B-Q12: 以 VHD 為核心的 P2V 轉換路徑？
- A簡: Complete PC 產生 VHD→新建 VM→掛載→修復驅動。
- A詳: 先以 Complete PC 建立 VHD 映像；在虛擬化平台建立 VM，選擇使用既有 VHD；啟動進入修復環境校正 BCD/MBR；進 OS 安裝整合元件與汰換實體驅動。核心組件：VHD、VM 控制器、WinRE、驅動模型。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q13, C-Q10, D-Q3

B-Q13: 在虛擬化堆疊重用 VHD 的優勢？
- A簡: 一次產生，多處使用；降低轉檔與整合成本。
- A詳: 同一份 VHD 映像可被備份、測試、VM 啟動與取檔工具共用，形成單一事實來源。這帶來轉檔零成本、工作流簡化、工具生態一致與學習曲線下降。核心組件：標準化格式、通用 API、廣泛支援的工具鏈。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: A-Q8, A-Q17, B-Q20

B-Q14: 以 iSCSI Target 提供 VHD 給 VM 的原理？
- A簡: 將 VHD 置於 LUN，VM 經網路掛載當啟動磁碟。
- A詳: Target 將承載 VHD 的 LUN 透過 iSCSI 提供；VM 之 Initiator 連線並將其當區塊裝置。若韌體支援，可由 iSCSI 開機；否則由 OS 掛載作資料磁碟。這讓 VM 可跨主機移轉資料，或集中儲存。核心組件：Target 服務、LUN、Initiator。
- 難度: 高級
- 學習階段: 進階
- 關聯概念: A-Q11, B-Q9, C-Q7

B-Q15: 以 IE 控制項重用 Web 能力的技術機制？
- A簡: 透過可嵌入的 WebBrowser 控制項與 COM 介面。
- A詳: IE 提供 WebBrowser 可嵌入控制項與 COM 介面，讓應用內嵌 HTML/JS 渲染與瀏覽功能；系統元件如檔案總管、說明檔亦重用此能力。流程：宿主載入控制項→導入 URL/HTML→處理事件。核心組件：WebBrowser 控制項、Trident 引擎、COM。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q18, B-Q22

B-Q16: VSS 的效能開銷與快照儲存管理？
- A簡: 快照需儲存變更區塊；多快照增長，影響寫入。
- A詳: Copy-on-write 需在第一次寫入時保存原區塊，造成額外 I/O 與空間開銷；快照愈多，追蹤表與差異資料增加。管理上應限制快照數量、放置於足夠空間的磁碟、避開高 I/O 時段建立。核心組件：差異區、追蹤表、配額策略。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: D-Q6, C-Q2

B-Q17: 主機板 RAID、硬體 RAID、軟體 RAID 差異？
- A簡: 主機板依賴驅動；硬體 RAID 有專用卡；軟 RAID 由 OS 管理。
- A詳: 主機板 RAID 多倚賴驅動，移植性較差；硬體 RAID 由專用控制卡處理 XOR/鏡像，穩定與監控較佳；軟體 RAID 由 OS 實作，易移植但佔用 CPU。選擇考量可靠度、移植性、管理性與成本。核心組件：控制器、驅動、韌體/OS。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q16, D-Q7

B-Q18: Complete PC 還原的啟動流程（WinRE/BCD）？
- A簡: 自修復環境啟動，辨識映像，重建分割與 BCD。
- A詳: 由 Vista 安裝媒體進入修復（WinRE），選擇 Complete PC 還原，工具掛載映像並重建分割表、格式化、還原資料，最後更新 BCD 與開機程式。流程：啟動 WinRE→選映像→重建→重啟驗證。核心組件：WinRE、映像還原引擎、BCD 編輯器。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: C-Q4, D-Q3, D-Q10

B-Q19: iSCSI 的 CHAP 驗證與安全機制？
- A簡: 以 CHAP 驗證 Initiator 身分，保護存取；可搭配防火牆。
- A詳: iSCSI 可使用單向或互相 CHAP，以共享密碼計算摘要驗證，避免明文密碼。再配合網段隔離、ACL、Target 端 IQN 白名單與防火牆，降低未授權存取風險。核心組件：CHAP、IQN、ACL、封包過濾。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: C-Q7, D-Q5, D-Q9

B-Q20: VHD 與映像的跨產品互通案例？
- A簡: 備份 VHD 可被 VM 啟動、被掛載工具讀取、供測試。
- A詳: 一份由 Complete PC 產生的 VHD，能被 Virtual PC/Server 當系統碟啟動、被 VHD Mount 掛載取檔、提供 QA 重現環境、供開發驗證安裝流程。此即格式統一帶來的跨場景互通性。核心組件：VHD、VM、掛載工具。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: A-Q8, C-Q5, C-Q6

B-Q21: 映像還原到異質硬體的驅動調適？
- A簡: 需修復啟動載入器、改通用儲存驅動並安裝新驅動。
- A詳: 從映像還原或 P2V 後，常見開機失敗因控制器差異。解法：進 WinRE 執行啟動修復、確保通用 IDE/SATA 驅動啟用、移除舊驅動、安裝新環境驅動與整合工具。核心組件：WinRE、BCD、儲存驅動、整合元件。
- 難度: 高級
- 學習階段: 進階
- 關聯概念: C-Q10, D-Q3, D-Q10

B-Q22: 為何統一格式會形成生態系網路效應？
- A簡: 格式通用促進工具互補與重用，使用越多價值越高。
- A詳: 當多產品圍繞單一格式開發，工具鏈互補性提升、學習成本下降、轉移摩擦減少，吸引更多開發者與使用者加入。這形成正回饋的網路效應，競爭不再是點對點，而是整體能力比拚。文中以 VHD、IE 元件為例即此。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: A-Q17, A-Q18, B-Q13

---

### Q&A 類別 C: 實作應用類

C-Q1: 如何在 Vista 啟用並使用「先前版本」？
- A簡: 於系統保護開啟磁碟保護，右鍵檔案即可還原版本。
- A詳: 步驟：1) 右鍵電腦→內容→系統保護；2) 勾選欲保護磁碟；3) 建立還原點或等待系統建立；4) 在檔案/資料夾右鍵→先前版本→選擇版本還原/複製。注意：需足夠磁碟空間；勿與大量寫入工作同時建立。最佳實踐：保護含關鍵資料的磁碟，定期檢查可用空間。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: A-Q2, B-Q3, D-Q1

C-Q2: 如何手動建立 VSS 快照（命令列）？
- A簡: 以「vssadmin create shadow」建立，清單用 list shadows。
- A詳: 以系統管理員身分執行：vssadmin create shadow /for=C: 建立 C 槽快照；vssadmin list shadows 檢視；完成後以 delete shadows 清除。注意：僅測試或特定需求使用；避免長期保留太多快照。最佳實踐：在低負載時建立，保留必要數量並監控空間。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: B-Q1, B-Q16, D-Q6

C-Q3: 如何用 Windows Complete PC 建立映像？
- A簡: 透過備份與還原中心，選擇完整電腦備份至外碟。
- A詳: 步驟：控制台→備份與還原中心→Windows Complete PC 備份→選外接硬碟或網路位置→選擇要備份的磁碟→開始。重要設定：確保目的地空間足夠；避免備份到同一實體磁碟。最佳實踐：定期備份；備妥啟動媒體以便災難時還原。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: A-Q5, B-Q5, D-Q2

C-Q4: 如何使用安裝媒體執行 Complete PC 還原？
- A簡: 自 DVD 啟動進修復，選完整電腦還原並指定映像。
- A詳: 步驟：以 Vista DVD 開機→修復電腦→Windows Complete PC 還原→選最新映像或指定路徑→確認重建分割與格式化→執行還原→完成後重啟。注意：目的磁碟將被覆寫；異硬體需額外驅動。最佳實踐：事前測試還原流程，確保可用。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: B-Q18, D-Q3, D-Q8

C-Q5: 如何將 Complete PC 產生的 VHD 掛載取檔？
- A簡: 安裝 VHD Mount 工具，掛載 VHD 為磁碟機讀寫。
- A詳: 安裝 Virtual Server 2005 R2 SP1 的 VHDMount；以 GUI/命令列掛載：vhdmount /p 路徑.vhd；於磁碟管理指派代號後讀寫檔案。注意：避免同時被 VM 使用；操作完卸載。最佳實踐：唯讀掛載做鑑識/取檔，降低風險。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q14, B-Q8, D-Q4

C-Q6: 如何用既有 VHD 建立並啟動一台 VM？
- A簡: 建立 VM，選用既有磁碟，指向 VHD，調整開機序後啟動。
- A詳: 在 Virtual PC/Server 新建 VM→選「使用現有虛擬硬碟」→指向映像 VHD→配置記憶體與網路→設定從該控制器開機→啟動進入 OS。注意：初次開機可能需修復；安裝整合元件。最佳實踐：先複製一份 VHD 做實驗，保留原始備份。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q12, B-Q7, D-Q10

C-Q7: 如何在 Vista 連線到 iSCSI Target？
- A簡: 啟動 iSCSI Initiator，新增目標入口，連線並持久化。
- A詳: 開始→輸入 iscsicpl→Discovery→Add Portal（輸入 Target IP）→Targets→選中目標→Connect→啟用自動還原→必要時設定 CHAP→磁碟管理初始化/格式化。注意：開防火牆例外；確保網段穩定。最佳實踐：使用專用網段與認證。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q9, B-Q10, D-Q5

C-Q8: 如何不啟動 VM 從 VHD 萃取檔案？
- A簡: 以 VHDMount 或支援 VHD 的工具讀取並複製。
- A詳: 方法一：VHDMount 掛載後，像一般磁碟瀏覽複製。方法二：使用支援 VHD 的壓縮工具（如 7-Zip）直接開啟抽取。注意：唯讀開啟較安全；避免同時被 VM 使用。最佳實踐：保留原檔案校驗碼以驗證完整性。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: C-Q5, D-Q4

C-Q9: 如何規劃照片區的雙重防護（RAID-1+VSS）？
- A簡: 建立鏡像陣列防硬體故障，啟用 VSS 防誤刪。
- A詳: 步驟：1) 設定 RAID-1 存放照片；2) 在該分割啟用系統保護；3) 規劃定期還原點/快照；4) 監控空間使用；5) 定期做離線映像備份。注意：主機板 RAID 風險；備援多地。最佳實踐：雙重保護外再加離線備份三二一原則。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q3, A-Q4, B-Q4, D-Q7

C-Q10: 如何以映像快速將 Vista 實體搬到 VM（P2V）？
- A簡: 建 VHD 映像→新建 VM 掛載→修復啟動→裝整合元件。
- A詳: 1) 用 Complete PC 建立 VHD；2) 虛擬化平台新 VM，掛上 VHD；3) 用安裝媒體進 WinRE 做啟動修復（bootrec /rebuildbcd）；4) 進 OS 移除實體特定驅動，裝虛擬整合工具；5) 測試穩定性。注意：授權合規；原機與 VM 切換時避免同時上線。
- 難度: 高級
- 學習階段: 進階
- 關聯概念: A-Q13, B-Q12, D-Q3

---

### Q&A 類別 D: 問題解決類

D-Q1: 看不到「先前版本」怎麼辦？
- A簡: 確認已啟用系統保護並有有效還原點與足夠空間。
- A詳: 症狀：檔案右鍵無「先前版本」或列表為空。可能原因：未開啟系統保護、沒有還原點、磁碟空間不足、磁碟未受保護。解法：啟用系統保護、手動建立還原點、調整空間、等待排程。預防：長期保持保護開啟並監控空間。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: C-Q1, B-Q3

D-Q2: Complete PC 備份失敗或空間不足？
- A簡: 釋放目的地空間、排除同碟、使用外接碟或網路路徑。
- A詳: 症狀：備份中斷、容量不足訊息。原因：目的地容量不夠、來源與目的同一實體碟、I/O 忙碌。解法：改用外接碟/網路分享、預留 2–3 倍預估容量、在低負載時段執行。預防：定期清理舊映像，採滾動保留策略。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: C-Q3, B-Q5

D-Q3: 映像還原或 P2V 後開機藍畫面怎麼辦？
- A簡: 進 WinRE 修復開機，啟用通用儲存驅動並重建 BCD。
- A詳: 症狀：0x7B 藍畫面或啟動修復迴圈。原因：控制器驅動不符、BCD 設定錯誤、硬體差異。解法：以安裝媒體進 WinRE→啟動修復→命令列 bootrec /fixmbr /fixboot /rebuildbcd→啟用通用 IDE/SATA 驅動→進系統裝 VM 整合工具。預防：還原前先 Sysprep 或預裝通用驅動。
- 難度: 高級
- 學習階段: 進階
- 關聯概念: B-Q18, B-Q21, C-Q10

D-Q4: VHD 掛載失敗或讀寫錯誤如何處理？
- A簡: 檢查掛載驅動、唯讀模式、檔案損毀與同時開啟。
- A詳: 症狀：掛載指令失敗、讀寫 IO 錯誤。原因：VHDMount 未安裝或驅動未載入、檔案毀損、VHD 正被 VM 使用。解法：重裝工具、以唯讀掛載、檢查檔案雜湊、關閉占用 VM。預防：操作前複製一份，避免同時多處開啟。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: C-Q5, B-Q8

D-Q5: 連上 iSCSI 但在磁碟管理看不到磁碟？
- A簡: 確認連線已登入，重新掃描磁碟，初始化並指派代號。
- A詳: 症狀：Initiator 顯示 Connected，但系統無新磁碟。原因：LUN 不可見、路徑未完成、未初始化/分割、服務未啟。解法：Targets→Properties 確認登入持久化→磁碟管理「重新掃描磁碟」→初始化 GPT/MBR→建立分割。預防：Target 端配置對應並綁定 IQN。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: C-Q7, B-Q10, B-Q19

D-Q6: 啟用 VSS 後磁碟空間快速下降？
- A簡: 控制快照數量與大小，清理舊快照並調整配額。
- A詳: 症狀：可用空間持續減少。原因：快照保存太多差異區塊、建立頻繁。解法：vssadmin list shadowstorage 檢視→resize/shrink→delete shadows 清理舊快照→調整建立頻率。預防：設定合理空間上限並監控。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: B-Q16, C-Q2

D-Q7: 主機板 RAID 當機或換板如何救資料？
- A簡: 以相同控制器救援、轉移至專業卡或改走軟體 RAID。
- A詳: 症狀：換板後陣列不被識別。原因：控制器相依性。解法：尋找相同型號控制器讀取陣列、以唯讀方式備份資料、後續遷移至專業卡或 OS 級 RAID。預防：避免關鍵資料依賴主機板 RAID；另做映像備份。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q16, B-Q17, C-Q9

D-Q8: 映像還原到較小容量磁碟失敗怎麼辦？
- A簡: 需等容量或更大磁碟；先行縮小分割再製作映像。
- A詳: 症狀：工具拒絕還原到較小磁碟。原因：映像含分割表與容量限制。解法：在原機先縮小分割與使用空間，重做映像；或改用能調整還原大小的工具。預防：製作映像前整理磁碟並預留空間。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q6, C-Q3, C-Q4

D-Q9: iSCSI 重開機後連線遺失如何處理？
- A簡: 啟用持久連線、自動還原，檢查 CHAP 與防火牆。
- A詳: 症狀：重開機後 LUN 不再掛載。原因：未啟用自動連線、認證失敗、服務延遲。解法：iscsicpl→目標→Connect→勾選自動還原與持續連線；確認 CHAP 密碼；開放防火牆；延遲依賴服務。預防：使用固定 IP 或 DNS 解析。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: C-Q7, B-Q10, B-Q19

D-Q10: 用 VHD 啟動 VM 卡在啟動修復迴圈？
- A簡: 於 WinRE 手動修復 BCD/MBR，確保控制器驅動可用。
- A詳: 症狀：反覆進入啟動修復。原因：BCD 指向錯誤、啟動分割未設為作用中、控制器驅動缺失。解法：WinRE→命令列：bootrec /fixmbr /fixboot /rebuildbcd；diskpart 設為 active；切換 VM 控制器為通用模式。預防：P2V 前啟用通用儲存驅動。
- 難度: 高級
- 學習階段: 進階
- 關聯概念: B-Q7, B-Q18, C-Q6

---

### 學習路徑索引
- 初學者：建議先學習哪 15 題
    - A-Q1: 什麼是 Volume Shadow Copy（VSS）？
    - A-Q2: 為何 Vista 將 VSS 納入用戶端？
    - A-Q3: VSS 與 RAID-1 有何差異？
    - A-Q4: 有了 RAID-1 為何仍需要 VSS？
    - A-Q5: 什麼是 Windows Complete PC？
    - A-Q6: 磁碟映像與檔案層級備份差在哪？
    - A-Q7: 什麼是 VHD（Virtual Hard Disk）？
    - A-Q9: 什麼是 Microsoft iSCSI Initiator？
    - A-Q10: iSCSI 的 Initiator 與 Target 有何差異？
    - A-Q12: 什麼是 Virtual PC / Virtual Server？
    - A-Q15: Ghost 與 Windows Complete PC 有何不同？
    - C-Q1: 如何在 Vista 啟用並使用「先前版本」？
    - C-Q3: 如何用 Windows Complete PC 建立映像？
    - D-Q1: 看不到「先前版本」怎麼辦？
    - D-Q2: Complete PC 備份失敗或空間不足？

- 中級者：建議學習哪 20 題
    - B-Q1: VSS 如何運作？
    - B-Q2: VSS 的組件各自扮演什麼角色？
    - B-Q3: Vista「先前版本」的執行流程為何？
    - B-Q5: Windows Complete PC 成像的技術流程？
    - B-Q6: VHD 的格式種類與結構是什麼？
    - B-Q7: 虛擬機如何以 VHD 開機？
    - B-Q8: VHD Mount 的機制與用途？
    - B-Q9: iSCSI 的基本協定與會話流程？
    - B-Q10: Windows iSCSI Initiator 的架構？
    - B-Q16: VSS 的效能開銷與快照儲存管理？
    - B-Q17: 主機板 RAID、硬體 RAID、軟體 RAID 差異？
    - C-Q2: 如何手動建立 VSS 快照（命令列）？
    - C-Q4: 如何使用安裝媒體執行 Complete PC 還原？
    - C-Q5: 如何將 Complete PC 產生的 VHD 掛載取檔？
    - C-Q6: 如何用既有 VHD 建立並啟動一台 VM？
    - C-Q7: 如何在 Vista 連線到 iSCSI Target？
    - C-Q8: 如何不啟動 VM 從 VHD 萃取檔案？
    - D-Q4: VHD 掛載失敗或讀寫錯誤如何處理？
    - D-Q5: 連上 iSCSI 但在磁碟管理看不到磁碟？
    - D-Q6: 啟用 VSS 後磁碟空間快速下降？

- 高級者：建議關注哪 15 題
    - A-Q8: 為何 Vista 的映像會用 VHD 格式？
    - A-Q13: 如何概念上將 Vista 實體機移入 VM（P2V）？
    - A-Q16: 為何主機板內建 RAID 讓人卻步？
    - A-Q17: 什麼是 Microsoft 的「重用（reuse）」策略？
    - A-Q18: Microsoft 如何以 IE 對抗 Netscape？
    - B-Q12: 以 VHD 為核心的 P2V 轉換路徑？
    - B-Q14: 以 iSCSI Target 提供 VHD 給 VM 的原理？
    - B-Q18: Complete PC 還原的啟動流程（WinRE/BCD）？
    - B-Q19: iSCSI 的 CHAP 驗證與安全機制？
    - B-Q21: 映像還原到異質硬體的驅動調適？
    - B-Q22: 為何統一格式會形成生態系網路效應？
    - C-Q9: 如何規劃照片區的雙重防護（RAID-1+VSS）？
    - C-Q10: 如何以映像快速將 Vista 實體搬到 VM（P2V）？
    - D-Q3: 映像還原或 P2V 後開機藍畫面怎麼辦？
    - D-Q10: 用 VHD 啟動 VM 卡在啟動修復迴圈？