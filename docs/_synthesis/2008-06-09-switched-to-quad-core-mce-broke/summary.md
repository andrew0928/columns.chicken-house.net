---
layout: synthesis
title: "換了四核心，MCE就掛了..."
synthesis_type: summary
source_post: /2008/06/09/switched-to-quad-core-mce-broke/
redirect_from:
  - /2008/06/09/switched-to-quad-core-mce-broke/summary/
---

# 換了四核心，MCE就掛了...

## 摘要提示
- 硬體升級: 將桌機從雙核心 E6300 換成四核心 Q9300，性能與溫度表現更好。
- MCE 異常: 升級後 Windows Media Center（MCE）與播放器播放錄影檔時即崩潰。
- 錯誤提示: 畫面顯示 General Protection Failure，詳細資訊指向 Indiv01.key。
- 問題排查: 起初懷疑是四核心與 Microsoft 編解碼器相容性問題，但網路查詢顯示他人使用正常。
- 關鍵線索: 錯誤模組 Indiv01.key 是 Microsoft DRM 相關秘鑰檔。
- 官方文件: 依據 KB891664，硬體變更可能導致 Windows Media DRM 系統失效。
- 問題本質: DRM 授權與硬體指紋（含 CPU 核心數）綁定，硬體變動被視為換機。
- 解決作法: 依 KB 指南清除 DRM 授權並重新初始化，重新啟動後恢復正常。
- 經驗教訓: 硬體更動可能引發 DRM 與系統授權問題，需有重設與除錯的心理準備。
- 使用者提醒: 換四核心前請備妥耐心或重灌準備，避免花費大量時間排查。

## 全文重點
作者為了提升家用伺服器效能，購買 Intel Q9300 四核心處理器，先裝到桌機測試。更換後系統整體表現良好，速度快、溫度低，但開啟 Windows Media Center（MCE）觀看電視或播放先前錄製的 dvr-ms 檔案時，卻立即崩潰，顯示類似 General Protection Failure 的錯誤畫面。即便改用 Windows Media Player 或 Media Player Classic 也同樣當機，初步讓作者懷疑四核心與 Microsoft 的編解碼器不相容。

然而，透過搜尋發現許多使用 Q9300 的用戶在 MCE 上運作正常，表示問題不在四核心硬體本身。回頭檢視錯誤詳細資訊時，發現錯誤模組為 Indiv01.key，這不像一般動態連結檔，進一步查詢後得知它是 Microsoft Windows Media DRM 所使用的個別化秘鑰檔，負責識別該台電腦的獨特授權資訊。接著在 Microsoft 的支援文件 KB891664 中找到關鍵解釋：當電腦硬體變更（包括可用 CPU 數量）時，Windows Media Digital Rights Management 系統可能無法運作。原因在於 DRM 的授權與硬體指紋綁定，若像作者這樣將 CPU 由雙核換為四核，系統會判定硬體特徵已變，視為換了一台新電腦，因而以舊的 DRM 金鑰播放舊內容時會被拒絕，導致播放程式崩潰。

瞭解根因後，作者依照 KB 指南，清除 DRM 授權並重新初始化個別化金鑰，重開機後，MCE 與其他播放器播放錄影內容即恢復正常。整個修復流程約十分鐘，但在找到正確方向之前，作者為此困擾了數小時。文末提醒，有意更換四核心或進行重大硬體升級的使用者，要預期可能會觸發 DRM 與授權機制問題，需備妥耐心、遵循官方指引重建授權，否則可能得面臨重灌或長時間排查。作者也藉此感嘆，DRM 綁定硬體的設計雖出於版權保護，但對合法使用者造成實務不便，尤其是在日常硬體升級情境中。

## 段落重點
### 升級四核心的起心動念與初步體驗
作者為提升 SERVER 效能購買 Q9300，先裝到桌機測試。升級後整體運行順暢，速度更快、溫度更低，初步體驗良好。桌機平時以 Vista 的 MCE 看電視與錄影，屬於高度依賴多媒體播放的使用情境。

### 異常出現：MCE 與播放器全面崩潰
在啟動 MCE 觀看電視時立即掛掉，出現美化過的 General Protection Failure 畫面；即使使用 Windows Media Player 或 Media Player Classic 播放先前錄下的 dvr-ms 也同樣崩潰。初步懷疑是四核心與 Microsoft 的 codec 兼容性問題，但此推測缺乏實證。

### 排查歷程：從懷疑相容性到鎖定 Indiv01.key
透過搜尋發現他人使用 Q9300 搭配 MCE 一切正常，排除四核心硬體本身不相容的可能。回看錯誤詳細資訊，注意到錯誤模組為 Indiv01.key，名稱不像一般 DLL，進一步查知其為 Windows Media DRM 的個別化金鑰檔，暗示問題與 DRM 授權機制有關。

### 官方解答：硬體變更導致 DRM 授權失效
在 Microsoft 支援中心找到 KB891664，說明電腦硬體變更（包含可用 CPU 數量）可能使 Windows Media DRM 失效。DRM 的金鑰生成會綁定硬體指紋，若 CPU 核心數改變，系統可能認定為「換機」，用舊金鑰播放舊內容即被視為授權不合法，導致播放被阻擋甚至應用崩潰。

### 修復步驟與結果：重建 DRM 個別化金鑰
依 KB 指南清除 DRM 授權與個別化資訊，讓系統重新生成 Indiv01.key，並重開機。操作完成後，MCE 與其他播放器恢復正常播放，證實問題根因在於 DRM 與硬體綁定。整個修復流程耗時不長，但前期定位問題花了數小時。

### 教訓與建議：硬體升級的隱形成本
作者感嘆 DRM 綁硬體帶來的實務困擾，提醒使用者在更換 CPU 或進行重大硬體升級前，應預期可能觸發 DRM、授權或內容播放問題，準備好相關重設步驟與耐心；否則可能需重灌或花費大量時間除錯。此案例也反映出保護機制與使用體驗間的權衡，對合法用戶並不友善。

## 資訊整理

### 知識架構圖
1. 前置知識：  
   - 基本的 Windows/Vista 與 Media Center (MCE) 使用經驗  
   - 了解數位版權管理（DRM）的概念與授權機制  
   - 會閱讀錯誤訊息、搜尋微軟知識庫（KB）與網路資源

2. 核心概念：  
   - Windows Media DRM 與硬體綁定：DRM 使用硬體組態產生機器專屬的金鑰  
   - Indiv01.key：Windows Media DRM 個別化金鑰檔，與裝置硬體指紋相依  
   - 硬體變更影響：CPU 核心數改變會改變硬體指紋，導致 DRM 視為「不同電腦」  
   - 症狀表現：MCE/Windows Media Player/MPC 播放受保護的 dvr-ms 時當掉或顯示 GPF  
   - 解法：依 KB891664 清除/重建 DRM 授權與金鑰，重新個別化後恢復播放

3. 技術依賴：  
   - MCE 錄影播放管線依賴 Windows Media Player 及其 DRM 子系統  
   - 受保護的 dvr-ms 內容播放必須通過 DRM 驗證（依賴 Indiv01.key）  
   - 硬體指紋生成依賴系統硬體資訊（含 CPU 核心數），作為 DRM 金鑰生成來源

4. 應用場景：  
   - 升級 CPU（雙核換四核）或其他重大硬體變更後，播放受 DRM 保護內容失敗  
   - MCE 或 Media Player 播放既有錄影檔（dvr-ms）時突然報錯或崩潰  
   - 排除「編解碼器問題」後，定位到 DRM/授權相關的疑難排解

### 學習路徑建議
1. 入門者路徑：  
   - 認識 MCE 錄影檔格式與 DRM 基本概念  
   - 學會查看錯誤對話框與關鍵模組名稱（如 Indiv01.key）  
   - 了解微軟 KB891664 的重點與何時需要重建 DRM 授權

2. 進階者路徑：  
   - 熟悉 MCE 與 Windows Media Player 的關聯以及 DRM 在播放流程中的位置  
   - 建立系統化的故障排除流程：先排除編解碼器與播放器問題，再檢查 DRM/授權  
   - 變更硬體前的風險控管：備份、記錄授權來源、規劃停機時間與回復步驟

3. 實戰路徑：  
   - 硬體升級前後驗證：升級前測試播放，升級後若失敗即按照 KB 流程重建授權  
   - 針對 dvr-ms 或受保護內容的批量驗證測試，確保存取權限與播放功能恢復  
   - 建立變更後檢查清單（播放器、MCE、所有受保護媒體）與回報流程

### 關鍵要點清單
- Windows Media DRM 與硬體綁定：DRM 會以硬體組態產生機器專屬金鑰，硬體變更可能失效 (優先級: 高)
- Indiv01.key 角色：此檔為 DRM 個別化金鑰，損毀或與現有硬體不符會導致播放失敗 (優先級: 高)
- CPU 核心數影響：從雙核換到四核會改變硬體指紋，DRM 可能視為不同機器 (優先級: 高)
- 症狀辨識：MCE/Media Player 播放 dvr-ms 當掉或顯示 General Protection Fault (優先級: 高)
- 非編解碼器問題：同一檔在多播放器皆失敗，暗示 DRM/授權而非 codec 問題 (優先級: 高)
- KB891664 指引：依知識庫操作清除與重建 DRM 授權可恢復播放 (優先級: 高)
- 授權重建影響：清除 DRM 後需重新個別化與授權，可能需重新取得播放權 (優先級: 中)
- 故障定位策略：先查錯誤模組名稱（如 Indiv01.key）再決定排除路徑 (優先級: 中)
- 多播放器一致性測試：在 WMP/MPC/MCE 皆測試可快速確認是否為系統層問題 (優先級: 中)
- 升級前規劃：重大硬體變更前需有備援與還原計畫，預留除錯時間 (優先級: 中)
- 使用者溝通：錯誤訊息常不明確，需主動查 KB 與社群經驗 (優先級: 中)
- dvr-ms 特性：MCE 錄影檔可能受 DRM 保護，受授權機制嚴格限制 (優先級: 中)
- 重開機必要性：重建 DRM/個別化過程後通常需重開機以套用 (優先級: 低)
- 四核心本身無礙：硬體升級非根因，DRM 綁定策略才是主因 (優先級: 中)
- 維運心態：更換硬體要有耐心與完整排錯計畫，避免不必要的重灌 (優先級: 低)