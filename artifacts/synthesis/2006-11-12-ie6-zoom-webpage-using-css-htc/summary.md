# IE6 縮放網頁: using css + htc

## 摘要提示
- 目的: 在不安裝 IE7/Firefox、也不改動目標網頁 HTML 的前提下，為 IE6 加上網頁縮放功能
- 技術組合: 透過 CSS 的 behavior 與 HTC (HTML Component) 客端元件實作縮放
- HTC 概念: 類似 ASP.NET Server Control 的概念但在用戶端執行，能為既有 HTML 元素注入行為
- 套用範圍: 使用 IE 的使用者自訂樣式表功能，將行為散佈到所有開啟的網頁
- 操作步驟: 下載三檔 zoom.htc/zoom.css/zoom.html，於 IE 設定自訂樣式表指向 zoom.css
- 互動方式: 按住 ALT 並點擊滑鼠左鍵呼叫選單，選擇百分比即可調整頁面縮放
- 效果驗證: 本機測試頁可正常顯示縮放選單並生效
- 關鍵限制: 不同安全區域與網域的 Cross talk 被 IE 安全機制阻擋，導致在如 Google 首頁失效
- 問題根源: 本機 c:\zoom.htc 與 http(s) 站點屬於不同 Security Zone，行為被 IE 封鎖
- 後續展望: 若能解決安全區隔問題，該技巧可擴充至如全站停用右鍵選單等場景

## 全文重點
作者嘗試在 IE6 上以不更動目標網站 HTML、也不升級瀏覽器的方式，加入「縮放網頁」能力。靈感來自友站分享的做法，但其需在頁面嵌入程式碼，限制了對第三方網站的適用性。作者轉向利用 IE 自訂樣式表與 HTC (HTML Component) 技術：透過 CSS 的 behavior 屬性，將 HTC 所定義的行為附加到任意頁面元素，達到「以用戶端行為全站注入功能」的效果。此模式概念上近似 ASP.NET Server Control，但 HTC 完全在客端執行，適合不改動伺服端與頁面原始碼的情境。

實作上，作者提供三個檔案：zoom.htc、zoom.css、zoom.html。使用者在 IE 的存取設定中指定自訂樣式表為 c:\zoom.css，開啟測試頁 c:\zoom.html 後，按住 ALT 並以滑鼠左鍵點擊，即可彈出選單選擇縮放百分比，成功控制頁面縮放。此顯示了 HTC 綁定至 HTML 元素並透過 CSS 全域套用的可行性，且用戶端完全無須修改原始 HTML，即能得到類似 IE7/Firefox 的縮放體驗。

然而，當將相同方法用於 Google 首頁等網頁時，IE 的安全模型出面干預：本機路徑 c:\zoom.htc 與網路站點 http://www.google.com.tw 屬於不同的 Security Zone 與不同網域，IE 對跨區、跨域的「行為注入」（cross talk）予以阻擋，導致 HTC 無法載入或執行，縮放介面無法出現。這說明了以本機 HTC 檔搭配全域 CSS 行為來「跨站增能」的策略，會被 IE 的防護機制所限制。作者表示若非此安全限制，方案已相當完備；目前仍未找到簡單繞過方式，並徵詢讀者建議。作者也提到 HTC 能輕鬆實作如全站停用右鍵等功能，顯示該技術在 IE 環境下的擴充潛力，但同樣需面對安全區隔的現實。

總結來看，這篇文章展示了在 IE6 時代以 CSS behavior + HTC 注入用戶端行為、為任意頁面提供縮放功能的創意路徑，並清楚點出成功條件（同區同域或本機頁面）與失敗主因（Security Zone 的隔離）。它既是技術實驗報告，也提醒在舊版 IE 平台上進行用戶端增能時，必須同時考量安全模型與部署環境的限制。

## 段落重點
### 動機與現有限制
作者先引用友站分享的縮放方案，指出其優點是無需升級到 IE7/Firefox 就能縮放，但缺點在於需在每個頁面插入 HTML 程式碼，對非自家網站不可行。因此作者希望找到一種「不改動任何被瀏覽頁面」的縮放解法，能普遍套用到所有網站。此前也曾以 CSS 寫死比例達成縮放，但缺乏動態調整；本文欲進一步結合 HTC 與 CSS，在使用者端動態控制縮放，並由自訂樣式表將功能散佈至所有網站。

### HTC 技術簡介與與 Server Control 類比
HTC（HTML Component）自 IE5.0 起提供，讓開發者能以客端元件形式擴充 HTML 標籤行為。它的理念有點像 ASP.NET 的 Server Control：都能為標記附加行為與邏輯，但執行位置與技術截然不同——HTC 完全在客端瀏覽器中運作。HTC 一般透過 CSS 的 behavior 屬性與 HTML 元素綁定，因此非常適合用「樣式表」的方式將行為套用到整站或多站頁面，不需觸碰伺服端程式與原始 HTML。

### 以使用者自訂樣式表散佈行為
核心原理是利用 IE 的使用者自訂 CSS 功能：使用者可在瀏覽器中指定一個 CSS 檔，讓它自動套用至所有開啟的頁面。藉由在該 CSS 中加入 behavior 指向 HTC，即可將自訂行為廣播到各網頁元素，達成「跨站增能」。作者也提到 HTC 在這種情境下的擅長點，並預告可用於全站停用右鍵等案例，展現其彈性與威力。

### 實作步驟與操作方式
作者提供三個檔案（zoom.htc、zoom.css、zoom.html），並說明設定步驟：在 IE 中設定自訂樣式表為 c:\zoom.css；接著開啟 c:\zoom.html 作為測試頁。操作上，按住 ALT 並點擊滑鼠左鍵，畫面會跳出選單，可直接選擇縮放百分比，改變頁面顯示大小。此流程證明在本機測試環境中，HTC 與 CSS 的組合能順利提供動態縮放介面與行為。

### 成功效果與初步評估
在本機測試頁上，HTML 並未直接引用自訂 CSS/HTC，但透過 IE 的全域樣式設定，縮放功能仍能出現并運作，顯示出方案的零侵入性與可用性。從使用者體驗角度，只需簡單的按鍵與點擊即可呼出選單調整比例，達成接近現代瀏覽器的縮放能力。若能跨站普遍適用，將對 IE6 使用者是一大提升。

### 安全區域衝突與失敗案例
當開啟 Google 首頁測試時，IE 彈出安全相關提示，縮放行為未能載入。根因在於 c:\zoom.htc 屬於本機檔案區域，而 google.com.tw 屬於網際網路安全區域，兩者的跨區、跨網域互動被 IE 的安全策略阻擋。IE 對 behavior 所指向的外部資源有區域限制，導致 HTC 無法在該頁執行。作者感嘆若非此安全機制，方案幾乎完美，但目前尚未找到簡單的解法。

### 結語與徵求解法
作者總結：CSS + HTC 能實現 IE6 的通用縮放，技術上可行且體驗良好，但部署上受限於 IE 的 Security Zone 與跨域防護。對於如何在不降低安全性的前提下跨區載入 HTC，作者尚無簡便方案，並向讀者徵求點子。即便如此，此方向仍展示了 HTC 在用戶端強化舊瀏覽器功能的潛力，未來若能突破安全區隔問題，可擴展到更多全域行為控制的應用。

## 資訊整理

### 知識架構圖
1. 前置知識：
- 基本 HTML/CSS 概念
- IE 瀏覽器（IE5/IE6）專屬技術與選單操作
- CSS behavior 屬性與 HTC（HTML Component）的概念
- IE 安全性區域（Security Zone）與跨區域限制的基本觀念

2. 核心概念：
- HTC（HTML Component）：IE5 起提供的用戶端可重用元件，透過 CSS behavior 綁定到 HTML 元素
- CSS behavior：在 CSS 中以行為方式將 HTC 套用到元素，實現擴充功能
- 使用者自訂樣式表（User Stylesheet）：IE 可對所有瀏覽頁面套用自訂 CSS，以「無須改動頁面原始碼」的方式注入行為
- 縮放機制實作：以 HTC + CSS 實作全站縮放 UI（例如 Alt+左鍵呼叫選單，選百分比調整放大率）
- 安全性限制：跨安全區域/網域（本機檔案 c:\ 與 http 網域）被 IE 安全模型阻擋，導致 HTC 無法在外站生效

3. 技術依賴：
- IE5/IE6 專屬技術：HTC 依賴 CSS behavior，僅適用 IE（早期版本支援較寬鬆）
- 使用者樣式表機制：IE 提供將自訂 CSS 全域套用至所有瀏覽頁面的能力
- 安全性區域模型：HTC 檔案位置與目標網頁所屬的安全性區域/網域需相容，否則行為受阻

4. 應用場景：
- 在不修改網站原始碼的情況下，為 IE 中瀏覽的所有頁面加上統一的功能（如縮放、停用右鍵選單）
- 內網或同網域環境中，集中佈署 HTC 以加值既有頁面
- 需要臨時強化舊站（IE-only）體驗與可用性的個人工具或測試

### 學習路徑建議
1. 入門者路徑：
- 了解 IE 的使用者樣式表設定方式與作用範圍
- 認識 CSS behavior 屬性、何謂 HTC，以及與一般 CSS/JS 的差異
- 跟著文中步驟放置 zoom.htc / zoom.css / zoom.html，測試本機頁面的縮放介面

2. 進階者路徑：
- 研讀 HTC 的生命週期、事件綁定與與元素互動方式
- 嘗試以 behavior 將自訂功能套用到特定選擇器，實作如停用右鍵等全站行為
- 了解 IE 安全性區域與跨區限制，辨識何時會被阻擋以及環境需求

3. 實戰路徑：
- 在可控的同網域或內網環境中，部署 HTC 與 CSS，實現全站縮放或其他 UI 行為
- 設計簡易觸發器（如 Alt+點擊）與選單 UI，驗證操作流程
- 建立測試案例：分別在本機檔案、同網域、不同網域測試行為是否生效，記錄受阻情況

### 關鍵要點清單
- HTC（HTML Component）：IE5 引入的用戶端元件，透過 CSS behavior 綁定到元素以擴充功能（優先級: 高）
- CSS behavior 屬性：讓 CSS 可指定外部 HTC 來賦予元素新行為，是本技術的關鍵連結（優先級: 高）
- 使用者樣式表（User Stylesheet）：IE 可全域套用自訂 CSS，讓功能無需改動目標頁面即可生效（優先級: 高）
- 縮放功能實作概念：以 HTC 提供 UI/邏輯，透過 CSS 分派到頁面元素，達成全站縮放（優先級: 高）
- 操作手勢（Alt+左鍵）：示範觸發縮放選單的互動方式，選擇百分比改變放大率（優先級: 中）
- 檔案配置與步驟：將 zoom.htc/css/html 放於本機，於 IE 指定 user CSS 後開啟測試頁（優先級: 中）
- 舊版 IE 支援差異：早期 IE 對行為注入較寬鬆，後續版本安全限制更嚴（優先級: 中）
- 安全性區域限制：本機 c:\ 與網域 http://... 屬不同 security zone，跨區交互被封鎖（優先級: 高）
- 同源/同區要求：HTC 與受控頁面需處於相容的區域/網域，否則行為無法套用（優先級: 高）
- 不需改動 HTML：藉由使用者 CSS + behavior，就能對外部頁面注入功能（優先級: 中）
- 典型應用：除縮放外，可用於全站停用右鍵等一致性行為注入（優先級: 中）
- 客戶端 vs 伺服端對比：HTC 為用戶端技術，與 ASP.NET server control 性質與實作層面不同（優先級: 低）
- 風險與限制：IE 專屬、相容性受限、受安全模型約束，無法普遍適用於所有網站（優先級: 高）
- 測試與診斷：以 Google 首頁為例顯示被阻擋的錯誤情境，驗證安全性影響（優先級: 中）
- 發佈與維運考量：若需實際推廣，應考慮部署位置、區域設定與瀏覽器版本差異（優先級: 中）