# 停機公告與服務遷移應對指南

## 問題與答案 (FAQ)

### Q&A 類別 A: 概念理解類

A-Q1: 什麼是停機公告？
- A簡: 停機公告是服務端預告計畫性中斷，說明時間、影響、原因與替代方案，讓使用者與依賴方可提前準備。
- A詳: 停機公告是服務提供者在預定維護或架構調整前，主動向用戶與依賴服務通知的說明。內容通常包含開始與結束時間、涉及服務範圍、可能影響、原因（如搬遷、升級）、建議動作（如備援與資料備份）、聯絡方式與更新管道。高品質公告也會提供風險說明、回復計畫與進度更新位置（例如狀態頁、社群）。其核心目標是將可預期風險降到最低並維護信任。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: A-Q2, A-Q8, A-Q19, C-Q9

A-Q2: 為什麼需要事先公告停機？
- A簡: 讓用戶與依賴服務可預先規劃備援、備份與切換，降低中斷衝擊並避免緊急事故與信任流失。
- A詳: 事先公告能讓受影響方安排替代方案，例如提前遷移 DNS 託管、降 TTL、備份資料、設定臨時鏡像或調整業務活動。對營運方而言，公告能降低同時接到大量支援請求與誤判事故的風險，並有助於爭取維護窗口內的安靜環境。充分告知與透明溝通可維持用戶信任，並為不可控變化預留緩衝，例如未知停機時長。最佳實務是至少提前 2 週公告，並在臨近時重申關鍵提醒。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: A-Q1, A-Q8, C-Q9

A-Q3: 什麼是服務託管（Hosting）？
- A簡: 將網站、應用、DNS 等服務放在第三方基礎設施上運行與維運的模式，含資源、網路與管理。
- A詳: 服務託管是指使用第三方提供的伺服器、網路、儲存與平台，來部署與運行你的應用或服務，典型包含網站託管、應用託管與 DNS 託管。優點是降低自建成本與維運門檻，取得可擴展資源與 SLA；風險包括供應商停機、單點依賴、遷移鎖定與成本不可控。理解託管邊界與責任（例如誰做備份、誰應對 DDoS）是韌性規劃的基礎。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: A-Q4, A-Q5, A-Q20, B-Q4

A-Q4: 什麼是 DNS 託管？
- A簡: 由專門提供者代管你的網域 DNS 區域檔與記錄，負責解析可用性、傳播與管理界面。
- A詳: DNS 託管即將你的網域區域檔（Zone）放在提供者的權威 DNS 伺服器上，由其負責對外回應解析查詢。常見管理項目包含 A/AAAA、CNAME、MX、TXT、NS 等記錄，並提供 TTL、健康檢查、路由策略與 API。優點是高可用、全球節點與便利管理；風險在於供應商停機、配置失誤或遷移成本。理解 DNS 託管能幫助你在停機前正確遷移與降低傳播延遲。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: A-Q5, A-Q13, B-Q1, C-Q1

A-Q5: DNS 託管與網站託管有何差異？
- A簡: DNS 託管管理解析與路由；網站託管提供應用執行與內容。兩者相互依賴但功能不同。
- A詳: DNS 託管管理你的網域名稱解析，回答來自遞迴解析器的查詢，決定最終指向哪個 IP 或主機名。網站託管則提供運行網站應用的伺服器、Runtime、儲存與網路，實際回應 HTTP/HTTPS 請求。DNS 屬於「尋址層」，網站託管是「應用層」。遷移時可分別演練：先降 TTL、同步內容、再切換 DNS 指向新主機或改 NS 伺服器。理解差異有助於規劃正確的切換步驟。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: A-Q4, A-Q13, B-Q18, C-Q2

A-Q6: 什麼是備援（Redundancy/Fallback）？
- A簡: 預先準備可替代的資源或路徑，在主系統不可用時快速接手，降低中斷風險。
- A詳: 備援指為關鍵元件（DNS、應用、資料、網路）準備備用資源與切換機制。形式包含多區域部署、雙供應商 DNS、主備資料庫、CDN 邊緣快取與離線備份。備援價值在於在主服務停機、升級或災害時，仍可維持服務可用與資料安全。設計備援需界定 RTO/RPO、切換條件（自動/手動）、健康檢查、資料一致性與回復流程。
- 難度: 初級
- 學習階段: 核心
- 關聯概念: A-Q10, A-Q11, A-Q17, B-Q12

A-Q7: 為何停機前要先找備援？
- A簡: 為縮短恢復時間與降低不確定期間的風險，確保關鍵服務可持續或快速切換。
- A詳: 當停機時長未知或窗口較長時，先備妥替代方案能避免完全中斷。例如將 DNS 遷至新提供者、準備臨時鏡像或只讀模式、透過 CDN 提供快取頁面、離線備份確保資料安全。這些動作可縮短 RTO、降低資料遺失風險（RPO）與使用者流失。最佳實務是在公告後立即盤點風險、制定切換計畫與演練，保證一旦主服務下線可立即接手。
- 難度: 初級
- 學習階段: 核心
- 關聯概念: A-Q6, A-Q10, C-Q1, C-Q2

A-Q8: 什麼是維護時窗（Maintenance Window）？
- A簡: 預計進行變更的時間區間，提前公告並控制影響，常選低峰時段降低用戶衝擊。
- A詳: 維護時窗是計畫性變更的指定時間段，包含開始與結束時間、凍結範圍與回復預案。通常選擇流量低峰，以降低影響。良好時窗管理包含變更評審、回滾計畫、溝通節點、值班安排與風險緩解，如降 TTL、預熱新環境、資料同步與備援切換。時窗內需控制新變更的引入，確保可觀測性與溝通暢通。
- 難度: 初級
- 學習階段: 核心
- 關聯概念: A-Q2, B-Q15, C-Q3, C-Q9

A-Q9: 計畫性與非計畫性停機有何差異？
- A簡: 計畫性可預告、可控並有回復預案；非計畫性突發、不可控，重在事故處理與復原。
- A詳: 計畫性停機源於升級、搬遷與維護，具可控性，能提前公告、降風險並安排備援。非計畫性停機多由故障、災害或攻擊引發，無法提前通知，需啟動事故應變、溝通與復原。兩者的目標相同：縮短不可用時間並保護資料，但手段不同。良好的計畫性停機管理也能降低非計畫性風險，因為提前演練了切換與回復。
- 難度: 初級
- 學習階段: 核心
- 關聯概念: A-Q1, A-Q8, D-Q1, D-Q10

A-Q10: 什麼是 RTO（復原時間目標）？
- A簡: 服務從中斷到恢復可用的可接受最長時間目標，用於設計備援與切換策略。
- A詳: RTO 定義中斷後可容忍的最長恢復時間，例如 DNS 切換 RTO 30 分鐘、網站恢復 RTO 2 小時。RTO 影響架構設計：若 RTO 很短，需投資高可用、熱備或自動故障轉移；RTO 寬鬆，則可用冷備與手動切換。設定 RTO 需參考商務影響、用戶預期與成本，並透過演練驗證可達成。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q11, A-Q12, A-Q6, B-Q12

A-Q11: 什麼是 RPO（復原點目標）？
- A簡: 可接受的資料遺失窗口長度目標，決定備份頻率與複寫策略的嚴格程度。
- A詳: RPO 定義發生事件後可接受的最大資料遺失量，常以時間衡量，例如 RPO 15 分鐘表示最多可丟失 15 分鐘內的寫入。RPO 越嚴苛，越需要同步複寫或高頻快照；較寬鬆的 RPO 可用每日備份。RPO 與 RTO相輔相成，指導備援架構、資料保護機制與演練頻率。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q10, A-Q12, B-Q11, C-Q4

A-Q12: RTO 與 RPO 有何差異與關係？
- A簡: RTO管恢復時間，RPO管資料遺失容忍，兩者共同決定備援策略與成本投入。
- A詳: RTO 聚焦「多久恢復可用」，RPO 聚焦「能損失多少資料」。若 RTO 短、RPO 小，必須高強度投資熱備、同步複寫與自動化切換；若 RTO 長、RPO 大，成本可低但風險增加。制定兩者需要跨部門協作，並以業務目標、用戶影響與預算為依據，最後用演練驗證。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q10, A-Q11, B-Q11, B-Q12

A-Q13: 什麼是 DNS TTL？
- A簡: TTL 是記錄的快取存活時間，決定解析結果在快取中保留多久，影響變更生效速度。
- A詳: TTL（Time To Live）指定 DNS 記錄在遞迴解析器的快取有效時間。TTL 越長，查詢更省資源，但變更生效更慢；TTL 越短，查詢負載較高，但可快速切換。遷移前常在數天前調降 TTL，以縮短傳播延遲。不同記錄可設定不同 TTL，並受上游快取與最小 TTL 限制。
- 難度: 初級
- 學習階段: 核心
- 關聯概念: A-Q14, B-Q2, C-Q3, D-Q1

A-Q14: 為何遷移前要調低 TTL？
- A簡: 降低 TTL 可減少舊快取存留時間，讓 DNS 變更更快生效，縮短切換期間不一致。
- A詳: 在切換前 48–72 小時將關鍵記錄 TTL 調到較低值（如 60–300 秒），可確保切換當下，大多數遞迴解析器會更快更新結果。這能縮短用戶命中舊主機的時間，也降低雙寫或資料不一致風險。需注意某些 DNS 供應商或 ISP 有最小 TTL 或忽略設定的情況，需事前抽樣驗證。
- 難度: 初級
- 學習階段: 核心
- 關聯概念: A-Q13, B-Q2, C-Q3, D-Q6

A-Q15: 名稱伺服器（NS）與 A 記錄差異是什麼？
- A簡: 改 NS 代表換 DNS 託管；改 A 記錄是改目標 IP。前者影響整個區域，後者僅影響單點。
- A詳: NS 記錄定義哪幾台權威 DNS 伺服器負責你的網域。更改 NS 等同遷移 DNS 託管，涉及整個 Zone、SOA 與所有記錄；改 A 記錄只改某個主機名指向的 IP。遷移路徑可先低風險改 A 指向新主機，再於適當時機切 NS；或先同步 Zone，驗證後改 NS。兩者影響範圍、風險與回滾策略不同。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q4, B-Q18, C-Q1, C-Q2

A-Q16: 什麼是 DNS 傳播？
- A簡: 記錄變更在全球遞迴解析器快取中逐步更新的過程，受 TTL、ISP 快取策略影響。
- A詳: 傳播並非主從複寫，而是各地遞迴解析器在快取到期或重新查詢後，取得新版權威答案的過程。時間由 TTL、遞迴解析器策略、最小 TTL 限制與負面快取（NXDOMAIN）決定。觀察傳播可用多地探測與抽樣測試，並預留回滾窗口。注意某些客戶端可能本地快取更久，需提供清快取指引。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q13, B-Q2, C-Q8, D-Q1

A-Q17: 高可用（HA）與災難復原（DR）差異？
- A簡: HA 專注不中斷與自動轉移；DR 著重災後恢復與資料保護。目標與投入層級不同。
- A詳: 高可用透過冗餘、健康檢查與自動故障轉移，盡量讓服務不間斷（RTO 近零）。災難復原則是在重大故障或地域災害後，於次要環境恢復運作，允許較長 RTO 與一定 RPO。兩者可互補：核心服務採 HA，整體平台有 DR 預案。選擇需依成本、風險承受度與業務關鍵性制定。
- 難度: 中級
- 學習階段: 進階
- 關聯概念: A-Q6, A-Q10, A-Q11, B-Q12

A-Q18: 什麼是異地備份（Off-site Backup）？
- A簡: 將備份存放在不同地理或供應商環境，避免同域災害或單點故障造成備份同毀。
- A詳: 異地備份將資料複本存於遠端或不同供應商，搭配加密與版本保留，確保在原地或原供應商停機時仍可恢復。常見策略包含 3-2-1 原則：3 份副本、2 種媒體、1 份異地。需定期做還原測試，驗證可用與完整性，並管理金鑰與存取權限。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q11, C-Q4, D-Q7, B-Q21

A-Q19: 什麼是狀態頁與溝通管道？
- A簡: 用於即時公告維護進度與事故狀態的對外渠道，如狀態頁、郵件、RSS 或社群。
- A詳: 狀態頁集中展示服務可用性、歷史事件與即時更新，是維護期間透明溝通的核心。配合郵件、RSS、訊息群組或社群公告，可擴大觸達。良好做法包含預告、開始提醒、進度節點、完成與回顧（Postmortem）連結。多渠道可降低單點依賴，並方便訂閱。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: A-Q1, A-Q2, B-Q14, C-Q9

A-Q20: 冗餘的核心價值是什麼？
- A簡: 降低單點故障風險，縮短恢復時間與資料遺失，提升服務可靠性與使用者信任。
- A詳: 冗餘透過多實例、多區、多供應商與多路徑設計，避免任一元件失效導致全域中斷。它直接改善 RTO/RPO，並為計畫性停機提供平滑切換能力。冗餘不是無上限堆疊，需結合可觀測性、演練與成本權衡，達到風險可接受與經濟可行的平衡。
- 難度: 初級
- 學習階段: 核心
- 關聯概念: A-Q6, A-Q17, B-Q12, C-Q10


### Q&A 類別 B: 技術原理類

B-Q1: DNS 解析如何運作？
- A簡: 用戶端向遞迴解析器查詢，遞迴器自根節點逐層尋址至權威伺服器取得最終答案。
- A詳: 解析流程從客戶端向本地遞迴解析器發起。遞迴器若無快取，先問根伺服器獲得 TLD 指引，再問 TLD 取得網域的權威 NS，最後向權威伺服器查詢記錄（如 A）。回答帶 TTL，遞迴器快取後回覆客戶端。核心組件：根/TLD/權威伺服器、遞迴解析器、快取。關鍵步驟：逐層查詢、驗證與回傳。此機制確保可擴展與分散。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: A-Q4, A-Q13, B-Q2, C-Q8

B-Q2: DNS 記錄變更如何傳播？
- A簡: 變更先更新權威伺服器；遞迴解析器於 TTL 到期或重新查詢時取得新答案，逐步生效。
- A詳: 傳播不是推播，而是依快取策略拉取。你更新權威 Zone 後，現有快取仍用舊值直到 TTL 到期。到期後遞迴器重查，獲得新答案與新 TTL。負面快取（不存在記錄）也有 TTL。核心步驟：更新 Zone、驗證 SOA 序號、觀察多地遞迴行為。組件：權威 DNS、遞迴解析器、客戶端與監測節點。調低 TTL 是加速關鍵。
- 難度: 初級
- 學習階段: 核心
- 關聯概念: A-Q13, A-Q16, C-Q3, C-Q8

B-Q3: 一次性切換與藍綠部署如何運作？
- A簡: 一次性切換在時窗內停機轉換；藍綠保留兩套環境，流量在新舊間切換以降低風險。
- A詳: 一次性切換（Big Bang）在停機時窗內完成資料遷移與配置，切換 DNS 或路由；藍綠部署維持 Blue/Green 兩套相同環境，先預熱新環境、同步資料，流量在兩者間逐步切換。流程：建綠環境→資料同步→健康檢查→流量切換→觀察→下線舊環境。組件：負載均衡、DNS、資料庫複寫、健康探測。藍綠更安全但成本高。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q6, A-Q8, C-Q2, D-Q10

B-Q4: 部落格服務典型架構是什麼？
- A簡: Web 應用 + 資料庫 + 檔案儲存（媒體）+ DNS/CDN，常見單機到多層擴展。
- A詳: 傳統部落格包含 Web 應用（PHP/Node 等）、關聯式資料庫（MySQL/Postgres）、媒體檔案儲存（本機或物件儲存）、反向代理（Nginx）、DNS 與選擇性 CDN。關鍵步驟：資料備份、媒體同步、設定檔移植、域名切換。核心組件：應用程式、DB、儲存、DNS、TLS 憑證。理解組成有助規劃遷移與最小停機。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: C-Q2, C-Q6, D-Q4, D-Q9

B-Q5: 如何在遷移中維持近零停機？
- A簡: 透過資料複寫、只讀模式、雙寫或併發運行，加上低 TTL 與漸進切流。
- A詳: 近零停機需讓新舊環境並行，資料透過同步複寫或變更資料擷取（CDC）。切換窗口暫時只讀，或短暫雙寫並做一致性檢查。DNS/負載均衡以健康檢查漸進切流。關鍵步驟：預熱新環境→降 TTL→資料同步→健康檢查→短暫凍結→切換→驗證→回退預案。核心組件：複寫、健康檢查、觀測、回滾。
- 難度: 高級
- 學習階段: 進階
- 關聯概念: A-Q10, A-Q11, B-Q11, C-Q2

B-Q6: DNS 快取與最小 TTL 機制是什麼？
- A簡: 遞迴器依 TTL 快取，但部分 ISP 實作有最小 TTL 或忽略低 TTL，影響生效速度。
- A詳: 遞迴解析器按權威回覆的 TTL 快取答案；部分軟體或 ISP 實作有最小 TTL（例如不低於 60s/300s），或對負面快取保留較長，導致變更延遲。瀏覽器與作業系統也有本地快取。步驟：事前抽樣測試→記錄差異→為慢更新預留緩衝。核心組件：權威 DNS、遞迴解析器、本地快取層。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q13, A-Q16, D-Q1, D-Q6

B-Q7: 301 與 302 轉址差異與原理？
- A簡: 301 為永久轉址會被快取與搜尋引擎採納；302 為暫時轉址較少被長期記憶。
- A詳: HTTP 301 表示資源永久移動，瀏覽器與爬蟲可長期快取並更新索引；302 表示暫時移動，不應更新索引。遷移時若新網址永久生效，應用 301；若為維護暫時引導，選 302 或 307。流程：伺服器判斷→回應狀態碼與 Location。核心組件：Web 伺服器、路由規則、快取策略。
- 難度: 初級
- 學習階段: 核心
- 關聯概念: C-Q5, D-Q9, B-Q8

B-Q8: CDN 與 DNS 的互動原理？
- A簡: DNS 將流量導向 CDN 節點；CDN 以邊緣快取與回源策略提供內容、降低延遲。
- A詳: 典型做法是 CNAME 到 CDN 域名，由 CDN 根據使用者地理與健康狀態選節點提供內容。未快取的資源回源至你的主機。核心步驟：DNS 指向 CDN→CDN 邊緣路由→快取命中或回源→回應用戶。組件：權威 DNS、CDN 邊緣、原始伺服器、健康檢查。維護時可用 CDN 快取與維護頁降低衝擊。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q5, C-Q5, D-Q8, B-Q12

B-Q9: 備份類型如何運作（完整/增量/差異）？
- A簡: 完整備份全量；增量只備前次備份後更動；差異備份自上次完整後更動。
- A詳: 完整備份最簡單、恢復快但佔空間；增量備份每日量小，但恢復需串接多份；差異介於兩者，恢復需完整+最新差異。流程：排程→執行→校驗→上傳異地→保留版本→還原測試。核心組件：備份代理、儲存（本地/物件）、索引與驗證。依 RPO/RTO 選用混合策略。
- 難度: 初級
- 學習階段: 核心
- 關聯概念: A-Q11, C-Q4, B-Q21, D-Q7

B-Q10: 儲存快照的機制是什麼？
- A簡: 快照以寫時複製記錄變更，快速建立時間點副本，適合快速還原與短停機保護。
- A詳: 快照常採 Copy-on-Write 或 Redirect-on-Write，初次建立僅標記，後續變更才寫入差異區，故能快速產生時間點副本。適用於資料庫一致性快照（搭配凍結）與檔案系統保護。步驟：一致性處理→建立快照→保留與複製異地→測試還原。核心組件：檔案系統/儲存、快照管理、還原工具。
- 難度: 中級
- 學習階段: 進階
- 關聯概念: A-Q11, C-Q4, D-Q7, B-Q11

B-Q11: 複寫（同步/非同步）原理？
- A簡: 同步複寫寫入需同時提交至副本；非同步先主後從，延遲小但可能丟資料。
- A詳: 同步複寫確保主從一致性，RPO≈0，但延遲與成本高；非同步以日誌或變更串流傳送，效能佳但有延遲窗口。流程：主節點接收寫入→傳送變更→從節點套用→回報。核心組件：WAL/Binlog、複寫通道、仲裁。選擇依 RPO/RTO 與延遲敏感度取捨。
- 難度: 中級
- 學習階段: 進階
- 關聯概念: A-Q11, A-Q12, B-Q5, D-Q7

B-Q12: 健康檢查與自動故障轉移機制？
- A簡: 透過探測與閾值判定節點狀態，自動移轉流量至健康節點，縮短中斷。
- A詳: 健康檢查可分 L4（TCP）與 L7（HTTP/HTTPS）；探測失敗達閾值時標記不健康。自動故障轉移結合 DNS（加權/故障轉移）、負載均衡或路由協定將流量導向備援。流程：定期探測→狀態計分→觸發切換→觀測回復。核心組件：探測器、控制器、路由/DNS、告警。需防止震盪與誤判。
- 難度: 高級
- 學習階段: 進階
- 關聯概念: A-Q6, A-Q17, C-Q7, C-Q10

B-Q13: Anycast DNS 的工作原理？
- A簡: 多地使用相同 IP，由路由選最近節點回應，提升性能與抗攻擊能力。
- A詳: Anycast 讓多個地理節點宣告相同 IP，由 BGP 將用戶導向最近或最佳路徑節點。對 DNS 權威伺服器特別有利，提供低延遲與 DDoS 抗性。流程：多點部署→BGP 宣告→健康檢查調整宣告→使用者就近解析。核心組件：BGP、邊緣節點、健康檢查。管理成本高但可靠性優越。
- 難度: 高級
- 學習階段: 進階
- 關聯概念: B-Q12, A-Q20, C-Q1

B-Q14: 停機溝通計畫的技術架構？
- A簡: 建立多渠道發布與自動化更新，含狀態頁、訂閱、Webhooks 與備援託管。
- A詳: 架構包括：對外狀態頁（多地備援託管）、郵件/RSS/訊息群組訂閱、自動化更新管線（CI/CD 或腳本）、事件追蹤（工單/事件系統）。步驟：定義訊息模板→設定更新頻率與門檻→演練發佈→監測觸達率。核心組件：靜態託管/CDN、通知服務、事件管理、監測。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q19, C-Q9, D-Q2

B-Q15: 如何估算停機時長？
- A簡: 以工作分解、歷史數據與演練結果估算，並加入緩衝與回滾時間。
- A詳: 將任務拆解（備份、同步、切換、驗證、回滾），估列各步工時與風險，參考歷史與演練數據，加入緩衝係數（常見 1.5–2 倍）。考慮外部因素如 DNS 傳播、資料量、網路帶寬與人員協同。提供最佳/最壞情境與里程碑，便於對外溝通與內部協調。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q8, C-Q2, C-Q3, D-Q10

B-Q16: 設定版本控管與變更流程原理？
- A簡: 以版本庫管理基礎設施與配置，透過審核、測試與分階段發布降低風險。
- A詳: 基礎設施即程式（IaC）與配置即程式（CaC）將環境定義納入版本控管，經 PR 審核、靜態檢查、測試環境驗證，再逐步推向生產。核心步驟：變更提案→審核→試運行→灰度/藍綠→監控→收斂。組件：VCS、CI/CD、測試平台與觀測。可追溯與快速回滾是關鍵。
- 難度: 中級
- 學習階段: 進階
- 關聯概念: C-Q2, C-Q5, D-Q10

B-Q17: 資料庫遷移與綱要凍結機制？
- A簡: 切換前暫停綱要變更並控制寫入，配合複寫或快照確保一致性。
- A詳: 綱要凍結在遷移窗口停止 DDL 變更，避免版本漂移。資料一致性可用複寫、邏輯匯出/匯入或一致性快照。流程：宣佈凍結→清查差異→建立複寫/導出→驗證校驗和→切換→解除凍結。組件：DB 主從、匯出工具、校驗工具。能降低資料不一致與回滾複雜度。
- 難度: 中級
- 學習階段: 進階
- 關聯概念: B-Q11, C-Q6, D-Q4, D-Q7

B-Q18: 變更 NS 與改 A 記錄的機制差異？
- A簡: 改 NS 重設權威來源需註冊商更新；改 A 只改指向，風險較小、傳播較快。
- A詳: 改 NS 需在註冊商層更新，影響整個 Zone，依 TLD 託管與註冊商同步機制有不同延遲；改 A 在現有權威 DNS 內修改單一記錄，受 TTL 影響。切換策略常先改 A 驗證新主機，再改 NS 完成 DNS 遷移。需備妥舊新 Zone 同步與回滾方案。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q15, C-Q1, C-Q8, D-Q1

B-Q19: MX 記錄與郵件遷移原理？
- A簡: MX 決定郵件投遞目標，含優先級。變更受 TTL 與發信端重試策略影響。
- A詳: 郵件伺服器根據 MX 記錄選擇目標，優先級數值越小優先級越高。變更 MX 前應降 TTL 並確保新伺服器可接收與轉發。部分發信端會在失敗後重試，導致過渡期雙投遞。流程：降 TTL→配置新伺服器→同步帳號與規則→改 MX→監控退信。核心組件：權威 DNS、SMTP、反垃圾設定。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: C-Q1, D-Q5, A-Q13

B-Q20: 可用性量測與 SLA 計算原理？
- A簡: 以總時間與故障時長計算可用率，結合目標與誤差界定服務等級與賠償。
- A詳: SLA 常以月度可用率定義，如 99.9% 容許約 43 分鐘/月不可用。量測需多點探測與嚴謹定義（何謂不可用、排除計畫性維護與不可抗力）。流程：設計探測→蒐集指標→計算可用率→對照 SLA→提供報告。核心組件：探測平台、日誌、指標儲存與報表。
- 難度: 中級
- 學習階段: 進階
- 關聯概念: A-Q9, B-Q12, C-Q7


### Q&A 類別 C: 實作應用類（10題）

C-Q1: 如何把 DNS 託管遷移到新供應商？
- A簡: 先匯出並同步 Zone，降低 TTL，於低峰改 NS，驗證後監控，保留回滾方案。
- A詳: 具體步驟：
  - 盤點現有記錄與 TTL，匯出 Zone；在新供應商建立等價 Zone。
  - 降關鍵記錄 TTL 至 60–300 秒，至少提前 48 小時。
  - 多地用 dig 驗證新權威回覆一致性。
  - 於註冊商改 NS 指向新供應商，保留舊 Zone 一段時間。
  - 監控傳播、查錯與日誌；若異常，回滾至舊 NS。
  注意：保持 SOA 序號遞增、避免遺漏 MX/TXT、規劃回滾與公告進度。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q4, A-Q15, B-Q18, C-Q8

C-Q2: 如何以最少停機搬遷部落格網站？
- A簡: 新環境預熱，資料複寫與媒體同步，短暫只讀後切 DNS，通過健康檢查再放量。
- A詳: 具體步驟：
  - 建置新環境（Web/DB/儲存/TLS），導入設定並預熱快取。
  - 啟用 DB 複寫或定時匯出，媒體檔同步（rsync/物件儲存）。
  - 降 TTL；切換窗口短暫只讀或停寫，做最終同步。
  - 切 DNS 或調整負載均衡權重，監控錯誤與延遲。
  - 驗證功能（登入、發文、上傳），逐步增量放流量。
  最佳實務：版本控管、演練回滾、維持舊站可快速恢復。
- 難度: 高級
- 學習階段: 進階
- 關聯概念: B-Q4, B-Q5, B-Q11, D-Q4

C-Q3: 如何調降 TTL 並安排切換？
- A簡: 遷移前 48–72 小時將關鍵記錄 TTL 調低，於低峰執行切換並保留回滾窗口。
- A詳: 具體步驟：
  - 找出 A/AAAA、CNAME、MX 等關鍵記錄，TTL 改為 60–300s。
  - 確認供應商最小 TTL 限制，抽樣驗證生效。
  - 排定切換時窗，確認人員與溝通節點就位。
  - 切換時更新記錄或調整 NS，並即時監測。
  - 保持舊環境在線一段時間以便回滾。
  注意：考慮負面快取、瀏覽器/OS 快取，提供清快取指引。
- 難度: 初級
- 學習階段: 核心
- 關聯概念: A-Q13, A-Q14, B-Q2, D-Q6

C-Q4: 如何建立與驗證完整/增量備份？
- A簡: 設排程執行備份、校驗雜湊，異地儲存並定期做還原演練驗證可用性。
- A詳: 具體步驟：
  - 制定策略：每週完整、每日增量；設定保留與加密。
  - 執行備份（DB 匯出、檔案打包），生成校驗碼（SHA256）。
  - 上傳異地（不同供應商/區域），記錄版本與清單。
  - 每月至少一次抽測還原，核對校驗碼與應用可用性。
  注意：保護金鑰、限制存取、監控失敗告警、測試災難還原時間。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: B-Q9, B-Q10, A-Q18, D-Q7

C-Q5: 如何部署維護頁與 503 Retry-After？
- A簡: 以反向代理或 CDN 配置維護頁，回應 503 並加上 Retry-After，保留健康探針例外。
- A詳: 具體步驟：
  - 準備靜態維護頁，說明時窗與狀態頁連結。
  - 在反向代理設定維護模式，非健康探針路徑回 503。
  - 加入標頭：Retry-After: <秒數或日期>，避免 SEO 懲罰。
  - CDN 緩存維護頁，減少原伺服器壓力。
  注意：排除 API/健康探針，切回時清快取；避免 200 假成功。
- 難度: 初級
- 學習階段: 核心
- 關聯概念: B-Q7, B-Q8, B-Q14, D-Q9

C-Q6: 如何導出與導入部落格資料庫？
- A簡: 在低峰凍結寫入，使用匯出工具產生一致性備份，於新環境導入並校驗。
- A詳: 具體步驟：
  - 宣告短暫只讀，確認無長交易。
  - 匯出 DB（如 mysqldump/pg_dump，含結構與資料），同時匯出媒體路徑。
  - 在新資料庫建立對應用戶與權限，導入備份。
  - 跑完整性檢查與應用健康測試（登入、查詢）。
  注意：時區/排序規則、連線字元集、外鍵與觸發器一致；保護備份檔案安全。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: B-Q4, B-Q17, D-Q4, D-Q7

C-Q7: 如何建立基礎監控與警報？
- A簡: 監控可用性、延遲、錯誤率與資源，用多地探測與告警門檻，維護期加強監看。
- A詳: 具體步驟：
  - 建立多地 HTTP/TCP 探測，監看 2xx/3xx 比例、p95 延遲。
  - 系統層收集 CPU、記憶體、磁碟、連線數與網路。
  - 設定告警：不可用、延遲異常、錯誤率爆升、磁碟將滿。
  - 維護前提升告警敏感度與值班制度。
  注意：避免告警風暴，使用抑制與關聯規則；確保通知路徑備援。
- 難度: 初級
- 學習階段: 核心
- 關聯概念: B-Q12, B-Q20, D-Q8

C-Q8: 如何用多地驗證 DNS 變更？
- A簡: 使用多個公用 DNS 與地點查詢 A/MX/NS，觀察新舊結果占比與 TTL，判斷傳播。
- A詳: 具體步驟：
  - 選擇多家 DNS 伺服器（8.8.8.8、1.1.1.1、ISP 本地）與多地探測。
  - 查詢關鍵記錄並記錄回應、TTL 與權威來源。
  - 定時抽樣，畫出新舊結果佔比曲線，達 95% 後再進一步操作。
  注意：某些 ISP 有持久快取；不同記錄分開觀察；留意負面快取與 CNAME 鏈結。
- 難度: 初級
- 學習階段: 核心
- 關聯概念: A-Q16, B-Q2, B-Q18, D-Q1

C-Q9: 如何規劃並發佈停機溝通訊息？
- A簡: 提前 2 週預告，含原因/影響/時窗/行動建議；提供狀態頁連結與更新節點。
- A詳: 具體步驟：
  - 編寫模板：時間、影響服務、原因、建議動作（備份、遷移、降 TTL）、聯絡方式。
  - 多渠道發布：網站公告、狀態頁、郵件、RSS/社群。
  - 臨近再提醒；維護中定時更新；完成後發佈總結與後續事項。
  注意：避免模糊時間、提供回滾與最壞情境說明；照顧關鍵依賴者（DNS/郵件託管）。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: A-Q1, A-Q2, A-Q19, B-Q14

C-Q10: 如何啟用唯讀模式或暫時鏡像？
- A簡: 在切換期間將寫入停用或導向次要節點，提供瀏覽能力並避免資料分叉。
- A詳: 具體步驟：
  - 應用層關閉寫入功能（發文/註冊），顯示維護提示。
  - DB 設為只讀或限制寫入帳號；將靜態內容上傳至鏡像或 CDN。
  - 將讀流量導向鏡像站，驗證關鍵頁面可用。
  注意：明確告知唯讀狀態，防止繞過 API 寫入；切回時同步差異或解除只讀。
- 難度: 中級
- 學習階段: 進階
- 關聯概念: B-Q5, B-Q12, D-Q7


### Q&A 類別 D: 問題解決類（10題）

D-Q1: 切換後 DNS 傳播很慢怎麼辦？
- A簡: 檢查 TTL、觀察多地解析、確認最小 TTL 與 NS 生效；必要時延長雙運行與回滾。
- A詳: 症狀：部分地區仍解析到舊 IP。可能原因：TTL 過長、ISP 最小 TTL、負面快取、NS 變更延遲。解法：確認記錄與 SOA；用多地探測評估比例；延長雙環境並保持舊站可用；聯繫 ISP 或降低負載以等待更新。預防：提前 48–72 小時降 TTL、抽樣驗證。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q13, A-Q16, B-Q2, C-Q8

D-Q2: 接近停機時失去註冊商權限怎麼辦？
- A簡: 立即找回帳戶或更換聯絡人，若不可行，暫採改 A 記錄方案與延後 NS 切換。
- A詳: 症狀：無法改 NS 或更新網域設定。原因：帳戶遺失、2FA 問題、聯絡 Email 停用。解法：緊急聯繫註冊商驗證身份；恢復 2FA；若短期無法解決，先在現有權威 DNS 內改 A 記錄完成主機遷移，延後 NS 遷移。預防：多管理員、備援聯絡信箱、保存恢復碼與定期演練。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: B-Q18, C-Q1, C-Q9

D-Q3: 遷移後 SSL 憑證不匹配怎麼辦？
- A簡: 確認新主機域名覆蓋與私鑰匹配，修正 SNI 與鏈結，必要時重新簽發並清快取。
- A詳: 症狀：瀏覽器顯示證書錯誤或主機名不匹配。原因：證書未覆蓋新網域/SAN、私鑰不符、SNI 設定錯誤或缺少中繼鏈。解法：核對 CN/SAN、部署正確鏈結、同步私鑰對應、啟用 SNI；使用 ACME 重新簽發；清除 CDN/瀏覽器快取。預防：在切換前於新環境完成簽發與驗證自動續期。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: B-Q4, C-Q2, C-Q5

D-Q4: 部落格顯示資料庫連線錯誤怎麼辦？
- A簡: 檢查連線字串、帳號權限、網路 ACL 與資料庫狀態，核對時區/字元集後重啟連線池。
- A詳: 症狀：Error establishing a database connection。原因：連線參數錯、DNS 未更新、DB 未啟動、權限不足、網路未放行。解法：核對設定檔、測試連線（CLI）、檢查使用者權限與白名單、查看 DB 日誌；必要時回滾至舊環境提供服務。預防：切換前健康檢查、連線池暖身、綱要凍結與導入後驗證。
- 難度: 初級
- 學習階段: 核心
- 關聯概念: B-Q4, B-Q17, C-Q6

D-Q5: DNS 切換後郵件收不到怎麼辦？
- A簡: 驗證 MX/ SPF/ DKIM 設定與 TTL，檢查新伺服器收信與退信原因，觀察重試隊列。
- A詳: 症狀：新郵件未投遞或退信。原因：MX 指向錯誤、TTL 未到、反濫用設定缺失、收信端未開放。解法：檢查 MX 偏好與 A/AAAA 指向、降低 TTL、設定 SPF/DKIM/DMARC、查看收信伺服器日誌與佇列重試。預防：灰度切換（雙 MX）、提前配置與驗證、保留舊伺服器接收轉發。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: B-Q19, C-Q1, C-Q8

D-Q6: 使用者仍打到舊主機怎麼辦？
- A簡: 指導清除本地快取，維持舊站回應轉址，監控來源 IP，逐步收斂後下線。
- A詳: 症狀：部分用戶仍連舊 IP。原因：本地/ISP 快取、瀏覽器快取、硬性 hosts 設定。解法：提供清快取指引（OS、瀏覽器、DNS 客戶端）、在舊站回 301 到新域名或顯示維護頁，監控舊站流量來源與比例，達閾值後關閉。預防：提前降 TTL、公告清快取、避免硬編碼 IP。
- 難度: 初級
- 學習階段: 核心
- 關聯概念: A-Q14, B-Q6, C-Q3, B-Q7

D-Q7: 遷移期間資料不一致怎麼辦？
- A簡: 啟用只讀或雙寫校驗，最後切換前做最終同步與校驗和，必要時回放日誌。
- A詳: 症狀：部分內容缺失或重複。原因：切換窗口仍有寫入、複寫延遲、衝突未解。解法：暫時只讀或雙寫；切換前做最終快照與校驗和比對；如使用日誌回放，補齊遺漏交易。預防：明確寫入凍結、複寫監控延遲、使用 CDC 與衝突解決策略、演練還原。
- 難度: 高級
- 學習階段: 進階
- 關聯概念: B-Q5, B-Q11, C-Q10, C-Q6

D-Q8: 遷移後延遲變高怎麼辦？
- A簡: 檢查區域性路徑、DNS 導向、CDN 配置與資源壓縮；必要時調整區域部署與快取。
- A詳: 症狀：TTFB 或整體載入變慢。原因：新機房距離遠、CDN 未生效、DNS 導向不佳、壓縮與快取策略缺失。解法：觀測多地延遲、啟用/調整 CDN、Gzip/Brotli、HTTP/2、圖片壓縮、邊緣快取；調整 Anycast 或就近部署。預防：遷移前壓測與多地實測、選擇接近用戶區域的資源。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: B-Q8, B-Q13, C-Q7

D-Q9: 網站 404 與永久連結失效怎麼辦？
- A簡: 檢查路由與重寫規則、大小寫/編碼差異，設 301 對映表並修正站內連結。
- A詳: 症狀：文章或資源連結 404。原因：新環境路由差異、URL 重寫規則遺漏、大小寫/編碼與區分差異、媒體路徑變動。解法：匯總 404 日誌、建立 301 對映、修正重寫規則（Nginx/Apache）、更新站內連結與站點地圖；暫時以 CDN/維護頁緩解。預防：遷移前比對規則與演練爬蟲。
- 難度: 初級
- 學習階段: 核心
- 關聯概念: B-Q4, B-Q7, C-Q2, C-Q5

D-Q10: 如何安全回滾遷移？
- A簡: 保留舊環境可用，準備回滾腳本與 DNS 舊值，設定決策閾值並在時窗內執行。
- A詳: 症狀：切換後錯誤多、性能差或資料風險。解法：在預設閾值（錯誤率、延遲、可用率）超標時啟動回滾：恢復 DNS 舊值/權重、切回原資料庫、撤銷變更配置。步驟：宣告回滾→執行→驗證→事後檢討。預防：保留舊環境、變更版本化、回滾演練與清晰決策矩陣。
- 難度: 中級
- 學習階段: 進階
- 關聯概念: B-Q3, B-Q15, B-Q16, C-Q2


### 學習路徑索引
- 初學者：建議先學習 15 題
    - A-Q1: 什麼是停機公告？
    - A-Q2: 為什麼需要事先公告停機？
    - A-Q3: 什麼是服務託管（Hosting）？
    - A-Q4: 什麼是 DNS 託管？
    - A-Q5: DNS 託管與網站託管有何差異？
    - A-Q6: 什麼是備援（Redundancy/Fallback）？
    - A-Q8: 什麼是維護時窗（Maintenance Window）？
    - A-Q13: 什麼是 DNS TTL？
    - A-Q14: 為何遷移前要調低 TTL？
    - A-Q16: 什麼是 DNS 傳播？
    - A-Q19: 什麼是狀態頁與溝通管道？
    - B-Q1: DNS 解析如何運作？
    - B-Q2: DNS 記錄變更如何傳播？
    - C-Q3: 如何調降 TTL 並安排切換？
    - C-Q9: 如何規劃並發佈停機溝通訊息？

- 中級者：建議學習 20 題
    - A-Q7: 為何停機前要先找備援？
    - A-Q9: 計畫性與非計畫性停機有何差異？
    - A-Q10: 什麼是 RTO（復原時間目標）？
    - A-Q11: 什麼是 RPO（復原點目標）？
    - A-Q12: RTO 與 RPO 有何差異與關係？
    - A-Q15: 名稱伺服器（NS）與 A 記錄差異是什麼？
    - A-Q18: 什麼是異地備份（Off-site Backup）？
    - A-Q20: 冗餘的核心價值是什麼？
    - B-Q3: 一次性切換與藍綠部署如何運作？
    - B-Q4: 部落格服務典型架構是什麼？
    - B-Q6: DNS 快取與最小 TTL 機制是什麼？
    - B-Q7: 301 與 302 轉址差異與原理？
    - B-Q8: CDN 與 DNS 的互動原理？
    - B-Q9: 備份類型如何運作（完整/增量/差異）？
    - B-Q14: 停機溝通計畫的技術架構？
    - B-Q15: 如何估算停機時長？
    - C-Q1: 如何把 DNS 託管遷移到新供應商？
    - C-Q2: 如何以最少停機搬遷部落格網站？
    - C-Q7: 如何建立基礎監控與警報？
    - C-Q8: 如何用多地驗證 DNS 變更？

- 高級者：建議關注 15 題
    - B-Q5: 如何在遷移中維持近零停機？
    - B-Q10: 儲存快照的機制是什麼？
    - B-Q11: 複寫（同步/非同步）原理？
    - B-Q12: 健康檢查與自動故障轉移機制？
    - B-Q13: Anycast DNS 的工作原理？
    - B-Q16: 設定版本控管與變更流程原理？
    - B-Q17: 資料庫遷移與綱要凍結機制？
    - B-Q18: 變更 NS 與改 A 記錄的機制差異？
    - B-Q19: MX 記錄與郵件遷移原理？
    - B-Q20: 可用性量測與 SLA 計算原理？
    - C-Q4: 如何建立與驗證完整/增量備份？
    - C-Q5: 如何部署維護頁與 503 Retry-After？
    - C-Q10: 如何啟用唯讀模式或暫時鏡像？
    - D-Q7: 遷移期間資料不一致怎麼辦？
    - D-Q10: 如何安全回滾遷移？