# [RUN! PC] 2008 四月號

## 摘要提示
- 刊登通知: 作者文章刊登於 RUN! PC 2008 年四月號，主題與 ASP.NET 執行緒運用相關
- 主題焦點: 探討執行緒與 ASP.NET 搭配的技術問題與實作心得
- 投稿經驗: 初次投稿耗時，需重構範例程式與設計清晰圖表以突顯主題
- 讀者互動: 文章提供留言管道，歡迎讀者就內容交流與回饋
- 範例提供: 提供完整 sample code 下載連結與線上 Demo 可直接試跑
- 瀏覽器限制: IE 預設同站僅開兩條 HTTP 連線，可能影響測試結果
- 參數調校: 提供註冊機碼調整 IE 連線上限，建議測試前先設定
- 快速設定: 可下載現成 IE.reg 檔匯入，快速修改相關參數
- 紀念性質: 本文作為刊登紀念並集中相關資訊與連結
- 資源匯總: 文末整理所有相關下載與執行連結，便於讀者使用

## 全文重點
作者宣布其關於「執行緒與 ASP.NET 搭配應用」的技術文章已刊登於 RUN! PC 2008 年四月號。本文本身並非技術細節重述，而是作為刊登紀念與資訊彙整，並提供讀者交流的留言窗口。作者分享初次投稿的心路歷程：為了讓核心主題更易理解，花費相當時間重新思考範例程式的結構與呈現方式，同時調整圖表與說明以達到清楚明瞭的效果，也因此體會到專欄寫作的繁複與專業要求。

為了讓讀者能實際驗證與延伸文章內容，作者提供兩種使用方式：一是下載完整範例原始碼，以便在本機環境中編譯與運行；二是直接連到線上示範頁面，快速試跑文中提到的案例，降低入門與測試成本。考量到網頁端並行請求對執行緒行為的影響，作者特別提醒一項常被忽略的變數：Internet Explorer 的預設同站 HTTP 連線數限制。IE 預設僅允許對同一網域建立兩個連線，這會影響到負載、等待序列與非同步請求的觀察結果，因而可能導致與預期不一致的測試數據。

為解決此差異，作者提供兩個調整途徑：其一是於註冊機碼中手動設定 MaxConnectionsPerServer 與 MaxConnectionsPer1_0Server 的數值，提高同時連線上限（範例設為 8）；其二是直接下載作者準備好的 IE.reg 檔案，一鍵匯入完成設定，方便不熟悉登錄編輯或希望快速開始測試的讀者。這些輔助資源的重點在於創造更貼近實務環境的測試條件，使讀者在操作 sample code 或線上 Demo 時，能觀察到更具代表性的並行與執行緒互動行為。

整篇文章目的在於：一、告知刊登消息並留存紀念；二、集中並提供完整的測試資源（原始碼、線上 Demo、IE 設定檔）；三、引導讀者在進行與 ASP.NET 相關的並行測試時，留意瀏覽器層面的限制因素，避免誤讀結果。作者也歡迎讀者在本文留言區分享回饋、提出疑問或交流不同環境下的測試觀察，以期共同釐清 ASP.NET 與執行緒協作時的實務細節與最佳作法。

## 段落重點
### 刊登與主題說明
作者宣布其稿件刊登於 RUN! PC 2008 四月號，主題聚焦在「執行緒與 ASP.NET」的搭配運用與技術要點。文中強調這是基於一段時間的研究與實作心得所整理而成，屬於將經驗系統化後的分享。本文非重述雜誌內容，而是以紀錄與導覽為主，同時提供留言交流空間，讓讀者在閱讀雜誌後能回到此處互動。

### 投稿過程與製作心得
作者提到初次投稿的不易：為凸顯技術主題，需反覆調整 sample code 的結構，讓重點更集中、行為更可觀測；並為了降低理解門檻，投入時間設計清晰的圖表與配套說明。過程凸顯專欄寫作不僅是知識輸出，更牽涉敘事結構、範例可測性與視覺溝通，讓作者體會到專欄工作的專業密度與細節要求。

### 範例程式與線上 Demo
為提升可操作性，作者提供兩種資源：完整範例程式碼下載，以及可直接在瀏覽器中試跑的線上 Demo。前者方便讀者在本機環境調整與擴充測試，後者降低進入門檻，快速對照雜誌中的情境與結果。這種雙軌提供方式兼顧不同讀者的需求，從快速驗證到深入改造皆可覆蓋。

### IE 同站連線數限制與解法
作者提醒關鍵測試變數：IE 預設對同一網站僅開兩條 HTTP 連線，會影響非同步請求、併發行為與效能觀察，導致測試結果與預期不符。為解決此問題，提供兩種方法調整上限：一是修改註冊機碼 MaxConnectionsPerServer 與 MaxConnectionsPer1_0Server（範例設為 8）；二是直接匯入作者提供的 IE.reg 檔案，一步完成設定。此舉旨在建立更貼近實務的測試環境，確保對 ASP.NET 與執行緒互動的觀察更具代表性。

### 相關連結與讀者互動
文末集中所有資源連結：範例程式下載、線上示範、IE 連線上限註冊檔，方便讀者一次取得。作者也說明本文用途為刊登紀念與交流樞紐，鼓勵讀者在此分享實測心得與問題，協助釐清不同環境或設定下的差異，進一步加深對 ASP.NET 並行處理議題的理解。

## 資訊整理

### 知識架構圖
1. 前置知識：
   - 基本 C#/.NET 語法與類別庫使用
   - ASP.NET (Web Forms/Handler) 的請求生命週期與執行緒模型概念
   - HTTP/瀏覽器連線行為（同站連線上限）
   - Windows 登錄編輯與權限觀念

2. 核心概念：
   - ASP.NET 與多執行緒：在 Web 請求生命週期中啟用/使用執行緒的方式與限制
   - 併發測試與瀏覽器限制：IE 對同站同時連線數的預設限制影響測試結果
   - 設定調整：透過登錄鍵調整 IE 同站連線上限以獲得更接近實際的併發測試
   - 範例程式操作：可下載或線上執行範例，驗證文章提到的行為與效能差異

3. 技術依賴：
   - .NET Framework 與 ASP.NET 執行環境（IIS/ASP.NET Runtime）
   - 瀏覽器行為（特別是 IE 的 MaxConnectionsPerServer/Per1_0Server）
   - Windows 登錄（HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Internet Settings）

4. 應用場景：
   - 在 ASP.NET 中實作需要非同步或平行處理的工作（如長時間 I/O、批次任務）
   - 進行 Web 併發/吞吐量測試並校正用戶端限制造成的偏差
   - 教學或團隊內訓時以範例展示 ASP.NET 與執行緒互動的注意事項

### 學習路徑建議
1. 入門者路徑：
   - 了解 ASP.NET 請求生命週期與執行緒安全基礎
   - 熟悉 C# 基本多執行緒概念（Thread、ThreadPool、lock、同步機制）
   - 下載並執行範例，觀察在不同瀏覽器連線上限下的行為差異

2. 進階者路徑：
   - 深入 ASP.NET 與非同步程式設計（Page/Handler 的 async 模式、非同步 I/O）
   - 探索在 Web 環境啟動背景工作之風險與替代方案（例如外部服務、排程器、佇列）
   - 建立可重現的併發測試環境，控制用戶端/伺服器端變數並蒐集度量

3. 實戰路徑：
   - 將長時作業改為非同步 I/O 或背景服務處理，頁面以輪詢/SignalR/通知回報結果
   - 在測試前調整客戶端連線上限或改用專業壓測工具（避免瀏覽器限制干擾）
   - 以日誌與監控量測併發度、延遲與錯誤，驗證優化成效

### 關鍵要點清單
- ASP.NET 請求生命週期與執行緒關係: 在 ASP.NET 內使用執行緒需理解請求開始/結束與資源釋放時機 (優先級: 高)
- 非同步與多執行緒差異: 非同步 I/O 與多執行緒是不同策略，選擇合適方式可提升擴充性 (優先級: 高)
- IE 同站連線上限: IE 預設僅對同一網站開啟 2 條連線，會影響併發測試觀察 (優先級: 高)
- 登錄鍵調整連線數: 透過 MaxConnectionsPerServer 與 MaxConnectionsPer1_0Server 可提高同站連線上限 (優先級: 高)
- 測試結果的可重現性: 未控制瀏覽器連線上限將導致測試結果偏差與不可重現 (優先級: 高)
- 範例程式操作: 提供下載與線上執行的範例便於重現與理解文章重點 (優先級: 中)
- Thread/ThreadPool 使用時機: 在 Web 環境慎用自行建立執行緒，優先考慮 ThreadPool/非同步 API (優先級: 中)
- 同步機制與資源爭用: 鎖定策略、避免死鎖與降低臨界區對效能的影響 (優先級: 中)
- 背景作業在 Web 的風險: 應用程式回收、AppDomain 重啟可能中斷背景工作 (優先級: 中)
- 改善用戶端限制的替代方案: 在壓測時改用專業工具（如 JMeter、wrk）而非瀏覽器 (優先級: 中)
- 量測與監控: 以計時器、效能計數器與日誌量測延遲與吞吐量 (優先級: 中)
- 錯誤處理與取消機制: 長時非同步操作需設計超時、取消與補償 (優先級: 低)
- 安全與穩定性: 避免在 ASP.NET 進程中執行高風險長任務，降低對站台穩定性的影響 (優先級: 中)
- 相容性考量: 不同瀏覽器對同站連線上限設定不同，測試需標準化環境 (優先級: 低)
- 文件化與可讀性: 以清晰的 sample code 與圖表傳達主題，利於溝通與維護 (優先級: 低)