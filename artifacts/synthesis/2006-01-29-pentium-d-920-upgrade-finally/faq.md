# Pentium D 920, 早該換了 (Y)

## 問題與答案 (FAQ)

### Q&A 類別 A: 概念理解類

Q1: 什麼是 Pentium D 920？
- A簡: Intel 雙核心桌上型處理器，支援 VT 與 EM64T，部分早期批次未支援 Enhanced SpeedStep。
- A詳: Pentium D 920 是 Intel 雙核心處理器，主打多工效能，文中作者選用 945P 晶片組與 2GB DDR2-533，重點看重三項能力：Dual Core 提升多工、VT 支援虛擬機、EM64T 讓 Windows Server 2003 x64 與 64 位服務運作更順。需注意 2006 年第二季前的部分 920 批次不支援 Enhanced SpeedStep（動態降頻省電），屬於後續修訂才補上的功能。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: A-Q3, A-Q5, A-Q7, A-Q9, B-Q1

Q2: 為何從 P2B-DS 升級到 Pentium D 920？
- A簡: 需求含雙核心、硬體虛擬化、64 位元效能，並解決舊機效能與擴充瓶頸。
- A詳: 舊板 P2B-DS 可插雙實體 CPU，但已使用多年且效能瓶頸明顯。作者常讓伺服器長時間背景工作，雙核心能穩定分攤負載；同時需要硬體輔助虛擬化跑 VM，Pentium D 920 具 VT；EM64T 讓其能裝 Windows Server 2003 x64，整體服務（Web/SMTP/File/VPN/VM/轉檔）以 64 位元版運行，主觀體感更順，並開始逼近 100M 網路極限。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: A-Q1, A-Q5, A-Q7, A-Q18, A-Q19

Q3: 什麼是雙核心（Dual Core）？
- A簡: 單顆處理器內含兩個運算核心，可同時處理多執行緒以提升多工能力。
- A詳: 雙核心是將兩個 CPU 核心整合於單一處理器封裝中。對作業系統而言，就像擁有兩個邏輯處理器，可同時執行不同的執行緒或行程，降低背景工作對前景服務的影響。對伺服器工作負載，如 Web、郵件、檔案服務與影片轉檔、虛擬機同時運作，雙核心能顯著提升回應性與吞吐。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: A-Q4, B-Q4, B-Q18

Q4: 雙核心與雙 CPU 有何差異？
- A簡: 雙核心為單顆封裝兩核心；雙 CPU 為兩顆實體處理器。前者整合度高、省電，後者擴充彈性大。
- A詳: 雙核心（單插槽、兩核心）具有較佳的匯流排整合、快取共享與能耗表現；雙 CPU（雙插槽）則是兩顆獨立實體處理器，各自與記憶體/晶片組互動。雙 CPU 系統通常成本、主機板複雜度較高，但可擴充更多核心數。對一般家用/小型伺服器，雙核心已能滿足多工需求且價格更親民。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: B-Q4, A-Q3, A-Q23

Q5: 什麼是 Intel VT（Virtualization Technology）？
- A簡: Intel 的硬體虛擬化擴充，協助虛擬機更有效率與更相容地執行。
- A詳: Intel VT 提供 CPU 指令與權限級別的新模式，讓虛擬機管理程式（VMM/Hypervisor）更直接攔截敏感操作，降低傳統全軟體虛擬化的陷入/模擬成本。這提高多數客體 OS 的相容性與效能，尤其是需要頻繁系統呼叫與中斷的工作負載，對在同機運行多台 VM 的情境特別有利。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: B-Q1, A-Q6, C-Q5

Q6: 為什麼 VT 對虛擬機重要？
- A簡: 降低陷入與模擬開銷、提升相容性與穩定性，使多台 VM 能更順暢。
- A詳: 傳統二進位轉譯或半虛擬化需改寫或攔截特權指令，開銷大、相容性受限。VT 讓 Hypervisor 在硬體層即能切換虛擬機與宿主，直接處理敏感操作，降低 VM 進出核心態的成本。結果是 VM 開機更快、I/O 更順、對舊系統或商業軟體的相容性提高，利於在單機整合多服務。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: B-Q1, A-Q5, C-Q5

Q7: 什麼是 EM64T（Intel 64）？
- A簡: Intel 的 x86 64 位元延伸，提供更大記憶體尋址與更多暫存器。
- A詳: EM64T（後稱 Intel 64）在既有 x86 架構上加入 64 位元長模式，擴展虛擬記憶體與實體記憶體空間，並帶來更多通用暫存器，利於編譯器與高效能應用。可執行 64 位元 OS 與應用，也保留 32 位相容模式以運行舊程式，適合服務整合與大型檔案/編碼工作。
- 難度: 初級
- 學習階段: 核心
- 關聯概念: B-Q2, A-Q12, A-Q11

Q8: EM64T 與 AMD64 有何關係？
- A簡: 指令集高度相容，概念相近；EM64T 為 Intel 品名，與 AMD64 互通性佳。
- A詳: EM64T 本質上與 AMD64 屬於同一家族的 x86-64 延伸，長模式/相容模式的運作原理相近，主流 OS 與編譯器以「x86-64」為共通目標進行支援。實務上兩者在軟體層相容性高，使用者可不必拘泥品牌名稱，關鍵在於 OS/驅動與應用的 64 位支援成熟度。
- 難度: 初級
- 學習階段: 核心
- 關聯概念: B-Q2, A-Q7, A-Q12

Q9: 什麼是 Enhanced SpeedStep（EIST）？
- A簡: Intel 的動態電壓/頻率調整技術，依負載自動省電降溫。
- A詳: EIST 透過多個 P-state 在 CPU 負載較低時降低頻率與電壓，達到節能與降溫；高負載時再提升頻率以保性能。對伺服器而言可改善待機能耗與風扇噪音，延長硬體壽命。不過前提是 CPU 型號與主機板 BIOS 需支援相對應的 P-state 管理。
- 難度: 初級
- 學習階段: 核心
- 關聯概念: B-Q3, A-Q1, A-Q10

Q10: 為何部分 Pentium D 920 不支援 EIST？
- A簡: 需 2006 年 Q2 之後的修訂版本；早期批次未提供該功能。
- A詳: 文中提到作者功課未做足，入手時期屬於未包含 EIST 的批次。這常見於產品早期步進尚未開放全部特性，後續修訂版（新步進/新微碼與 BIOS）才加入。購買前應檢視 Intel 規格表、步進代碼與主機板 BIOS 支援清單，避免功能落差。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: A-Q9, B-Q3, D-Q10

Q11: 為什麼升級到 Windows Server 2003 x64？
- A簡: 充分利用 EM64T、使用 64 位服務版本、提升多工與大檔處理效能。
- A詳: 64 位 OS 能存取更大記憶體、提供更多暫存器帶來編碼/加解密/壓縮等運算優勢，並允許 64 位原生服務（IIS、SMTP、檔案服務）更好運行。同時保留 WoW64 執行 32 位應用，兼顧相容性。對同時跑 Web、VM、轉檔與網路服務的主機，綜合效益明顯。
- 難度: 初級
- 學習階段: 核心
- 關聯概念: A-Q7, A-Q12, B-Q5

Q12: 32 位與 64 位作業系統的差異？
- A簡: 64 位提供更大記憶體、更多暫存器與較佳運算效能；32 位相容性高但受限。
- A詳: 在 64 位 OS 中，行程可獲更大位址空間，減少記憶體碎裂與換頁；編碼、加密等可利用更多暫存器與 64 位指令優勢。相對地，32 位應用受 2–4GB 位址空間限制，但相容性較成熟。WoW64 可在 x64 上跑 32 位程式，惟涉及驅動與某些外掛時仍可能受限。
- 難度: 初級
- 學習階段: 核心
- 關聯概念: B-Q2, B-Q5, A-Q25

Q13: 為何某些軟體在 2003 x64 只能以 32 位模式執行？
- A簡: 缺乏 64 位版本或依賴 32 位元件/外掛，只能透過 WoW64 運行。
- A詳: 若應用或其相依之 COM/原生 DLL 僅提供 32 位版本，IIS 或宿主程式就需切至 32 位模式運作。例如某些 Blog 引擎套件或資料庫驅動無 x64 版，便需在 IIS 中啟用 32 位應用程式集區。此時仍可於同機並行 64 位與 32 位網站，分開集區承載。
- 難度: 初級
- 學習階段: 核心
- 關聯概念: B-Q5, B-Q16, C-Q2

Q14: 什麼是 ASP.NET 2.0？
- A簡: 微軟的 Web 應用框架 2.0 版，支援伺服器控制項、編譯與快取等機制。
- A詳: ASP.NET 2.0 引入更豐富的伺服器控制項、主版頁面、成員資格、站台導航與快取等，並由 IIS 的工作行程承載。可在 x64 原生或 WoW64 下執行，依網站相依性決定 32/64 位。對單機多服務情境，其進程隔離與回收機制提升穩定性。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: B-Q6, C-Q1, C-Q2

Q15: 什麼是 Web/SMTP/File Server？
- A簡: Web 提供 HTTP 服務；SMTP 負責郵件傳遞；File 透過 SMB 分享檔案。
- A詳: Web Server（IIS）回應 HTTP(S) 請求並承載 ASP.NET 應用；SMTP Server 依 RFC 5321 負責郵件收發、佇列與轉遞；File Server 以 SMB/CIFS 協定提供共享、權限與鎖定。三者是小型伺服器的常見角色，搭配 VPN/NAT 與 VM，即可在單機整合多項服務。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: B-Q7, B-Q8, C-Q3, C-Q4

Q16: 什麼是 VPN 與 NAT？
- A簡: VPN 建立加密通道；NAT 轉換內外網位址以共享連線並隔離內網。
- A詳: VPN（如 PPTP、L2TP/IPsec）於公共網路上建立加密隧道，保護資料；NAT 將私網 IP 映射至公網 IP，維持連線並隱藏內部結構。Windows 2003 可用 RRAS 佈署兩者，實現遠端存取與內網服務公開的彈性組合。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: B-Q9, C-Q6, D-Q6

Q17: 什麼是影片編碼（DV/DC 轉 WMV）？
- A簡: 將數位攝影機/相機影片轉為 WMV 等壓縮格式，減少容量便於傳輸。
- A詳: DV/DC 原始影片碼率高、體積大，透過編碼器（如 Windows Media Encoder）轉為 WMV，可大幅降低檔案大小並控制畫質。此類運算吃 CPU 與記憶體頻寬，多核心與 x64 指令可加速。伺服器可排程背景轉檔，與其他服務並行。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: B-Q10, A-Q23, C-Q7

Q18: 什麼是 100M 網路塞爆？
- A簡: 實際吞吐接近 100Mbps 上限，圖表顯示持續滿載，成為下一個瓶頸。
- A詳: 100BASE-TX 理論速率 100Mbps，實務因協定開銷（TCP/IP、SMB）、延遲與中斷處理，極限吞吐略低。當檔案伺服器或影片傳輸長時間滿載，CPU 與磁碟仍有餘裕時，即顯示網路成為主要瓶頸，提示升級 GBE 的價值。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: B-Q11, A-Q19, C-Q8

Q19: 為何要升級到 Gigabit Ethernet（GBE）？
- A簡: 提升到 1Gbps，解除傳輸瓶頸，配合端到端升級才能發揮效益。
- A詳: 當 100M 已成極限，升級至 1GbE 可獲約 5–10 倍實際吞吐提升（取決於端點、協定與封包大小）。需同時升級交換器、網卡、纜線（Cat5e/6）與驅動設定（如 Jumbo Frames），才能讓端對端鏈路都達到千兆能力。
- 難度: 初級
- 學習階段: 核心
- 關聯概念: B-Q12, C-Q9, D-Q9

Q20: 什麼是 945P 晶片組？
- A簡: Intel 桌上型晶片組，支援 LGA775、DDR2、PCIe，常與 Pentium D 搭配。
- A詳: 945P 提供處理器匯流排、記憶體控制（DDR2-533/667）、PCI Express 插槽與 I/O 控制器連線。對於當時的 Pentium D 平台，它能穩定支援雙核心處理器與常見擴充卡，構成具成本效益的伺服器/工作站基礎。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: B-Q13, A-Q22, D-Q10

Q21: Pentium D 820 與 920 差異是什麼？
- A簡: 920 支援 VT 並採較新製程；820 不支援 VT，功能受限於虛擬化需求。
- A詳: 文章中作者因需虛擬機而放棄 820，選擇 920。920 提供 VT 以提升 VM 相容與效能；820 缺乏 VT，造成考慮期延長。除此之外，兩者在功耗、時脈與步進也有差異，實務選型需依虛擬化與 64 位需求決定。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: A-Q5, A-Q6, D-Q2

Q22: 什麼是 DDR2-533？
- A簡: DDR2 記憶體速度標示，實際時脈 266MHz，雙倍資料傳輸達 533MT/s。
- A詳: DDR2-533 以 266MHz 時脈、雙資料傳輸提供名義 4.26GB/s 單通道頻寬（64-bit 寬度）。雖延遲較 DDR 初期高，但在雙核心與多工負載下，頻寬對影片編碼、網路緩衝與 VM 有幫助。選購時留意雙通道配置與相容性。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: B-Q14, A-Q3, D-Q10

Q23: 為何雙核心適合多工與背景工作？
- A簡: 分攤不同執行緒於兩核心，降低互相干擾，提升回應與吞吐。
- A詳: 當伺服器同時跑 Web、郵件、檔案分享與轉檔/VM，單核心易在高峰出現延遲。雙核心讓排程器可並行執行 CPU 密集與 I/O 密集工作，避免長任務壅塞前台回應，整體體感更流暢且穩定。
- 難度: 初級
- 學習階段: 核心
- 關聯概念: B-Q4, B-Q18, A-Q17

Q24: 什麼是 WoW64？
- A簡: Windows x64 上的 32 位相容層，讓 32 位應用可在 64 位 OS 運行。
- A詳: WoW64 透過獨立的系統路徑與重導向機制，讓 32 位應用在 x64 上獲得對應的 DLL 與登錄檔視圖，不需修改即可執行。限制在於無法載入 64 位 DLL，部分驅動或外掛需原生 x64 才能運作。IIS 可透過 32 位應用程式集區承載 32 位網站。
- 難度: 初級
- 學習階段: 核心
- 關聯概念: B-Q5, B-Q19, C-Q2

Q25: 這次升級的核心價值是什麼？
- A簡: 多工穩定、虛擬化能力、64 位效能與未來擴充（GBE、更多服務整合）。
- A詳: 由舊雙 CPU 平台轉向現代雙核心＋x64 的組合，取得更好的每瓦效能、虛擬化支援與 64 位資源利用；服務集中（Web/SMTP/File/VPN/VM/轉檔）且相容性可控。當 100M 網路成瓶頸時，升級 GBE 可接續放大效益，逐步打造可擴充的家庭/小型辦公室伺服器。
- 難度: 初級
- 學習階段: 核心
- 關聯概念: A-Q19, C-Q9, D-Q9

---

### Q&A 類別 B: 技術原理類

Q1: Intel VT 如何運作？
- A簡: 透過新權限層與 VMX 模式，硬體攔截敏感操作，降低模擬成本。
- A詳: 技術原理說明：VT 引入 VMX root/non-root 模式，敏感指令由硬體觸發 VM exit 交由 VMM 處理，減少二進位轉譯。關鍵步驟或流程：CPU 進入 VMXON、建立 VMCS、啟動 VMLAUNCH/VMRESUME，客體執行期間遇事件觸發 VM exit，再由 VMM 決策。核心組件介紹：VMM/Hypervisor、VMCS、EPT（較新一代的頁表虛擬化）。
- 難度: 中級
- 學習階段: 進階
- 關聯概念: A-Q5, A-Q6, C-Q5

Q2: EM64T 的長模式與相容模式如何運作？
- A簡: 長模式執行 64 位程式；相容模式執行 32 位程式，共存於 x64 OS。
- A詳: 技術原理說明：處理器在長模式具 64 位暫存器與位址空間，支援 RIP 相對定址；相容模式允許 32 位程式於 x64 核心上運行。關鍵步驟或流程：OS 啟用長模式、設定分段/分頁，透過系統呼叫切換特權級。核心組件：x64 核心、記憶體管理單元（MMU）、WoW64 相容層。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q7, A-Q12, B-Q5

Q3: Enhanced SpeedStep（EIST）背後機制是什麼？
- A簡: 以 P-state 調整電壓與頻率，動態平衡效能與功耗。
- A詳: 技術原理說明：CPU 透過 ACPI P-state 與 VID 設定，依負載切換倍頻與電壓。關鍵步驟或流程：OS/驅動監控負載→請求 P-state→CPU/VRM 執行電壓頻率變更。核心組件介紹：ACPI、電源管理驅動、主機板 VRM、BIOS 選項。需 CPU/BIOS 皆支援才可啟用。
- 難度: 中級
- 學習階段: 進階
- 關聯概念: A-Q9, A-Q10, D-Q10

Q4: 雙核心處理器如何分派多執行緒？
- A簡: OS 排程器在兩核心間分配執行緒，考量負載平衡與快取親和性。
- A詳: 技術原理說明：Windows 調度器依優先權、時間片與親和性將執行緒分配至可用核心。關鍵步驟或流程：就緒佇列取出→選擇核心→考量遷移成本（快取命中）→執行→搶先/釋出。核心組件介紹：排程器、核心中斷（DPC）、快取階層（L1/L2）。多工下可提升吞吐與互動性。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q3, A-Q23, B-Q18

Q5: WoW64 在 x64 上如何運作？
- A簡: 提供 32 位 API 與重導向，讓 32 位程式於 x64 核心上透明執行。
- A詳: 技術原理說明：WoW64 在同一核心上建立 32 位子系統，使用 SysWOW64 DLL 與 WOW6432Node 註冊檔視圖。關鍵步驟或流程：載入 32 位映像→API 轉接至 64 位核心→檔案/登錄重導向。核心組件介紹：wow64.dll、wow64win.dll、檔案/註冊表重導向器。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q24, B-Q19, C-Q2

Q6: ASP.NET 2.0 在 IIS 6 上的處理管線如何運作？
- A簡: HTTP.sys 進核心，w3wp 工作行程承載管線，模組/處理常式處理請求。
- A詳: 技術原理說明：IIS 6 使用 HTTP.sys 內核接聽，將請求派送至對應應用程式集區的 w3wp。關鍵步驟或流程：HTTP.sys→ISAPI 篩選器（aspnet_isapi）→管線事件（BeginRequest 等）→處理常式→輸出快取。核心組件介紹：應用程式集區、w3wp、ASP.NET 管線、回收/健康監視。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q14, C-Q1, C-Q2

Q7: SMTP Server 的執行流程為何？
- A簡: 解析 MX、建立 SMTP 會話、投遞或佇列，重試與退信策略。
- A詳: 技術原理說明：依 DNS MX 紀錄決定目的伺服器，透過 SMTP 指令交換郵件。關鍵步驟或流程：接收→驗證/過濾→佇列→投遞→失敗重試→退信。核心組件介紹：IIS SMTP 服務、佇列目錄、DNS 解析器、記錄檔。效能受網路與 DNS 影響。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q15, C-Q3, D-Q4

Q8: File Server 與 SMB/CIFS 的運作機制？
- A簡: 透過 SMB 協定交握、驗證、鎖定與快取來傳輸檔案。
- A詳: 技術原理說明：SMB 建立工作階段，協商方言、身份驗證，進行檔案開啟/鎖定/讀寫。關鍵步驟或流程：連線→協商→認證→樹連線→檔案操作→快取/機會鎖。核心組件介紹：LanmanServer、NTFS 權限、離線快取、傳輸加密（新版）。吞吐受 NIC/交換器與磁碟影響。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q15, C-Q4, D-Q5

Q9: VPN 與 NAT 的資料流背後機制？
- A簡: 封裝加密後透過公網傳輸；NAT 映射內外位址與連線追蹤。
- A詳: 技術原理說明：VPN 將 IP 封包再封裝（PPTP/Gre、L2TP/UDP、IPsec/ESP），NAT 依五元組建立轉譯表。關鍵步驟或流程：撥入→認證→隧道建立→資料封裝→轉譯→送達。核心組件介紹：RRAS、NAT 表、加密套件、MTU 調整。與防火牆、路由互相配合。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q16, C-Q6, D-Q6

Q10: DV/DC 到 WMV 的編碼流程是什麼？
- A簡: 解碼原始串流、色彩轉換、壓縮編碼、封裝輸出。
- A詳: 技術原理說明：將 DV（通常 YUV）解碼，進行尺度/色彩空間轉換，再以 WMV 編碼器壓縮，最後封裝為 ASF 容器。關鍵步驟或流程：讀取→濾鏡鏈→編碼參數（碼率/GOP）→多執行緒切片→寫檔。核心組件介紹：解碼器、編碼器、濾鏡、I/O 緩衝。
- 難度: 中級
- 學習階段: 進階
- 關聯概念: A-Q17, C-Q7, B-Q20

Q11: 100M 乙太網路的吞吐限制為何？
- A簡: 協定與媒體開銷使可用吞吐低於 100Mbps，約八九成上下。
- A詳: 技術原理說明：Ethernet 幀頭、IP/TCP 開銷、ACK、延遲與 Nagle/窗口大小影響吞吐。關鍵步驟或流程：連線建立→流量控制→資料傳輸→擁塞避免。核心組件介紹：NIC、交換器緩衝、TCP 堆疊。大檔案傳輸與 SMB 請求會使 100M 容易達飽和。
- 難度: 初級
- 學習階段: 核心
- 關聯概念: A-Q18, A-Q19, C-Q8

Q12: Gigabit Ethernet 架構與需求為何？
- A簡: 1Gbps 連結需端到端支援，包括 NIC、交換器、纜線與驅動設定。
- A詳: 技術原理說明：1000BASE-T 使用 4 對雙絞線全雙工傳輸，PAM-5 編碼。關鍵步驟或流程：自動協商→連線訓練→幀傳輸→流量控制。核心組件介紹：NIC（支援 IRQ 分散/多佇列）、交換器背板、Cat5e/6 纜線、Jumbo Frames。缺一則效能受限。
- 難度: 初級
- 學習階段: 核心
- 關聯概念: A-Q19, C-Q9, D-Q9

Q13: 945P 晶片組的架構如何設計？
- A簡: 北橋連 CPU/記憶體/PCIe，南橋負責 I/O 與儲存裝置。
- A詳: 技術原理說明：北橋（MCH）連接處理器匯流排與記憶體控制器、顯示 PCIe；南橋（ICH7）提供 SATA、USB、PCI 與網路控制。關鍵步驟或流程：資料於北/南橋間透過內部匯流排交換。核心組件介紹：MCH、ICH、BIOS、VRM。提供 Pentium D 平台穩定運作的基礎。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: A-Q20, A-Q22, D-Q10

Q14: DDR2-533 的頻寬與延遲原理？
- A簡: 雙倍資料傳輸提供較高頻寬，但相較 DDR 初期延遲更高。
- A詳: 技術原理說明：DDR2 以預取 4-bit、較高時脈降低 I/O 電壓提升頻寬/降功耗。關鍵步驟或流程：命令/位址→資料突發→預取寫回。核心組件介紹：記憶體控制器、DIMM 參數（CAS、tRCD、tRP）。對多工與編碼有益，延遲以快取與併行掩蓋。
- 難度: 中級
- 學習階段: 進階
- 關聯概念: A-Q22, A-Q3, B-Q4

Q15: x64 上的檔案系統與登錄重導向機制？
- A簡: 32 位程式被導向 SysWOW64 與 WOW6432Node，避免與 x64 混用衝突。
- A詳: 技術原理說明：系統攔截 32 位程式對 System32 與 HKLM\Software 的存取，重導向到對應的 32 位路徑。關鍵步驟或流程：呼叫攔截→判斷位數→重導向→回應。核心組件介紹：檔案/登錄重導向器、WoW64 子系統。利於同機並行 32/64 位應用。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q24, B-Q5, C-Q2

---

### Q&A 類別 C: 實作應用類（10題）

Q1: 如何在 Windows Server 2003 x64 安裝與設定 IIS 6 與 ASP.NET 2.0？
- A簡: 啟用 IIS、安裝 .NET 2.0、設定應用程式集區與網站對應、驗證功能正常。
- A詳: 具體實作步驟：1) 伺服器管理精靈安裝 IIS 與 ASP.NET 支援；2) 安裝 .NET Framework 2.0 x64；3) 使用 aspnet_regiis -i 註冊；4) 建立應用程式集區與網站，設定管線與身分；5) 部署應用並測試。關鍵程式碼片段或設定：命令 aspnet_regiis -i；於 IIS 管理員設定應用程式集區。注意事項與最佳實踐：分離前台/後台網站至不同集區，啟用記錄與回收策略。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: B-Q6, C-Q2, D-Q1

Q2: 如何啟用 IIS 6 的 32 位應用程式集區以支援 32 位 Blog？
- A簡: 以 ADSI 腳本切換 32 位模式，重新註冊 32 位 ASP.NET 並獨立應用程式集區。
- A詳: 具體實作步驟：1) 切換 32 位模式 cscript %SystemDrive%\Inetpub\AdminScripts\adsutil.vbs set W3SVC/AppPools/Enable32bitAppOnWin64 1；2) 以 %SystemRoot%\Microsoft.NET\Framework\v2.0.50727\aspnet_regiis.exe -i 重新註冊；3) 將需 32 位的網站指派至該集區。關鍵設定：分離 x86/x64 集區。注意與最佳實踐：避免混載，明確命名集區並記錄相依模組。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q13, B-Q16, B-Q15

Q3: 如何在 x64 上部署 SMTP Server（IIS SMTP）？
- A簡: 安裝 IIS SMTP 服務、設定伺服器名稱、中繼限制、DNS 與佇列目錄。
- A詳: 具體實作步驟：1) 新增 Windows 元件安裝「SMTP 服務」；2) 設定虛擬伺服器屬性（存取、傳遞、中繼）；3) 設定 DNS 伺服器與退信策略；4) 開啟服務並測試投遞。關鍵設定：限制中繼、開啟記錄。注意事項：封鎖開放中繼、防垃圾郵件設定、監看佇列堆積。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: B-Q7, D-Q4, C-Q1

Q4: 如何設定檔案伺服器共享與 NTFS 權限？
- A簡: 建立共享、設定 NTFS 權限與分享權限，採最小必要授權並記錄存取。
- A詳: 具體實作步驟：1) 建立資料夾與分享（Share）名稱；2) 設定 NTFS 權限（Users/Groups）與 Share 權限；3) 啟用稽核與配額管理（選用）；4) 透過 \\server\share 測試存取。關鍵設定：以 NTFS 為主控權限，Share 以 Everyone/Change 覆蓋後再細分。注意事項：避免使用者誤刪、備份與版本控管。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: B-Q8, D-Q5, C-Q9

Q5: 如何建置可用 VT 的虛擬機平台？
- A簡: 於 BIOS 開啟 VT，安裝虛擬化軟體（如 Virtual Server 2005 R2/VMware Server），建立 VM。
- A詳: 具體實作步驟：1) 進入 BIOS 啟用 Intel VT；2) 安裝微軟 Virtual Server 2005 R2 或 VMware Server；3) 建立虛擬交換器與儲存位置；4) 建立 VM、安裝客體 OS；5) 安裝整合工具。關鍵設定：CPU/記憶體分配、網路橋接。注意事項：避免過度超分配，定期更新虛擬化平台修補。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q5, B-Q1, D-Q2

Q6: 如何在 Windows 2003 建置 VPN 與 NAT（RRAS）？
- A簡: 啟用 RRAS，設定 NAT 與 VPN 端點，開放對應通訊埠並建立使用者存取。
- A詳: 具體實作步驟：1) 開啟「路由與遠端存取」精靈；2) 選擇 NAT/基本防火牆與 VPN 存取；3) 指定公網/私網介面；4) 設定使用者撥入權限；5) 防火牆開啟 PPTP（TCP 1723, GRE）或 L2TP/IPsec（UDP 500, 4500, ESP）。關鍵設定：位址池、路由。注意事項：調整 MTU、防止分離通道 DNS 泄露。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: B-Q9, D-Q6, C-Q9

Q7: 如何將 DV/DC 影片轉為 WMV？
- A簡: 使用 Windows Media Encoder 設定來源、碼率與輸出檔，啟動編碼。
- A詳: 具體實作步驟：1) 安裝 Windows Media Encoder 9；2) 選擇來源（DV/檔案）；3) 設定編碼設定（解析度、位元率、音訊）；4) 指定輸出檔；5) 啟動並監看 CPU/磁碟。關鍵設定：多執行緒、雙通道記憶體、I/O 優化。注意事項：保持散熱、避免與高 I/O 服務同時滿載。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: B-Q10, A-Q17, D-Q3

Q8: 如何監測網路吞吐判斷是否塞爆？
- A簡: 以效能監視器/工作管理員觀察 NIC 使用率，配合 iperf/傳輸測試確認。
- A詳: 具體實作步驟：1) 開啟 PerfMon 加入「Network Interface\Bytes Total/sec」；2) 觀察持續接近理論上限；3) 用大檔 SMB 或 iperf 進行端對端測試；4) 檢視 CPU 中斷/佇列。關鍵設定：關閉省電節能導致降速。注意事項：同時確認磁碟、CPU 非瓶頸，以排除非網路因素。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: B-Q11, A-Q18, D-Q5

Q9: 如何規劃從 100M 升級到 Gigabit？
- A簡: 端到端升級 NIC、交換器與線材，啟用對應功能如 Jumbo Frames。
- A詳: 具體實作步驟：1) 確認線材 Cat5e/6；2) 更換千兆交換器與支援千兆之 NIC；3) 更新驅動與韌體；4) 在 NIC/交換器啟用 Jumbo（如 9000 MTU）並測試；5) 端對端驗證吞吐。關鍵設定：全雙工、自動協商。注意事項：Jumbo 須端點一致，否則降速或丟包。
- 難度: 初級
- 學習階段: 核心
- 關聯概念: B-Q12, D-Q9, A-Q19

Q10: 如何在 x64 同機承載 32 與 64 位服務互不影響？
- A簡: 以不同應用程式集區/服務帳號隔離，明確區分相依與監控資源。
- A詳: 具體實作步驟：1) 建立 x64 與 x86 獨立 IIS 集區；2) 依網站相依指定集區；3) 使用獨立服務帳號與檔案許可；4) 設定資源限制與回收；5) 監看記憶體/CPU 使用。關鍵設定：IIS 32 位集區開關、WoW64 重導向。注意事項：避免跨位數載入 DLL，明確版本管理。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: B-Q15, C-Q2, D-Q1

---

### Q&A 類別 D: 問題解決類（10題）

Q1: 遇到 ASP.NET 網站在 2003 x64 無法載入怎麼辦？
- A簡: 重新註冊 ASP.NET、確認位數與集區設定、查看事件檢視器錯誤。
- A詳: 問題症狀描述：網站 500 錯誤或空白頁。可能原因分析：未註冊正確位數的 ASP.NET、IIS 集區位數錯誤、權限不足。解決步驟：1) 以 aspnet_regiis -i 重新註冊對應位數；2) 檢查並設定集區為 32/64 位；3) 檢視事件檢視器與 Web.config；4) 權限修正。預防措施：建立 x86/x64 分離集區與部署腳本。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: C-Q1, C-Q2, B-Q6

Q2: 虛擬機啟動顯示不支援 VT，要如何處理？
- A簡: 於 BIOS 啟用 VT、更新 BIOS、確認 CPU 型號與虛擬化平台版本。
- A詳: 問題症狀描述：VMM 提示 VT 不可用。可能原因分析：BIOS 關閉 VT、舊 BIOS 無選項、CPU 不支援或平台版本過舊。解決步驟：1) 進 BIOS 啟用 Intel VT；2) 更新 BIOS；3) 驗證 CPU 型號（920 支援、820 不支援）；4) 更新虛擬化軟體。預防措施：購前查規格、維持 BIOS 與平台版本。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: A-Q5, A-Q21, C-Q5

Q3: 影片編碼效能不佳的原因與解法？
- A簡: CPU/記憶體/磁碟瓶頸或設定不當；優化執行緒、碼率與 I/O。
- A詳: 問題症狀描述：轉檔速度慢、CPU 未滿載。可能原因分析：單執行緒編碼、記憶體頻寬不足、磁碟 I/O 受限、背景服務爭用。解決步驟：1) 啟用多執行緒；2) 檢查 DDR2 雙通道；3) 使用獨立磁碟；4) 排程在離峰。預防措施：固定設定檔、監控資源、保持散熱良好。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q17, B-Q20, C-Q7

Q4: SMTP 佇列塞車該如何診斷？
- A簡: 檢查 DNS/MX、中繼限制、連線封鎖與退信，調整重試與清理佇列。
- A詳: 問題症狀描述：郵件久未送達、佇列累積。可能原因分析：DNS 解析失敗、對方伺服器拒收、開放中繼被濫用、外連被封鎖。解決步驟：1) 測試 nslookup MX；2) 查看退信碼；3) 限制中繼；4) 清理退件；5) 與 ISP 溝通。預防措施：SPF/DKIM、黑名單監控、限速策略。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: B-Q7, C-Q3, A-Q15

Q5: 檔案伺服器傳輸速度低於預期如何排查？
- A簡: 檢查雙工/自動協商、磁碟/CPU/網卡驅動、網路是否已飽和。
- A詳: 問題症狀描述：SMB 傳輸緩慢。可能原因分析：半雙工降速、NIC 驅動老舊、磁碟 I/O 或 CPU 中斷瓶頸、100M 已滿載。解決步驟：1) 確認雙工與速率；2) 更新驅動；3) 測 iperf；4) 檢視 PerfMon。預防措施：升級 GBE、標準化 NIC 設定、良好佈線。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: B-Q8, C-Q8, A-Q19

Q6: VPN 無法連線或不穩定該怎麼辦？
- A簡: 檢查通訊埠/協定、NAT 穿越、MTU 與憑證設定，排除防火牆影響。
- A詳: 問題症狀描述：撥入失敗、頻繁斷線。可能原因分析：埠未開、GRE/ESP 被過濾、NAT 穿越失敗、MTU 過大。解決步驟：1) 開 TCP 1723/UDP 500/4500/GRE/ESP；2) 啟用 NAT-T；3) 減少 MTU（如 1400）；4) 驗證使用者權限。預防措施：固定策略、監看日誌、優先選較穩協定。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: B-Q9, C-Q6, A-Q16

Q7: 64 位系統上註冊 32 位元件失敗怎麼處理？
- A簡: 使用 SysWOW64 下的 regsvr32 註冊 32 位 DLL，避免混用 System32。
- A詳: 問題症狀描述：COM 元件無法載入。可能原因分析：用錯 regsvr32 位數、路徑重導向混淆。解決步驟：1) 用 %SystemRoot%\SysWOW64\regsvr32.exe 指向 32 位 DLL；2) 確認依賴 DLL；3) 檢查 WOW6432Node 註冊表。預防措施：明確分開 x86/x64 安裝路徑與腳本。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: B-Q15, A-Q24, C-Q2

Q8: IIS 工作行程頻繁回收導致不穩如何處理？
- A簡: 調整回收條件、記憶體限制與健康檢查，分離問題應用至獨立集區。
- A詳: 問題症狀描述：網站間歇中斷、記錄顯示回收。可能原因分析：預設回收間隔、記憶體高峰、未處理例外。解決步驟：1) 延長回收間隔或改為特定時間；2) 合理設定虛擬記憶體限制；3) 啟用失敗要求追蹤；4) 問題站獨立集區。預防措施：壓測、版本控管、資源監控。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: B-Q6, C-Q1, C-Q10

Q9: 升級到 GBE 後仍跑不滿速度的原因？
- A簡: 端到端未一致、Jumbo 不匹配、CPU/NIC 無中斷分散、線材或驅動問題。
- A詳: 問題症狀描述：千兆連線，但吞吐遠低於預期。可能原因分析：交換器/NIC 有一端仍 100M、Jumbo MTU 不一致導致丟包、CPU 單核瓶頸。解決步驟：1) 確認兩端都 1Gbps/全雙工；2) 統一 MTU；3) 啟用 RSS/中斷分散；4) 更換 Cat5e/6 線與更新驅動。預防措施：部署前一致性檢核與壓測。
- 難度: 初級
- 學習階段: 核心
- 關聯概念: B-Q12, C-Q9, A-Q19

Q10: 升級硬體後系統不穩或藍屏如何處理？
- A簡: 更新 BIOS/驅動、檢查記憶體相容與電源穩定，逐一排除新硬體。
- A詳: 問題症狀描述：隨機重開或藍屏。可能原因分析：BIOS 舊、驅動不相容、RAM 時序或電壓不符、電源不足。解決步驟：1) 更新 BIOS 與晶片組驅動；2) 跑記憶體測試；3) 降低超頻/調回預設；4) 單條 RAM/單卡逐一排除。預防措施：選購相容 QVL、保留穩定設定檔與備援。
- 難度: 中級
- 學習階段: 進階
- 關聯概念: A-Q20, A-Q22, B-Q13

---

### 學習路徑索引
- 初學者：建議先學習哪 15 題
    - A-Q1: 什麼是 Pentium D 920？
    - A-Q3: 什麼是雙核心（Dual Core）？
    - A-Q4: 雙核心與雙 CPU 有何差異？
    - A-Q5: 什麼是 Intel VT（Virtualization Technology）？
    - A-Q7: 什麼是 EM64T（Intel 64）？
    - A-Q9: 什麼是 Enhanced SpeedStep（EIST）？
    - A-Q11: 為什麼升級到 Windows Server 2003 x64？
    - A-Q12: 32 位與 64 位作業系統的差異？
    - A-Q14: 什麼是 ASP.NET 2.0？
    - A-Q15: 什麼是 Web/SMTP/File Server？
    - A-Q16: 什麼是 VPN 與 NAT？
    - A-Q17: 什麼是影片編碼（DV/DC 轉 WMV）？
    - A-Q18: 什麼是 100M 網路塞爆？
    - A-Q19: 為何要升級到 Gigabit Ethernet（GBE）？
    - A-Q25: 這次升級的核心價值是什麼？

- 中級者：建議學習哪 20 題
    - B-Q1: Intel VT 如何運作？
    - B-Q2: EM64T 的長模式與相容模式如何運作？
    - B-Q4: 雙核心處理器如何分派多執行緒？
    - B-Q5: WoW64 在 x64 上如何運作？
    - B-Q6: ASP.NET 2.0 在 IIS 6 上的處理管線如何運作？
    - B-Q7: SMTP Server 的執行流程為何？
    - B-Q8: File Server 與 SMB/CIFS 的運作機制？
    - B-Q9: VPN 與 NAT 的資料流背後機制？
    - B-Q10: DV/DC 到 WMV 的編碼流程是什麼？
    - B-Q11: 100M 乙太網路的吞吐限制為何？
    - C-Q1: 如何安裝與設定 IIS 6 與 ASP.NET 2.0？
    - C-Q2: 如何啟用 IIS 6 的 32 位應用程式集區？
    - C-Q3: 如何在 x64 上部署 SMTP Server？
    - C-Q4: 如何設定檔案伺服器共享與 NTFS 權限？
    - C-Q5: 如何建置可用 VT 的虛擬機平台？
    - C-Q6: 如何建置 VPN 與 NAT（RRAS）？
    - C-Q7: 如何將 DV/DC 影片轉為 WMV？
    - C-Q8: 如何監測網路吞吐判斷是否塞爆？
    - D-Q1: ASP.NET 網站在 2003 x64 無法載入怎麼辦？
    - D-Q5: 檔案伺服器傳輸速度低於預期如何排查？

- 高級者：建議關注哪 15 題
    - B-Q3: Enhanced SpeedStep（EIST）背後機制是什麼？
    - B-Q12: Gigabit Ethernet 架構與需求為何？
    - B-Q13: 945P 晶片組的架構如何設計？
    - B-Q14: DDR2-533 的頻寬與延遲原理？
    - B-Q15: x64 上的檔案系統與登錄重導向機制？
    - C-Q9: 如何規劃從 100M 升級到 Gigabit？
    - C-Q10: x64 同機承載 32 與 64 位服務的隔離實務
    - D-Q2: 虛擬機顯示不支援 VT 的處理
    - D-Q3: 影片編碼效能不佳的原因與解法
    - D-Q4: SMTP 佇列塞車診斷
    - D-Q6: VPN 無法連線或不穩定的排錯
    - D-Q7: 64 位系統上註冊 32 位元件失敗
    - D-Q8: IIS 工作行程頻繁回收的處理
    - D-Q9: 升級到 GBE 後仍跑不滿速度
    - D-Q10: 升級硬體後系統不穩或藍屏處理