# [Tips] 用 磁碟鏡像 更換硬碟 #2, Windows 2003 的跨距磁區

## 摘要提示
- 磁碟鏡像更換硬碟: 先用 MIRROR 將舊碟資料同步到新碟，再移除鏡像完成更換。
- Windows 2003 延伸磁區: 2003 的 extend volume 可將不同磁碟或分割區併用，形成跨距磁區（類 JBOD）。
- 與 2008/ Vista 差異: 2008 起 extend/shrink 直接調整原分割區容量，不再混合跨碟；跨碟改用 span disk。
- 操作步驟概覽: 建鏡像、完成 Resync、移除鏡像、延伸分割區合併剩餘空間。
- 圖形化操作: 全程於磁碟管理員進行，可視化觀察同步、移除與延伸後的變化。
- 資料安全: 鏡像搬移過程保留資料，新版 extend/shrink 調整容量亦不破壞內容。
- JBOD 概念: 2003 的延伸磁區可跨多顆不同容量的硬碟使用，類似 Just a Bunch Of Disks。
- 新版彈性: 2008/ Vista 引入內建 extend/shrink，省去第三方分割工具的風險與成本。
- 併碟上限: 新版 span disk 最多可將 32 顆硬碟併為單一邏輯磁碟使用。
- 維運心得: 內建工具雖陽春但實用，能安全完成容量調整與硬碟更換。

## 全文重點
作者延續前一篇以內建磁碟鏡像（Mirror）更換硬碟的技巧，這次在 Windows Server 2003 上實作並記錄流程與和 2008/2008 R2（含 Vista）之間的差異。整體方法一致：以舊硬碟（磁碟1）與新硬碟（磁碟2）建立鏡像，待 Resync 完成後移除鏡像，讓系統直接使用新碟上的資料分割。接著針對新碟尚未使用的空間進行延伸，達到容量擴充。

重點差異在於「延伸」的語義與實現方式。Windows 2003 的延伸磁區（extend volume）能把不同硬碟或不同分割區併成一個邏輯磁區來用，磁碟管理員仍可看到原分割區的存在，使用方式和效果很像 JBOD 跨距磁區。從 2008/Vista 開始，extend/shrink 的意義改為直接擴大或縮小「原本的分割區」，僅能利用該分割區後方的連續可用空間，不再用「延伸」去跨不同磁碟；若要跨多碟，則改用「span disk」功能，且可跨至多達 32 顆硬碟。這使得分割區調整更直覺且資料更安全，減少了對第三方分割工具（如 Partition Magic）的依賴。

作者透過實作展示了 2003 的實務流程：先建鏡像、等待同步完成、移除鏡像，再用延伸磁區把新碟剩餘空間納入 D 槽。對比 2008 之後的行為，則是以 extend/shrink 直接調整原分割區容量；若要像 2003 那樣跨多碟，則改採 span disk。作者最後總結，雖然內建工具功能陽春，但已足以完成更換硬碟與容量調整，且風險低、實用性高。

## 段落重點
### 背景與目的：以鏡像更換硬碟的再實作
作者延續前一篇用 Windows 內建鏡像（Mirror）更換硬碟的經驗，這次在 Windows Server 2003 上動手做，目的在於驗證流程並比較不同版本（2008/2008 R2、Vista）之間在延伸/縮小分割區與跨碟組合上的差異。核心思路不變：用鏡像把舊碟資料同步到新碟，移除鏡像後直接用新碟，再把新碟剩餘空間併入現有分割區以擴容。本文也透過多張磁碟管理員的截圖，對照操作前後的狀態，讓步驟更直觀。

### 實作步驟：建立鏡像、同步、移除鏡像、延伸分割區
流程如下：1) 初始狀態下，磁碟1（8GB）為舊硬碟、磁碟2（16GB）為新硬碟；2) 以兩顆磁碟建立鏡像（Mirror），開始 Resync；3) 等待同步完成後，移除鏡像，保留新碟上的資料分割；4) 使用 Windows Server 2003 的延伸磁區功能，將新碟後方未使用空間延伸加入既有的 D 槽。此流程的優點是全程在系統線上完成，資料不需另行備份還原，且可視化監看同步狀態；完成後即達到「更換硬碟＋擴大容量」的目的。

### 2003 的延伸磁區：類 JBOD 的跨距用法
Windows Server 2003 的「延伸磁區」（extend volume）可將兩個不同硬碟或兩個不同分割區併在一起使用，形成跨距磁區；在磁碟管理員中仍能看到原分割區的存在。這種使用方式的概念接近 JBOD（Just a Bunch Of Disks），強調把多個儲存空間拼接成單一邏輯磁區，以獲得更大的連續容量，但並不提供容錯。本文案例即是在完成鏡像搬遷後，利用延伸磁區把新碟多出的空間合併到既有磁區內，使 D 槽容量擴大。

### 2008/Vista 的改變：extend/shrink 與 span disk 的分工
自 Windows Vista/Server 2008 起，系統內建了 extend volume 與 shrink volume 功能，語義變成「直接擴大或縮小原本的分割區」，僅針對分割區後方的可用空間進行調整，不再用「延伸」去跨不同磁碟。若要將多顆硬碟容量拼接成單一邏輯磁碟，則改以「span disk」達成，而且最多能跨到 32 顆硬碟。這樣的分工讓分割區內縮外擴更安全直觀，同時把跨碟拼接的需求獨立成另一種明確的操作，降低誤用風險。

### 維運心得與結語：內建功能已能滿足實務需求
作者指出，以往若要在不重灌的情況下調整分割區大小，常需動用第三方工具（如 Partition Magic），操作時心裡常感不安；而從 Vista/2008 起，系統內建的 extend/shrink 已能涵蓋大部分實務需求。雖然功能相對陽春，卻足以在多數場景安全完成「鏡像更換硬碟＋容量擴充」的任務；2003 的延伸磁區也提供了類 JBOD 的彈性選項。本文記錄實作與差異觀察，期能為讀者在規劃與操作更換硬碟時提供參考與信心。

## 資訊整理

### 知識架構圖
1. 前置知識：學習本主題前需要掌握什麼？
- 基本磁碟概念（磁碟、分割區、檔案系統）
- Windows 磁碟管理（Disk Management）操作
- 動態磁碟與基本磁碟的差異與限制
- 軟體 RAID 概念（特別是鏡像 RAID 1）與 JBOD/Spanned Volumes 風險
- Windows Server 版本差異（2003 vs 2008/Vista 之延伸/縮小/跨距功能）

2. 核心概念：本文的 3-5 個核心概念及其關係
- 軟體鏡像（Mirror/RAID 1）：以兩顆磁碟同步資料，作為資料搬遷與冗餘手段
- 重新同步（Resync）：建立鏡像後的資料同步過程，完成後可安全移除鏡像
- 延伸磁區（Extend Volume）：擴大分割區容量；2003 可跨磁碟延伸，2008/Vista 起改為同磁碟線上擴大
- 跨距磁區/Span（Spanned Volume/JBOD）：將多顆磁碟合併成單一邏輯區，但無冗餘、風險高
- 縮小磁區（Shrink）：2008/Vista 起提供的線上縮小分割區功能

3. 技術依賴：相關技術之間的依賴關係
- 鏡像與跨距磁區均依賴「動態磁碟」功能
- Extend/Shrink 在 2008/Vista 起內建線上操作；2003 的延伸可跨磁碟但性質為「跨距」
- JBOD/Spanned 不提供容錯；若用於擴容需搭配備份策略
- 以鏡像導入新碟後，移除鏡像再進行延伸/跨距是常見更換硬碟流程

4. 應用場景：適用於哪些實際場景？
- 以軟體鏡像在線更換較大容量硬碟，保留原資料
- Windows Server 2003 環境中，以延伸（跨距）方式利用新碟剩餘空間
- Windows Server 2008/Vista 之後，使用 Extend/Shrink 在同一磁碟進行線上調整
- 在無法停機或無外部工具（如 Partition Magic）時的內建工具解決方案
- 暫時性擴容（知道風險前提下）使用 Spanned Volume/JBOD 聚合空間

### 學習路徑建議
1. 入門者路徑：零基礎如何開始？
- 了解基本/動態磁碟、分割區、檔案系統差異
- 熟悉 Windows 磁碟管理介面與基礎操作（建立、刪除、指派代號）
- 在實驗環境練習建立/移除鏡像、觀察 Resync 流程
- 認識 Extend/Shrink 與 Spanned/JBOD 的差異與風險

2. 進階者路徑：已有基礎如何深化？
- 練習以鏡像更換硬碟的完整流程（建立鏡像→Resync→移除鏡像→延伸）
- 在 2003 與 2008/Vista 環境各自實作，體會功能差異
- 探索動態磁碟的限制、相容性與還原策略（含還原到基本磁碟）
- 評估跨距/Spanned 的風險、效能與備援替代方案（RAID、備份）

3. 實戰路徑：如何應用到實際專案？
- 制定更換硬碟 SOP：盤點→備份→建立鏡像→Resync 監控→移除鏡像→擴容→驗證
- 寫出回復計畫（回滾、災難復原、異常中斷時的處置）
- 建立監控與紀錄（事件記錄、鏡像狀態、容量基線）
- 在異質版本混合環境（2003 舊機、2008+ 新機）擬定差異化操作手冊

### 關鍵要點清單
- 軟體鏡像（RAID 1）：用兩顆磁碟同步資料，是更換硬碟時安全搬遷的核心手段 (優先級: 高)
- Resync 監控：鏡像建立後需等待並確認重新同步完成再進行後續操作 (優先級: 高)
- 移除鏡像時機：Resync 完成後移除鏡像，讓新碟成為獨立可用磁碟 (優先級: 高)
- 動態磁碟需求：Windows 的鏡像與跨距/Spanned 功能依賴動態磁碟 (優先級: 高)
- 2003 的延伸磁區：可跨磁碟延伸，本質為跨距（Spanned），非冗餘且有風險 (優先級: 高)
- 2008/Vista Extend/Shrink：提供線上擴大/縮小同一磁碟上的分割區，不等同跨磁碟延伸 (優先級: 高)
- Spanned/JBOD 風險：任一磁碟故障可能導致整個卷毀損，不適合存放關鍵資料 (優先級: 高)
- 擴容策略選擇：需要冗餘選 RAID；僅求容量且可承擔風險才考慮 Spanned (優先級: 中)
- 容量利用：更換到大容量新碟後，透過延伸將未使用空間併入現有分割區 (優先級: 中)
- 版本差異認知：熟悉 2003 與 2008/Vista 在卷管理上的名詞與行為差異 (優先級: 中)
- 無中斷作業：以鏡像搬遷多在不中斷或低中斷情境下完成，適合伺服器 (優先級: 中)
- 外部工具替代：2008/Vista 起多數擴縮容需求可用內建工具，減少第三方風險 (優先級: 中)
- 測試與備份：正式操作前應在實驗環境演練並做完整備份 (優先級: 高)
- 最大跨距數量：Spanned 最多可併 32 顆磁碟，但隨磁碟數增加風險倍增 (優先級: 低)
- 邏輯視圖差異：2003 的延伸後在磁碟管理仍可辨識各分割區段位置 (優先級: 低)