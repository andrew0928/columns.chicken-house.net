# Canon Raw Codec for Vista / XP x64：FAQ

## 問題與答案 (FAQ)

### Q&A 類別 A: 概念理解類

A-Q1: 什麼是 CR2（Canon RAW）檔案？
- A簡: Canon 相機的 RAW 格式，保留感光器原始數據，提供最大後製空間。
- A詳: CR2 是 Canon 相機的 RAW 檔案格式，直接儲存感光器讀出的未經壓縮或近乎無失真處理的數據，常具 12/14 位元位深與廣動態範圍。它包含完整 EXIF/XMP、中小預覽 JPEG、白平衡與相機設定。用途是保留最大後製彈性，在調整曝光、白平衡、銳利度與色彩時劣化最小，適合專業攝影與進階影像處理。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: A-Q9, A-Q19, B-Q7

A-Q2: 什麼是編解碼器（Codec）？
- A簡: 在系統中解析與產生特定媒體格式的軟體元件。
- A詳: 編解碼器是提供媒體格式讀寫能力的組件。影像編解碼器能把檔案格式（如 CR2、JPEG）解譯為應用程式可用的像素資料，或把像素壓縮存回檔案。在 Windows 中，影像 Codec 常以 WIC 外掛呈現，讓 Explorer、相片檢視器、WPF/.NET 等統一透過平台 API 使用，而不需各程式內建各式解碼器。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: A-Q3, B-Q1, B-Q14

A-Q3: 什麼是 Windows Imaging Component（WIC）？
- A簡: Windows 的影像平台，透過外掛 Codec 支援多格式。
- A詳: WIC 是 Microsoft 在 Windows 引入的影像平台（Vista 內建，XP 需額外安裝），提供統一 API 與擴充模型。各式影像格式支援以外掛 Codec（COM 元件）註冊後，即可被 Explorer、Windows Photo Viewer、WPF、UWP 等使用。它也包含中介格式、色彩管理、Metadata 查詢等能力，形成系統層級的影像生態。
- 難度: 中級
- 學習階段: 基礎
- 關聯概念: B-Q1, B-Q8, A-Q12

A-Q4: 為什麼在 Vista/XP x64 需要 CR2 Codec？
- A簡: 讓 Explorer、相簿與應用能顯示縮圖、預覽與讀取 CR2。
- A詳: 沒有對應的 CR2 Codec 時，系統與多數應用無法直接顯示 CR2 的縮圖、預覽與讀取 Metadata。安裝相符位元數的 WIC Codec 後，Vista/XP x64 的 Explorer、相片檢視器與 WPF/.NET 便能原生使用 CR2，提升瀏覽效率與管理體驗，無須每次開啟專用轉檔器才能快速篩選照片。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: A-Q5, A-Q11, B-Q3

A-Q5: x86 與 x64 Codec 有何差異？
- A簡: 位元數需與主程式相同；64 位程式不能載入 32 位 Codec。
- A詳: 影像 Codec 是 DLL，必須由同位元數的主程式載入。64 位元的 Explorer 或 WPF 程式只能載入 x64 Codec；32 位元應用（在 WOW64 下）只能載入 x86 Codec。兩者可同機並存、各自服務對應位元的應用；若只安裝 x86 版本，64 位元殼層仍無法預覽。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q6, A-Q11, B-Q4

A-Q6: 什麼是 WOW64？為何與本議題相關？
- A簡: 64 位 Windows 的 32 位相容層，可跑 x86 程式但不跨載入。
- A詳: WOW64（Windows-on-Windows 64）讓 64 位 Windows 能執行 32 位應用，透過 API 轉譯與檔案/登錄重導。然而它不提供跨位元 DLL 載入能力，因此 64 位 Explorer 不能載入 32 位 Codec。此限制解釋了為何在 x64 系統常需同時安裝 x86 與 x64 兩版 Codec，供不同位元應用使用。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q5, A-Q11, B-Q5

A-Q7: Canon 官方 RAW Codec 與第三方 Codec 差異？
- A簡: 官方著重相容與品牌整合；第三方更新快、常付費。
- A詳: 官方 Codec 通常與自家相機與軟體（如 DPP）緊密整合，品質與相容性有保障，但歷史上 Canon 對 x64 的 WIC 支援有限。第三方（如 Ardfry）往往更新較快、支援較廣，但多為付費授權。選擇時須看機型支援、位元數、更新頻率與成本。
- 難度: 初級
- 學習階段: 核心
- 關聯概念: A-Q8, A-Q16, B-Q7

A-Q8: Ardfry CR2 Codec 是什麼？收費如何？
- A簡: 第三方 CR2 WIC 編解碼器，售約 29.95 美元，曾有預購價。
- A詳: Ardfry Imaging 提供的 CR2 Codec 是一款針對 Windows 的 WIC 外掛，安裝後系統可原生顯示 CR2 縮圖與預覽。該產品非 Canon 官方，屬商業授權，定價約 29.95 美元（早期曾有預購價）。它的價值在補足 Vista/XP x64 時期官方支援的空白，便利照片管理。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: A-Q7, C-Q1, D-Q2

A-Q9: RAW 與 JPEG 的差異？
- A簡: RAW 保留更多位深與動態範圍；JPEG 已壓縮、體積小。
- A詳: RAW（如 CR2）保存感光器原始資料，具有較高位深與後製彈性；JPEG 為有損壓縮的 8 位格式，體積小、相容性高但調整空間有限。工作流程上，RAW 適合精修與色彩調整，JPEG 適合快速分享與紀錄。是否需要系統層預覽 RAW，取決於你的選片與管理需求。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: A-Q1, A-Q10, A-Q19

A-Q10: RAW 轉檔器與 WIC Codec 差異？
- A簡: 轉檔器生成新檔；WIC Codec 供系統預覽與存取資料。
- A詳: 轉檔器（如 DPP、Adobe Camera Raw）專注於色彩解譯、調整與輸出（JPEG/TIFF/PSD 等），屬創作流程工具；WIC Codec 則是平台功能，讓殼層與應用能讀取縮圖、預覽與 Metadata，而不一定提供高階調整。兩者互補：管理靠 Codec，精修靠轉檔器。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: A-Q3, A-Q7, B-Q13

A-Q11: 為什麼 64 位 Explorer 不能用 32 位 Codec？
- A簡: 進程與 DLL 位元數需一致，跨位元載入不被支援。
- A詳: Explorer 作為 64 位行程時，載入的 Shell 擴充與 WIC Codec 也必須是 64 位。32 位 DLL 的記憶體模型、指令集與呼叫規約與 x64 不相容，Windows 不允許跨位元載入。解法是安裝對應 x64 Codec，或改用 32 位宿主程式在 WOW64 下使用 x86 Codec。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q5, A-Q6, B-Q4

A-Q12: Vista 與 XP 在影像支援上的差異？
- A簡: Vista 內建 WIC；XP 需安裝 WIC Runtime 後才支援。
- A詳: Vista 起內建 WIC，安裝對應 Codec 即可在殼層與應用使用。XP（含 XP x64）原生無 WIC，需要先安裝 WIC Runtime 或相關平台更新，才能讓系統識別並載入 WIC Codec。這差異影響部署步驟與相依元件，亦解釋 XP 下常見的安裝先後順序問題。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: B-Q6, C-Q2, D-Q3

A-Q13: 何謂殼層整合（Shell Integration）？
- A簡: 將格式支援與縮圖、預覽、屬性頁整合進 Explorer。
- A詳: 殼層整合是在 Explorer 與系統相簿中，透過外掛實作縮圖提供者、預覽處理器與屬性處理器，使特定格式（如 CR2）能顯示縮圖、投影片與詳細拍攝資訊。WIC Codec 是其中關鍵，配合 Metadata 處理讓搜尋與排序更有效。良好整合提升選片與管理效率。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: B-Q3, B-Q8, B-Q9

A-Q14: 什麼是縮圖快取？有何價值？
- A簡: 系統緩存已解碼縮圖，加速再次瀏覽與搜尋效率。
- A詳: 縮圖快取會將已產生的縮圖儲存在磁碟與資料庫中，後續進入同一資料夾時直接載入，免去重新解碼 RAW 的成本。對大量 RAW 管理特別重要，能顯著減少 I/O 與 CPU 使用。配合預先產生（預暖）與穩定的 Codec，可獲得流暢瀏覽體驗。
- 難度: 初級
- 學習階段: 核心
- 關聯概念: B-Q9, B-Q11, C-Q7

A-Q15: 為何有人願意付費買 CR2 Codec？
- A簡: 省時高整合，免開專用軟體即可快速瀏覽管理 RAW。
- A詳: 有償 Codec 在沒有官方支援的年代能立即解決痛點：Explorer 縮圖、快速預覽、Metadata 檢視與搜尋，直接融入既有工作流程。此外，第三方往往快速支援新機型、提供穩定更新。相較每次啟動轉檔器選片，Codec 帶來顯著時間成本節省。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: A-Q8, A-Q20, C-Q5

A-Q16: 為何廠商未必提供 x64 RAW Codec？
- A簡: 維護成本高、平台碎片化，轉向自家軟體或通用包。
- A詳: 維護 x86/x64 雙版本、跟進新機 CR2 變體與相容性測試，成本不小。部分廠商轉而推自家轉檔軟體（如 DPP）或依賴作業系統的通用相機 Codec 套件（如後來的 Microsoft Camera Codec Pack）。因此在 Vista/XP x64 時代常見需倚賴第三方解決方案。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q7, A-Q20, B-Q25

A-Q17: 哪些程式會用到 WIC Codec？
- A簡: Explorer、相片檢視器、WPF/.NET、部分第三方圖庫。
- A詳: 任何以 WIC 為影像後端的程式都會使用已安裝的 Codec，包括 Windows Explorer 縮圖、Windows Photo Viewer/相片應用預覽、Microsoft Office 圖片插入、WPF/.NET 的 BitmapDecoder，以至支援 WIC 的第三方圖庫工具。位元數相容時，即可共享系統級解碼能力。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: B-Q1, B-Q14, C-Q7

A-Q18: XP x64 與 Vista x64 上 CR2 支援路徑不同？
- A簡: Vista 直接裝 x64 Codec；XP 先裝 WIC 再裝相符位元。
- A詳: Vista x64 內建 WIC，流程簡化為安裝對應 x64（必要時加裝 x86）Codec、重新登入即可。XP x64 需先更新系統與安裝 WIC Runtime（或 Platform Update），再安裝 Codec。兩者皆須留意位元數對齊與重新啟動殼層以生效。
- 難度: 初級
- 學習階段: 核心
- 關聯概念: A-Q12, C-Q1, C-Q2

A-Q19: 什麼是內嵌預覽 JPEG？對瀏覽有何幫助？
- A簡: RAW 檔內的小圖/大圖 JPEG，可快速顯示縮圖與預覽。
- A詳: 多數 RAW 檔（含 CR2）內嵌一張或多張 JPEG 縮圖/預覽，供相機與軟體快速顯示。WIC Codec 可優先提取內嵌預覽以加速顯示，必要時才完全解碼 RAW。此設計在大量檔案瀏覽時大幅提升流暢度，惟顏色與銳利度依相機生成，與最終解碼可能略有差異。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: B-Q13, B-Q2, C-Q6

A-Q20: 如果沒有官方 x64 Codec，還有哪些替代？
- A簡: 第三方 WIC、改用 DPP/Adobe、轉 DNG、或相機 Codec 包。
- A詳: 無官方 x64 時，可選第三方 Codec（如 Ardfry）、改用相機廠商轉檔軟體（DPP）或 Adobe/開源軟體處理；也可先批次轉 DNG 以獲得系統與軟體更廣支援。較新系統可安裝 Microsoft Camera Codec Pack（支援多品牌 RAW），視作業系統版本而定。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: A-Q7, C-Q9, D-Q4

### Q&A 類別 B: 技術原理類

B-Q1: WIC Codec 在 Windows 中如何運作？
- A簡: 透過 COM 註冊，向殼層與應用提供解碼/編碼服務。
- A詳: WIC 以 COM 元件模型實作解碼器/編碼器、格式轉換與 Metadata 介面。Codec 以 CLSID 註冊，Explorer 或應用透過 IWICImagingFactory 建立相對應的解碼器，取得像素流、縮圖與 Metadata。此架構解耦應用與格式，藉由外掛擴充即可支援新相機 RAW。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q3, B-Q8, B-Q14

B-Q2: CR2 影像解碼流程為何？
- A簡: 解析標頭→讀取元資料→解壓影像→色彩轉換→輸出。
- A詳: 解碼一般流程包括：讀取 CR2 容器與 TIFF 標籤、解析 EXIF/XMP、擷取內嵌縮圖（若可）、解壓 RAW（無損/有損）、去馬賽克（Demosaic）、套用黑階/白平衡、色彩空間轉換（至 sRGB/Adobe RGB/線性）、Gamma 校正，最後輸出像素或縮圖供殼層顯示與快取。
- 難度: 高級
- 學習階段: 進階
- 關聯概念: A-Q1, B-Q13, D-Q5

B-Q3: Explorer 顯示縮圖的執行流程？
- A簡: 查快取→若無則呼叫 WIC→產生縮圖→寫入快取。
- A詳: Explorer 先查詢縮圖快取；如未命中則透過 WIC 解析檔案、提取內嵌預覽或縮解原圖生成指定尺寸縮圖。生成後寫入快取（含雜湊與時間戳），後續重用。若同資料夾大量 RAW，系統會分批背景產生縮圖，以平衡即時性與效能。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q14, B-Q9, C-Q7

B-Q4: 為何主程式位元數需與 Codec 一致？
- A簡: 同進程 DLL 載入限制，避免 ABI/指令集不相容。
- A詳: Windows 不支援在同一進程混載不同位元 DLL。x64 進程的指標寬度、呼叫慣例、暫存器使用與記憶體配置與 x86 不同，強行載入會崩潰。因此殼層或應用需載入同位元 Codec。解法是在 x64 系統同裝 x86/x64 兩版，供各自位元應用取用。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q5, A-Q11, D-Q9

B-Q5: WOW64 的技術機制是什麼？
- A簡: 以分層子系統攔截 API，提供 x86 環境與檔案重導。
- A詳: WOW64 提供 x86 子系統，攔截系統呼叫與路徑，將 System32/登錄鍵重導至 SysWOW64/Wow6432Node，讓 32 位應用可在 x64 OS 執行。它不轉譯 DLL 位元數，因此無法讓 x64 進程載入 x86 Codec，只能讓 x86 應用載入 x86 Codec 自行使用。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q6, A-Q11, C-Q3

B-Q6: XP 為何需安裝 WIC Runtime？
- A簡: XP 無內建 WIC，需額外元件支援新影像格式。
- A詳: WIC 自 Vista 起內建，XP（含 XP x64）並未包含該平台。要讓 XP 殼層或應用支援 WIC Codec，必須先安裝 WIC Runtime 或相關平台更新，提供核心 API 與元件註冊能力，之後安裝第三方 Codec 才能被系統辨識與呼叫。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: A-Q12, C-Q2, D-Q3

B-Q7: 不同 CR2 版本為何會不相容？
- A簡: 機型差異與壓縮參數不同，需更新對應解碼器。
- A詳: CR2 是容器規格，但各機型的感光器排列、位深、壓縮方法與 Metadata 標記可能不同。新機推出時，解碼器需更新以支援新參數與 Demosaic 流程。這也是第三方或官方 Codec 需頻繁更新的原因，否則會出現無法預覽或顏色錯誤。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: D-Q4, A-Q1, A-Q7

B-Q8: WIC 如何處理 EXIF/XMP/ICC 色彩資訊？
- A簡: 透過 Metadata 介面與色彩管線，統一讀寫與轉換。
- A詳: WIC 暴露 Metadata Query Reader/Writer 供讀寫 EXIF/XMP 標籤，並透過色彩管理（ICM/WCS）套用 ICC profile 或相機色彩矩陣進行色彩轉換。Codec 需正確填供像素格式與 Profile，應用即可獲得正確顏色與可搜尋的拍攝資訊。
- 難度: 高級
- 學習階段: 進階
- 關聯概念: B-Q2, D-Q5, A-Q13

B-Q9: 縮圖快取如何運作與存放？
- A簡: 以資料庫與檔案儲存縮圖，依雜湊與時間戳管理。
- A詳: Windows 的縮圖快取以資料庫/檔案對應檔案雜湊與尺寸存放縮圖，當原檔變更或快取清理時失效重建。快取可預先生成（例如先滾動瀏覽），可顯著提升大量 RAW 瀏覽速度。清理工具可能清空快取，需重新生成。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q14, C-Q7, D-Q6

B-Q10: 安全性：殼層載入 Codec 的風險與防護？
- A簡: 第三方碼被 Explorer 載入，需簽章、隔離與白名單。
- A詳: Explorer 會載入第三方 DLL，若 Codec 品質不佳或遭竄改，可能造成崩潰或安全風險。風險緩解包含：僅安裝簽章來源、定期更新、最小化外掛數量、限制網路磁碟自動預覽、使用受限帳號。企業可用群組原則禁用預覽處理器。
- 難度: 中級
- 學習階段: 進階
- 關聯概念: D-Q10, D-Q7, D-Q8

B-Q11: 效能優化：解碼取樣與多執行緒？
- A簡: 以縮小取樣、管線並行與快取減少重複解碼。
- A詳: 解碼器可採用下採樣（直接輸出目標縮圖尺寸）、批次處理與多執行緒並行讀取/解壓，以提升速度。結合縮圖快取與內嵌預覽策略，避免對每張 RAW 完整解碼。儲存於 SSD、關閉即時掃描也可降低 I/O 與 CPU 負荷。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: B-Q3, B-Q9, D-Q6

B-Q12: 方向標記與自動旋轉的處理機制？
- A簡: 讀取 EXIF Orientation，輸出時套用矩陣旋轉。
- A詳: 相機記錄 EXIF Orientation 標記以標示拍攝朝向。WIC 解碼後可在輸出縮圖/預覽時按標記旋轉，或讓應用於顯示時處理。若忽略標記，會看到「橫豎顛倒」。正確處理需讀取 Metadata 並在像素變換階段應用旋轉與轉置。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: B-Q8, D-Q1, D-Q5

B-Q13: 內嵌 JPEG 與完全解碼的取捨？
- A簡: 先取內嵌圖快，品質受限；完整解碼品質高較慢。
- A詳: 取用內嵌預覽可極速顯示，但其色調與銳利度依相機演算法，且尺寸有限。完全解碼可最佳化色彩與細節，適合放大檢視或精準選片。實務常採混合策略：列表用內嵌，打開預覽窗時再完整解碼以兼顧速度與品質。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q19, B-Q2, D-Q6

B-Q14: WPF/.NET 如何依賴 WIC 讀取 CR2？
- A簡: BitmapDecoder 透過 WIC 呼叫對應 Codec 取像。
- A詳: 在 .NET（WPF）中，BitmapDecoder/BitmapFrame 由 WIC 支援。只要系統已裝對應 CR2 Codec，程式可用 BitmapDecoder.Create(Uri, …) 取得影像/縮圖/Metadata。若缺少或位元數不符則解碼失敗，需安裝相符 Codec 或改為 x86 目標。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q17, C-Q7, D-Q9

### Q&A 類別 C: 實作應用類（10題）

C-Q1: 如何在 Vista x64 安裝 Ardfry CR2 Codec？
- A簡: 下載 x64 安裝檔、關閉殼層、安裝後重新登入並驗證縮圖。
- A詳: 具體步驟：1) 前往供應商頁面下載 x64 版本安裝檔。2) 關閉可能開啟檔案總管的視窗。3) 以系統管理員安裝。4) 登出或重開機，確保 Explorer 重新載入外掛。5) 開啟含 CR2 的資料夾，切換為大型圖示驗證縮圖。注意：若需 x86 應用也能用，另裝 x86 版本。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: A-Q8, A-Q11, D-Q1

C-Q2: 如何在 XP x64 啟用 WIC 並安裝 CR2 Codec？
- A簡: 先裝 WIC Runtime/平台更新，再安裝相符位元 Codec。
- A詳: 具體步驟：1) 以 Windows Update 或微軟下載中心安裝 WIC Runtime（XP 不內建）。2) 確認系統服務包更新到最新。3) 安裝 x64 版 CR2 Codec（必要時再裝 x86 版供 32 位應用）。4) 重新登入驗證 Explorer 縮圖。注意：舊平台可能需 VC++ Redistributable。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: A-Q12, B-Q6, D-Q3

C-Q3: 如何用 WOW64 在 64 位系統使用 32 位應用預覽 CR2？
- A簡: 安裝 x86 Codec，改用 32 位相簿/檢視器開啟 CR2。
- A詳: 步驟：1) 於 x64 系統額外安裝 x86 版 CR2 Codec。2) 使用 32 位應用（如 Windows Live Photo Gallery x86 或第三方 32 位看圖軟體）開啟 CR2；它們會載入 x86 Codec。3) 若需在檔案總管選片，改用 32 位相片管理器而非 64 位 Explorer。注意：x64 Explorer 仍需 x64 Codec。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q6, A-Q11, B-Q5

C-Q4: 如何在 64 位系統讓 32 位與 64 位程式皆可用 Codec？
- A簡: 同時安裝 x86 與 x64 兩版 Codec，供各自位元程式載入。
- A詳: 做法：1) 先安裝 x64 版，供 Explorer/WPF x64 使用。2) 追加安裝 x86 版，供 32 位相片應用（在 WOW64 下）使用。3) 測試兩類應用是否可預覽 CR2。注意：兩版通常為不同安裝包；更新時維持兩邊同步，避免某些應用無法解析新機型。
- 難度: 初級
- 學習階段: 核心
- 關聯概念: A-Q5, D-Q2, D-Q9

C-Q5: 如何評估第三方 Codec 是否值得購買？
- A簡: 檢查機型支援、位元數、更新與試用體驗與成本。
- A詳: 評估清單：1) 支援你的相機機型與 RAW 版本。2) 提供 x86/x64 雙版。3) 更新頻率與升級政策。4) 安裝後 Explorer 縮圖/預覽是否流暢。5) 與現有相片工作流程相容性。6) 價格與授權。建議先試用、再決定購買。必要時與 DPP/Adobe 流程比較效率。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: A-Q7, A-Q15, D-Q4

C-Q6: 如何建立縮圖快取來加速 CR2 瀏覽？
- A簡: 使用大型圖示瀏覽整批檔案，讓系統預先產生快取。
- A詳: 步驟：1) 在 Explorer 切換至大型或超大型圖示。2) 進入含大量 CR2 的資料夾，緩慢滾動讓縮圖逐步生成。3) 保持電源與散熱，等待快取完成。4) 之後再訪同資料夾會明顯加速。注意：清理工具可能刪快取；防毒即時掃描也會拖慢生成速度。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: A-Q14, B-Q9, D-Q6

C-Q7: 如何在 .NET/WPF 程式裡讀取 CR2？
- A簡: 安裝對應 Codec 後，用 BitmapDecoder 建立影像框架。
- A詳: 步驟：1) 確認系統已裝可用 CR2 Codec（位元數需與程式 PlatformTarget 一致）。2) WPF 程式碼示例：
  C#:
  var dec = BitmapDecoder.Create(new Uri(path), BitmapCreateOptions.None, BitmapCacheOption.OnDemand);
  var frame = dec.Frames[0];
  3) 讀 Metadata：frame.Metadata。注意：若解碼失敗，檢查位元數與相機支援。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: B-Q14, D-Q9, A-Q17

C-Q8: 如何在沒有 Codec 的情況快速瀏覽 CR2？
- A簡: 利用內嵌預覽 JPEG 或使用專用相片軟體與轉 DNG。
- A詳: 方法：1) 用支援內嵌預覽的看圖工具（FastStone/ExifTool）。2) 以命令擷取預覽：
  exiftool -b -PreviewImage input.CR2 > preview.jpg
  3) 使用 DPP/Adobe Bridge 等軟體瀏覽。4) 批次轉 DNG 取得更廣支援。注意：內嵌預覽顏色取決於相機處理，不等同完整解碼品質。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: A-Q19, B-Q13, D-Q1

C-Q9: 如何確定系統已成功載入 CR2 Codec？
- A簡: 測試 Explorer 縮圖與以 WPF 解碼一張 CR2 檔。
- A詳: 驗證：1) 在 Explorer 切大型圖示，檢查 CR2 是否顯示縮圖。2) 用 Windows Photo Viewer/相片應用打開預覽。3) 在 WPF 測試 BitmapDecoder 是否能讀 Frames。若 x64 成功、x86 失敗，代表缺 x86 版。若皆失敗，檢查是否安裝 WIC（XP）與機型支援。
- 難度: 初級
- 學習階段: 核心
- 關聯概念: C-Q7, A-Q5, D-Q2

C-Q10: 如何備份與移轉已安裝的 Codec？
- A簡: 保存原安裝包與授權資訊，於新機重裝相符位元版本。
- A詳: 步驟：1) 保存 Codec 安裝檔與序號/授權檔。2) 在新機先完成系統前置（Vista 內建 WIC；XP 需裝 WIC Runtime）。3) 依需安裝 x64 與 x86 兩版。4) 重新登入並驗證。注意：直接複製 DLL/登錄易導致相容性問題，建議使用原安裝程式。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: A-Q12, C-Q1, C-Q2

### Q&A 類別 D: 問題解決類（10題）

D-Q1: Vista x64 看不到 CR2 縮圖怎麼辦？
- A簡: 安裝 x64 CR2 Codec，重啟殼層；或改用 32 位應用預覽。
- A詳: 症狀：Explorer 顯示通用圖示無縮圖。原因：未裝 x64 Codec、安裝錯位元或快取未建立。解法：1) 安裝 x64 CR2 Codec（必要時加裝 x86 版）。2) 登出重啟殼層。3) 切大型圖示讓系統建快取。4) 若仍無法，改用 32 位相片應用測試。預防：更新 Codec，維持兩版一致。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: A-Q4, A-Q11, C-Q1

D-Q2: 安裝 Ardfry Codec 後仍無法在某些程式預覽？
- A簡: 可能位元數不符或程式未使用 WIC；裝對應版本。
- A詳: 症狀：部分程式可預覽、部分不行。原因：該程式是 32 位卻只有 x64 Codec；或程式使用自帶解碼器不支援該機型。解法：1) 於 x64 系統同時安裝 x86/x64 Codec。2) 確認程式是否支援 WIC。3) 更新程式與 Codec。預防：部署前盤點應用位元數與相依。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q5, C-Q4, C-Q9

D-Q3: XP x64 安裝 WIC/Codec 後 Explorer 當掉怎麼辦？
- A簡: 檢查系統更新、安裝順序與相容版本，必要時回溯。
- A詳: 症狀：開資料夾即閃退/無回應。原因：舊系統缺補丁、WIC 版本衝突、老舊 Codec 不相容。解法：1) 補齊 SP 與 WIC Runtime。2) 卸載衝突外掛，重新安裝相容版本。3) 暫停預覽（切換至詳細清單），逐步排除。預防：優先測試環境驗證後再部署。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q12, C-Q2, B-Q10

D-Q4: 新款相機 CR2 無法解析怎麼辦？
- A簡: 更新 Codec 或改用 DPP/Adobe；暫時轉 DNG。
- A詳: 症狀：新機 CR2 無縮圖/顯示錯誤。原因：Codec 未支援該 CR2 變體。解法：1) 更新到支援該機型的 Codec 版本。2) 改用 Canon DPP 或 Adobe Camera Raw/Bridge。3) 以 Adobe DNG Converter 暫轉 DNG 供瀏覽。預防：購買前確認支援清單與更新策略。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: B-Q7, A-Q20, C-Q5

D-Q5: 預覽顏色不正確或曝光怪異的原因？
- A簡: 可能忽略 ICC/白平衡或用到內嵌預覽導致差異。
- A詳: 症狀：縮圖顏色偏移、對比怪異。原因：內嵌預覽與完整解碼差異、顯示器 ICC/系統色彩管理不當、Codec 未正確套用白平衡/黑階。解法：更新 Codec、校正顯示器、改用完整解碼預覽。預防：開啟色彩管理、使用可靠 Codec 與一致工作色域。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: B-Q8, B-Q13, B-Q2

D-Q6: 解碼或產生縮圖很慢怎麼優化？
- A簡: 使用內嵌預覽、預先建快取、更新 Codec 與儲存裝置。
- A詳: 症狀：瀏覽延遲、CPU 飆高。原因：每張皆完整解碼、快取缺失、硬碟/AV 掃描瓶頸。解法：1) 讓系統先滾動生成縮圖快取。2) 啟用內嵌預覽策略。3) 存放於 SSD，暫停即時防毒掃描照片資料夾。4) 更新 Codec 至最佳化版本。預防：分批整理、維持快取。
- 難度: 初級
- 學習階段: 核心
- 關聯概念: B-Q11, B-Q9, A-Q14

D-Q7: WOW64 環境下影像程式不穩定或崩潰？
- A簡: 可能外掛衝突或位元混用；統一位元與更新外掛。
- A詳: 症狀：32 位相片程式在 x64 OS 間歇崩潰。原因：舊版外掛/解碼器衝突、記憶體限制、與 x64 外掛誤混載（少見）。解法：停用非必要外掛、升級至相容版本、降低同時預覽數。預防：維持 x86 應用僅載入 x86 外掛，定期健康檢查。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: B-Q5, D-Q8, C-Q3

D-Q8: 安裝多個 Codec 造成衝突如何處理？
- A簡: 保留一套主要 Codec，移除重疊者並重建快取。
- A詳: 症狀：預覽不穩或顯示不一。原因：多個 Codec 註冊處理同格式，載入順序或 CLSID 導致行為不一致。解法：保留信任度高的主要 Codec，卸載其他。清理縮圖快取並重建。預防：避免安裝重複支援同格式的多套外掛。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: B-Q10, C-Q1, C-Q2

D-Q9: 無法在 64 位 WPF 程式讀取 CR2？
- A簡: 缺 x64 Codec 或目標平台不符；裝對應版或改 x86。
- A詳: 症狀：BitmapDecoder 拋例外或 Frames 為空。原因：系統無 x64 CR2 Codec、應用以 AnyCPU 跑成 x64、或相機型號未支援。解法：安裝 x64 Codec；或將程式 PlatformTarget 設為 x86 使用 x86 Codec。預防：部署前確認位元數與機型支援。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: B-Q14, A-Q5, C-Q7

D-Q10: 第三方 Codec 的安全風險與防範？
- A簡: 僅用可信來源、保持更新、限制自動預覽與權限。
- A詳: 風險：惡意或漏洞外掛被 Explorer 載入，可能導入執行風險。防範：1) 僅安裝簽章且可信供應商版本。2) 定期更新與移除未用外掛。3) 限制網路路徑自動預覽。4) 使用標準帳號操作。企業可用群組原則停用特定預覽處理器。
- 難度: 中級
- 學習階段: 進階
- 關聯概念: B-Q10, D-Q8, C-Q5

### 學習路徑索引
- 初學者：建議先學習哪 15 題
    - A-Q1: 什麼是 CR2（Canon RAW）檔案？
    - A-Q2: 什麼是編解碼器（Codec）？
    - A-Q3: 什麼是 Windows Imaging Component（WIC）？
    - A-Q4: 為什麼在 Vista/XP x64 需要 CR2 Codec？
    - A-Q5: x86 與 x64 Codec 有何差異？
    - A-Q8: Ardfry CR2 Codec 是什麼？收費如何？
    - A-Q9: RAW 與 JPEG 的差異？
    - A-Q10: RAW 轉檔器與 WIC Codec 差異？
    - A-Q12: Vista 與 XP 在影像支援上的差異？
    - A-Q14: 什麼是縮圖快取？有何價值？
    - A-Q15: 為何有人願意付費買 CR2 Codec？
    - A-Q17: 哪些程式會用到 WIC Codec？
    - C-Q1: 如何在 Vista x64 安裝 Ardfry CR2 Codec？
    - C-Q2: 如何在 XP x64 啟用 WIC 並安裝 CR2 Codec？
    - D-Q1: Vista x64 看不到 CR2 縮圖怎麼辦？
- 中級者：建議學習哪 20 題
    - A-Q6: 什麼是 WOW64？為何與本議題相關？
    - A-Q11: 為什麼 64 位 Explorer 不能用 32 位 Codec？
    - A-Q13: 何謂殼層整合（Shell Integration）？
    - A-Q18: XP x64 與 Vista x64 上 CR2 支援路徑不同？
    - A-Q19: 什麼是內嵌預覽 JPEG？對瀏覽有何幫助？
    - A-Q20: 如果沒有官方 x64 Codec，還有哪些替代？
    - B-Q1: WIC Codec 在 Windows 中如何運作？
    - B-Q3: Explorer 顯示縮圖的執行流程？
    - B-Q4: 為何主程式位元數需與 Codec 一致？
    - B-Q6: XP 為何需安裝 WIC Runtime？
    - B-Q7: 不同 CR2 版本為何會不相容？
    - B-Q11: 效能優化：解碼取樣與多執行緒？
    - B-Q13: 內嵌 JPEG 與完全解碼的取捨？
    - B-Q14: WPF/.NET 如何依賴 WIC 讀取 CR2？
    - C-Q3: 如何用 WOW64 在 64 位系統使用 32 位應用預覽 CR2？
    - C-Q4: 如何在 64 位系統讓 32 位與 64 位程式皆可用 Codec？
    - C-Q7: 如何在 .NET/WPF 程式裡讀取 CR2？
    - C-Q9: 如何確定系統已成功載入 CR2 Codec？
    - D-Q2: 安裝 Ardfry Codec 後仍無法在某些程式預覽？
    - D-Q6: 解碼或產生縮圖很慢怎麼優化？
- 高級者：建議關注哪 15 題
    - B-Q2: CR2 影像解碼流程為何？
    - B-Q5: WOW64 的技術機制是什麼？
    - B-Q8: WIC 如何處理 EXIF/XMP/ICC 色彩資訊？
    - B-Q9: 縮圖快取如何運作與存放？
    - B-Q10: 安全性：殼層載入 Codec 的風險與防護？
    - C-Q5: 如何評估第三方 Codec 是否值得購買？
    - C-Q8: 如何在沒有 Codec 的情況快速瀏覽 CR2？
    - C-Q10: 如何備份與移轉已安裝的 Codec？
    - D-Q3: XP x64 安裝 WIC/Codec 後 Explorer 當掉怎麼辦？
    - D-Q4: 新款相機 CR2 無法解析怎麼辦？
    - D-Q5: 預覽顏色不正確或曝光怪異的原因？
    - D-Q7: WOW64 環境下影像程式不穩定或崩潰？
    - D-Q8: 安裝多個 Codec 造成衝突如何處理？
    - D-Q9: 無法在 64 位 WPF 程式讀取 CR2？
    - D-Q10: 第三方 Codec 的安全風險與防範？