# 偷偷升級到 CS2007 ..

## 摘要提示
- 升級時間: 兩週前網站已默默完成由 CS2.x 到 CS2007 的升級。
- 外觀維持: 升級後立即調回舊面板，整體外觀與舊版幾乎一致，因此少有人察覺。
- 升級流程: 主要只需執行資料庫升級與檔案覆蓋兩步，即可完成核心升級。
- 樣版系統改變: CS2007 捨棄大量動態載入 UserControl 的做法，改用標準 ASP.NET 2.0 master page 架構。
- 編輯便利性: 新版以 theme.master 與 theme.config 為中心，單頁面對應單一 .aspx，維護大幅簡化。
- 自訂控制項: 舊 API 部分失效，趁機全面重寫為 .ascx + .cs，避免再產生 DLL。
- 部署效率: 不需編譯 DLL，直接丟置 .ascx 檔即可，部署快速便利。
- 新功能尚待探索: 目前尚未深入研究 CS2007 內建新功能，但平台已完成升級並可隨時使用。

## 全文重點
作者在兩週前悄悄地將網站由 Community Server 2.x 升級至 CS2007，為避免使用者一眼看出改版，升級後立即將版面樣式調回舊設定，因此大多讀者並未察覺變動。升級本身相當簡潔，只需進行資料庫結構升級並覆蓋新版檔案即可；真正花時間的部分為作者先前自行客製的 theme 與多個 User Control。  
在樣版系統方面，過去 CS 1.0 至 2.x 長期採用大量動態載入 UserControl 的方式來組合頁面，版面配置深埋在控制項標籤之中，資料與邏輯則寫在程式碼後置檔，導致客製化時常需先理解呼叫鏈才能定位需要修改的位置。CS2007 終於全面採用 ASP.NET 2.0 標準模式：每套樣版由一組 master page（theme.master）與設定檔（theme.config）構成，而各頁面本身就是單純的 .aspx 檔。這種結構讓開發者不用再在 UserControl 叢林中尋寶，任何版面需求都能直接於 master page 與對應 .aspx 上處理，開發與維護效率大幅提升。  
另一方面，由於新版 API 與舊版並非完全相容，作者原先客製的幾個 User Control 有部分方法無法再使用；於是趁此升級時機，索性將它們全部重寫為 .ascx + .cs 形式並直接置於網站根目錄。過去為了封裝功能得額外產生 DLL，如今改用原生 .ascx 控制項即可，部署流程更加輕量，也省去重新編譯的麻煩。  
至於 CS2007 帶來的其他新功能，作者尚未深入測試，不過在完成基礎環境升級與客製元件移植之後，整體平台已經就緒，日後可視需求再逐一開啟與研究。

## 段落重點
### 升級至 CS2007 的過程
作者於兩週前低調地將網站從舊版 CS 升級到 CS2007，升級操作主要包含資料庫升級與檔案覆蓋兩步，完成後立即將面板切回舊樣式，故大多訪客未察覺任何異動。

### 樣版系統由動態 UserControl 轉向 Master Page
舊版 CS 依賴大量動態載入 UserControl 的做法，客製化時需穿梭於控制項與程式碼間。CS2007 改採 ASP.NET 2.0 標準 master page 架構，每套 theme 由 theme.master + theme.config 組成，各頁面為單一 .aspx，開發者能直覺地定位並修改版面，大幅降低維護難度。

### 自訂 User Control 的重寫與部署簡化
部分舊 API 在 CS2007 中無法使用，作者趁機將原有客製控制項重寫為 .ascx + .cs，捨棄 DLL 方式。如此一來，部署僅需複製檔案即可，無須重新編譯，整體流程更為輕便。

### 新功能尚待深入研究
雖然 CS2007 內含多項新功能，作者尚未詳細測試，但隨著基礎平台、樣板與控制項皆已完成升級，後續若有需要可隨時啟用並深入探索。