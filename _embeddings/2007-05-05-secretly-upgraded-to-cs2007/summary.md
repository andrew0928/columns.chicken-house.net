# 偷偷升級到 CS2007 ..

## 摘要提示
- 低調升級: 站台兩週前已升級至 CS2007，外觀維持舊版以降低變動感。
- 升級流程簡單: 主要作業為資料庫升級與檔案升級兩步驟。
- 樣版系統革新: 從動態 UserControl 改為 ASP.NET 2.0 標準的 master page + config。
- 維護更易: 每頁面化為單純的 .aspx，定位與修改更直觀。
- 客製化挑戰: 先前自製的 theme 與 control 需重新調整與相容性修正。
- API 變動: 舊版部分 API 在 CS2007 不再適用，需重寫或替換做法。
- 部署優化: 自訂控制從 DLL 改為 .ascx + .cs，部署更便利。
- 後續規劃: 新功能尚未深入研究，但平台已完成升級並可支援後續探索。

## 全文重點
作者低調地在兩週前將網站升級到 Community Server 2007（CS2007），並刻意將前台外觀保持與舊版一致，讓使用者不感受到突兀的改變。就升級步驟而言，流程相對單純，核心重點在資料庫與檔案的升級。然而，真正耗時的是因應過往客製化而需同步調整的 theme 與 control。

本文核心著墨於 CS2007 在樣版（template）系統上的重大變動。早期 1.0 到 2.x 的版本大量依賴動態載入 UserControl 的模式，將版面配置寫在 UserControl 的標籤中，而資料與邏輯則留在程式碼中，導致要客製樣版時必須先釐清其載入與組裝機制，學習成本高。CS2007 起改採 ASP.NET 2.0 的標準方式：每套樣版由 master page 與設定檔（theme.master、theme.config）構成；以 Blog 為例，各頁面回歸單純的 .aspx 檔，結構更清晰，開發者能快速定位需要修改的部分，維護與調整顯著容易。

同時，User Control 也因 API 變更帶來相容性議題，舊 API 在 CS2007 已不適用。作者趁機重寫了幾個自訂控制，並將原本需要編譯成 DLL 的做法，改為直接使用 .ascx + .cs 的形式。這種轉換簡化了部署流程，降低更新門檻，更符合頻繁迭代與快速上線的需求。

至於 CS2007 的新功能，作者尚未深入研究，但現在平台已完成升級與改造，等於打好基礎，後續可以在穩定的環境上探索新能力與擴充可能。整體而言，此次升級以「維持外觀、優化架構、降低維護成本」為主軸，既確保使用者體驗連續性，也讓開發與部署流程更有效率。

## 段落重點
### 升級完成但外觀不變：低調切換，維持使用者體驗連續性
作者表示網站已在兩週前升級至 CS2007，為避免使用者感到突兀，升級完成後即將前台面板調回舊版風格，因此外觀看起來與先前幾乎一致。升級過程從操作層面看並不複雜，主要是資料庫升級與檔案升級兩個步驟即可完成。不過，由於站台過去存在客製化的 theme 與 control，真正花時間的部分在於調整這些客製內容，使之在新版本運作正常。此做法兼顧穩定與可控性，將改變的影響集中於開發與維運面，對終端使用者則保持平滑過渡。

### 樣版系統的關鍵變革：從動態 UserControl 到 ASP.NET 2.0 標準
作者將本次升級的最大收穫聚焦在樣版系統的演進。舊版（1.0～2.x）透過大量動態載入 UserControl 的方式組合頁面，版面配置放在控件標籤中，而資料與邏輯寫在後端，導致要改樣版時，得先理解其組合邏輯與載入機制，學習曲線相對陡峭。CS2007 改採 ASP.NET 2.0 標準：整個主題以 master page 與設定檔（theme.master、theme.config）構成，Blog 的各頁面也回歸簡單的 .aspx 結構。如此一來，開發者可以迅速辨識並定位要修改的頁面與區塊，調整不需大費周章，維護效率與可讀性都明顯提升，降低後續擴充的成本與風險。

### 自訂控制的相容性與部署轉型：從 DLL 到 .ascx + .cs
CS2007 對部分 API 做了調整，舊有的呼叫在新版本中已不再可用。作者藉此機會重寫了幾個自訂 User Control，並同步將原本必須編譯成 DLL 的作法，調整為直接以 .ascx + .cs 的形式部署。這樣的改變有兩個直接好處：一是降低部署與更新門檻，不必每次改動就重新編譯、打包與發佈；二是更貼近 ASP.NET 的常見實務，維護流程更透明、開發迭代更迅速。對於需要頻繁微調 UI 或行為的元件，這種部署模式尤為利多。

### 新功能尚待探索：平台就緒，後續再行深挖
雖然 CS2007 引入了不少新功能，但作者尚未深入研究細節，目前的重點是完成平台升級與客製化相容調整，確保系統穩定。換言之，基礎環境已經到位，後續可以在不影響現有服務的前提下，逐步評估並啟用新特性。此節奏兼顧風險控管與持續改善，先把底層與流程打好，讓未來的功能探索更從容可靠。

## 資訊整理

### 知識架構圖
1. 前置知識：學習本主題前需要掌握什麼？
- 基本 ASP.NET 2.0 概念（Master Page、.aspx、UserControl .ascx/.cs）
- 社群平台 Community Server（CS）基本結構與部署概念
- 基本資料庫升級操作與網站檔案部署流程

2. 核心概念：本文的 3-5 個核心概念及其關係
- CS2007 升級流程：分為 DB upgrade 與 File upgrade，屬基礎步驟
- 樣版系統變革：從動態載入 UserControl 的舊作法，轉為 ASP.NET 2.0 標準（Master Page + config）
- 版面與邏輯分離：版面配置由 master/page 控制，資料/邏輯在程式碼後置
- 自訂元件相容性：舊 API 有變動，需重寫或調整自訂 User Control
- 部署簡化：由過去需編譯 DLL，轉為以 .ascx + .cs 直接部署

3. 技術依賴：相關技術之間的依賴關係
- CS2007 依賴 ASP.NET 2.0 的頁面/樣版機制（Master Page、.aspx）
- Theme 結構依賴 theme.master 與 theme.config 的組合
- 自訂控制項依賴新版 CS API；若 API 變更需同步更新控制項
- 升級成功依賴資料庫結構升級與網站檔案同步更新

4. 應用場景：適用於哪些實際場景？
- 將既有 CS 1.x/2.x 部署升級至 CS2007
- 重構/客製部落格或社群站台的樣版與外觀
- 由 DLL 型態的自訂控制轉為 .ascx + .cs 以簡化部署
- 在不改變前端外觀的前提下進行平台升級與維運

### 學習路徑建議
1. 入門者路徑：零基礎如何開始？
- 了解 ASP.NET 2.0 的頁面生命週期、Master Page、UserControl 基礎
- 安裝 CS2007 測試環境，熟悉資料庫與站台檔案結構
- 瀏覽官方文件，了解升級指引與版本差異

2. 進階者路徑：已有基礎如何深化？
- 研究 CS2007 的 theme.master + theme.config 架構與可擴充點
- 比對舊版與新版 API 差異，建立自訂控制項遷移清單
- 練習將舊 DLL 控制項改寫為 .ascx + .cs 並實作部署自動化

3. 實戰路徑：如何應用到實際專案？
- 規劃並執行 DB upgrade + File upgrade 的分階段流程與回復機制
- 將舊版樣版逐頁重構為 .aspx + master，確保前端視覺一致
- 重寫受影響的 User Control，完成功能驗證與壓力測試
- 上線後監控，逐步啟用新功能並評估相容性

### 關鍵要點清單
- 升級分兩步：資料庫與檔案 (優先級: 高)
- 樣版系統改為 Master Page + config (優先級: 高)
- BLOG 頁面為單純的 .aspx 結構 (優先級: 中)
- 舊版大量動態載入 UserControl 的作法被淘汰/弱化 (優先級: 中)
- 自訂 User Control 需因 API 變更而重寫/調整 (優先級: 高)
- 部署由 DLL 轉為 .ascx + .cs 更方便 (優先級: 中)
- 升級後可維持舊外觀以降低使用者感知變動 (優先級: 低)
- 版面配置與資料/邏輯分離更清晰 (優先級: 中)
- 修改樣版定位更直覺，維護成本降低 (優先級: 中)
- 需盤點客製化 theme 與 control 的影響面 (優先級: 高)
- 升級前後須做完整測試與備援方案 (優先級: 高)
- CS2007 新功能存在但需另行評估採用時機 (優先級: 低)
- 平台升級為後續功能研究與擴充奠基 (優先級: 中)
- 開發流程可納入自動化部署以提升效率 (優先級: 中)
- 文件化差異與改動，便於長期維運 (優先級: 中)