# Tips: 遠端桌面連線的小技巧

# 問題／解決方案 (Problem/Solution)

## Problem: 每次連線都必須手動輸入 IP 及帳號密碼

**Problem**:  
在日常維運中，工程師需要頻繁地透過遠端桌面 (Remote Desktop) 連線到同一台或多台伺服器。每次連線都必須重新輸入 IP、帳號與密碼，流程冗長、容易輸錯，也難以交接給其他同仁。

**Root Cause**:  
預設的 MSTSC（遠端桌面連線程式）不會將連線參數永久保存，導致使用者每次啟動程式時都處於「全新連線」狀態。

**Solution**:  
1. 在 MSTSC 畫面填入伺服器 IP、帳號、解析度等資訊。  
2. 點擊「Save As…」將設定存成 `.rdp` 檔。  
3. 之後只要雙擊該 `.rdp` 檔即可自動帶入所有連線資訊完成登入。  

此作法把連線參數外部化為檔案，消除「每次都要重新輸入」這個流程性問題。

**Cases 1**:  
• 一線維運人員將常用的 12 台機器各自保存為 `.rdp` 檔並放在桌面，平均每天節省 10 次輸入帳密的時間（約 5 分鐘），一年累計可節省 30 小時以上的人力成本。  


## Problem: 預設只提供固定幾種解析度，無法符合寬螢幕或雙螢幕需求

**Problem**:  
MSTSC UI 僅提供一小列表解析度選項，無法直接選擇 1440×900、1680×1050 等常見寬螢幕尺寸，造成視窗不是留黑邊就是上下捲軸，影響操作效率。

**Root Cause**:  
MSTSC 圖形介面將解析度選項侷限在「常見」解析度；若要客製尺寸必須透過命令列參數設定，使用者往往不熟悉或不知道此功能存在。

**Solution**:  
1. 開啟命令提示字元 (DOS Prompt)。  
2. 使用指令  
   ```
   mstsc /v:<ServerIP> /w:1440 /h:900
   ```  
   其中 `/w`、`/h` 分別指定寬與高像素。  
3. 如需將此解析度長期使用，可把整行指令存成 `.bat`，或在 `.rdp` 檔內加入下列內容：  
   ```
   desktopwidth:i:1440
   desktopheight:i:900
   ```  

此方式直接繞過 UI 限制，讓使用者完全掌控視窗大小，進而善用寬螢幕或雙螢幕配置。

**Cases 1**:  
• 團隊在 27 吋 2K 螢幕上採用 2560×1440 的遠端解析度後，操作 SQL Management Studio 時無須頻繁捲動，複製/比對大型資料腳本效率提升約 20%。  


## Problem: 遠端桌面看不到本機 (Console) 專屬訊息，例如某些 Service Error

**Problem**:  
某些系統服務或硬體警示只顯示在主控台 (Console) 視窗。使用遠端桌面預設連線時，這些訊息無法被捕捉，導致錯過即時告警。

**Root Cause**:  
Windows Server 2003/2008 時期的遠端桌面，預設會開啟新的 Session (Session 1, 2…)，而非接管機器的 Console Session (Session 0)。因此只有本機或 `/console` 連線才能看見該訊息。

**Solution**:  
1. 以命令列參數連線：  
   ```
   mstsc /v:<ServerIP> /console
   ```  
   (Windows 2008 R2 之後改為 `/admin` 參數)  
2. 或將此設定寫入 `.rdp` 檔：  
   ```
   connect to console:i:1
   ```  

透過 `/console` 或 `/admin` 參數強制接管 Session 0，即可看到原本只出現在主控台的錯誤訊息與服務對話框。

**Cases 1**:  
• 在處理 Windows Service 運行失敗的客訴案例時，支援工程師使用 `/console` 連線立即看到「授權序號過期」對話框，10 分鐘內完成續約並恢復服務，避免了原先可能需派駐現場的 2 小時交通與作業時間。
