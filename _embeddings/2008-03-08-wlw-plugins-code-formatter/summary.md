# WLW Plugins: Code Formatter

## 摘要提示
- 開發動機: 為減少貼程式碼時切換 HTML 的繁瑣動作，作者決定自行撰寫 Live Writer 外掛。
- 核心元件: 外掛以 c# code format 開源程式庫為基礎，純 C# 編寫且支援 Unicode。
- 功能特色: 一鍵將程式碼轉為乾淨的 HTML，並搭配獨立 CSS 取得最佳排版效果。
- 實作時間: 初版僅花兩三小時完成，之後經數日微調達到可用水準。
- 視覺成品: 文章中附有編輯與預覽截圖，展示轉換後程式碼的高亮效果。
- 使用心得: 與其它 Syntax Highlight 元件相比，該外掛處理中文不亂碼且輸出簡潔。
- WinForm 雜記: 在設計語言選擇 ComboBox 時，因 IDE 限制而以程式碼手動填入 Key/Value。
- CSS 整合: 直接把 c# code format 提供的 CSS 放入 Community Server 佈景，即可立即套用。
- 下載方式: 提供外掛壓縮檔連結，並開放使用者回饋與後續更新。
- 改進方向: 作者歡迎意見，但仍以「有空與有動力」為前提再度打開 Visual Studio。

## 全文重點
作者近期頻繁在部落格貼上程式碼範例，以往必須先到 c# code format 網站轉換，再於 Windows Live Writer 中切換到 HTML 原始碼貼入，流程冗長。因懶惰催生效率需求，他試著安裝現成 Syntax Highlight 外掛，卻因中文亂碼問題放棄。幸好 c# code format 本身釋出原始碼，於是作者決定直接包裝成 Live Writer 外掛。  
外掛的雛形在短短數小時內完成，隨後靠實際寫文逐步優化，最終提供「貼上程式碼→按 OK→完成」的極簡體驗。文中附有編輯與預覽截圖，證明成品排版美觀且可插入廣告區塊。作者特別欣賞 c# code format 的四大特點：純 C#、熟悉的輸出格式、乾淨 HTML（僅依賴獨立 CSS）、完全支援 Unicode。  
除了核心功能介紹，他也分享製作圖形介面時的小插曲：原以為可以藉由設計工具直接設定 ComboBox 的顯示文字與實際值，卻遍尋不著做法，只得透過程式碼以 KeyValuePair 手動加項—雖僅數行，仍違背「希望零程式碼」的初衷。  
最後作者公布下載連結，表明若有心得與建議可留言，未來會在時間與興趣允許時持續改版。

## 段落重點
### 開發動機與背景
作者先前貼程式碼需往返 c# code format 網站與 Live Writer HTML 檢視，流程繁瑣且易生錯；加上近期貼文量增加，決定自製外掛以提升效率。

### Plugin 實作與使用體驗
選用 c# code format 開源程式庫，短時間內完成可用版本；在 Live Writer 內只要貼上原始程式碼並點擊 OK，即可自動轉為高亮 HTML，省去手動編輯。

### c# code format Library 優點
1. 純 C#，程式碼精簡架構清晰。  
2. 作者過去即習慣其網站版，熟悉輸出格式。  
3. 產生 HTML 不夾雜大量 inline color，可搭配單一 CSS 管理。  
4. 完整支援 Unicode，中文不亂碼。

### CSS 整合與版面調整
為保持輸出乾淨，僅需將官方附帶之 CSS 加入 Community Server 的自訂佈景，便能在部落格端完美呈現程式碼區塊。

### WinForm ComboBox 小插曲
在建立語法類型下拉選單時，因設計工具無法直接設定 Value/Display，作者最終以數行程式碼利用 KeyValuePair 手動填值，雖簡單卻打破「零程式碼」期望。

### 結語與下載
外掛已打包為壓縮檔供下載，作者歡迎使用者回報問題或提出改進建議，但後續更新仍取決於時間與興趣。