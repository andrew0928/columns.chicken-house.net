# Bot Checker 回來了!

## 摘要提示
- 轉移平台: 從 Community Server 移植 Bot Checker 到 BlogEngine.NET 花了不少功夫。  
- AJAX 問題: BE 回應區大量使用 AJAX，插入 Bot Checker 必須追蹤複雜的 JavaScript 流程。  
- PostBack 對比: CS 幾乎全站 AJAX，而 BE 大多仍用 PostBack，唯獨回應區顯得突兀。  
- 施工心路: 多次中斷、分心逛網站，直到今天才「狠下心」完成修改。  
- 客端偷跑: 為迴避 AJAX 衝突，部分驗證邏輯被移到 Client Side，安全性略打折。  
- 風險評估: 作者賭自家網站流量不高，Bot 不致特地來攻擊，暫以此半成品防禦。  
- 視覺成果: Bot Checker 會在發表回應時自動生成題目並預填至評論欄位中。  
- 使用自由: 若不想在留言中保留「芭樂雞萬歲」等測試字串，使用者可自行刪除。  
- CAPTCHA 彩蛋: BlogEngine.NET 其實內建 CAPTCHA，但開啟方式藏得很深。  
- 嘗鮮建議: 想在 BE 上用正統 CAPTCHA 的讀者可自行挖掘並嘗試啟用。  

## 全文重點
作者宣布先前在 Community Server（CS）部落格平台上使用的「Bot Checker」功能，如今終於移植回新平台 BlogEngine.NET（BE）。過程之所以拖延，是因 BE 在張貼回應時使用了大量 AJAX 機制，導致要插入自訂驗證碼程式碼時必須一路追蹤 JavaScript 流程與伺服端回呼介面；相比之下，早期在 CS 上因系統大量採用 AJAX，反而較容易找到統一切入點。

為節省時間與避免深入修改核心函式，作者採取折衷作法：部分驗證邏輯搬到 Client Side 執行。當使用者開啟留言視窗時，程式即產生一條「芭樂雞萬歲」等文字並自動填入「評論」欄位；只要留言者未刻意刪除、且 Bot 無法正確模擬此步驟，系統即視為通過檢查。雖然攤開 HTML 原始碼即可看出驗證方式，真正有心撰寫攻擊腳本者仍可繞過，但作者評估自己網站規模與能見度有限，暫不擔心成為目標，因此先行部署此半客端解法。

文章並附上兩張螢幕截圖展示 Bot Checker 的題目生成與留言預覽效果。最後，作者在檢視 BE 程式碼時發現其實內建 CAPTCHA 元件，只是官方文件未明列啟用方法；對想在 BE 上使用更傳統、較安全 CAPTCHA 的開發者，作者建議可自行深挖程式碼找出啟動開關。

## 段落重點
### 為何要「回來」──Bot Checker 的移植動機
作者原本在 CS 使用 Bot Checker 防止垃圾留言；搬家到 BE 後功能中斷，為維持留言品質決定移植。  

### AJAX 亂流──追程式碼的痛苦
BE 在留言區混合使用 AJAX 與 PostBack；要插入 Bot Checker 必須釐清回呼流程與 JavaScript 訂閱點，導致開發時間拉長。  

### 折衷方案──將驗證搬到 Client Side
為避免大改核心，作者把題目生成與答案比對邏輯放到瀏覽器端，並自動將答案填入評論欄，雖降低安全性但可快速上線。  

### 風險與取捨──安全性小評估
HTML 原始碼公開後，Bot 仍可反向工程，但作者認為自身網站規模不易成為目標，願意先以此解法過渡。  

### 探索彩蛋──BlogEngine.NET 其實內建 CAPTCHA
在閱讀 BE 程式碼時意外發現已包含 CAPTCHA 元件，但缺乏易用設定介面；鼓勵有需求的人自行研究啟用方式。