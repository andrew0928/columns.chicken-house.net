```markdown
# 微服務架構設計 ─ 資料庫的選擇，RDBMS or NoSQL?

# 問答集 (FAQ, frequently asked questions and answers)

## Q: 在微服務架構下，RDBMS 與 NoSQL 應該怎麼選？
單純的「二選一」並不能解決真正的商業需求。  
先釐清核心問題與整體架構方案，再依資料特性、服務邊界與治理能力決定使用 RDBMS、NoSQL，或兩者併用。若只問「到底該選誰」，代表尚未挖到問題本質，也無法保證能滿足業務目標。

## Q: 做資料庫技術決策前，需要評估哪些面向？
1. 你對各種資料技術適用情境與資料結構精準度的掌握。  
2. 你處理交易與一致性（分散式交易）的能力。  
3. 微服務下服務邊界切割是否精準，儲存需求是否改變。  
4. 當採用多種資料庫時，是否有能力把它們整合並正確落地。

## Q: RDBMS 與 NoSQL 本質上的最大差異是什麼？
RDBMS 把「表格資料」與其索引、查詢演算法抽象化到極致；  
NoSQL 把「物件／文件的狀態」抽象化，主打彈性 schema 與 O(1) 級的 key-value 存取。  
前者擅長 SQL、JOIN、交易控制；後者擅長水平擴充、彈性資料結構與高速 K/V 存取。

## Q: 為什麼雲端或微服務化的場景特別容易看到 NoSQL？
微服務通常一個服務一個資料庫、對外僅靠 API，跨服務 JOIN 幾乎不存在，且必須面對分散式交易與水平擴展。這些條件削弱了 RDBMS 的優勢，放大了 NoSQL 的彈性與擴充能力，因此 NoSQL 更容易被採用。

## Q: 若同時要滿足速度、可靠度、成本等互相衝突的需求，該怎麼辦？
關鍵不是「選邊站」而是「整合」。  
就像大型儲存系統同時用 SSD 與 HDD 以兼顧速度與成本，架構師應視資料特性把 RDBMS 和 NoSQL 組合起來，讓不同技術互補長處，而非硬性二選一。

## Q: 切割資料庫，把 SQL 變成 API 前需要準備什麼？
必須限制查詢模式並設計精準的 API。  
這要求對資料結構 (data structure) 有深厚理解，能把原本靠 Schema＋Query language 完成的操作，轉成明確且高效的 API 呼叫，避免服務之間再度產生「隱性 JOIN」。

## Q: 微服務下要怎麼處理分散式交易？
可使用兩階段提交 (2PC) 或 Saga pattern，搭配 Event-Driven / CQRS，把單一業務交易切成多個本地交易並以最終一致性收斂。

## Q: 當資料同時存放於多個資料庫時，後端異動要如何同步？
常見做法是 CQRS + 事件重播 (Replay)，利用 Pub/Sub 或 Event-Driven 機制，在多個存儲體系之間同步資料變更，確保最終一致。
```