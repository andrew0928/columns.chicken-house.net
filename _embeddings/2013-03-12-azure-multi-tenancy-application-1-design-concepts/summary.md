# [Azure] Multi-Tenancy Application #1, 設計概念

## 摘要提示
- Blog回歸: 作者隔了 1 年半再次發文，說明「微型化內容」造成長文減少。
- 雲端成熟: Azure PaaS 使大型 Web App 的開發門檻降低。
- 多租戶精神: SaaS 核心在於一套系統服務多個客戶，多由 SalesForce 發揚光大。
- 三種資料隔離: Separated DB、Separate Schemas、Shared Schema 為常見作法。
- 資安與成本: 隔離層級越深安全越高、成本也越高。
- MSDN經典文: 2006 年文章提供設計選擇與對應技術建議。
- 擴充性考量: Shared Schema 在新增資料型別時最不易維護。
- 現代武器: 有了 Azure 與 ASP.NET MVC4，實作多租戶更簡潔。
- 經驗分享: 作者六年前自建多租戶架構，累積實戰教訓。
- 系列預告: 本文為概念篇，實作細節將於下一篇揭曉。

## 全文重點
作者在沉寂一年半後重新動筆，感嘆社群媒體的「微型化」讓長篇技術文章日漸稀少；然而雲端與 SaaS 的普及卻讓大型 Web 應用的需求更加明確。本文先從概念面切入，介紹 SaaS 成功關鍵「多租戶」(Multi-Tenancy) 的資料隔離策略，並援引 MSDN 七年前的經典文章，闡述三種常見架構：  
1. Separated DB—每位租戶獨享資料庫，隔離度最高、成本最高；  
2. Separate Schemas—同庫異架構，兼顧隔離與成本；  
3. Shared Schema—同庫同表，以 TenantID 欄位區分，最省錢也最易出錯。  

作者逐一說明三者優缺點與使用情境，特別指出在擴充資料型別、維護 Query 正確性及資安風險上的差異。MSDN 原文亦提供對效能、版本控管、備份還原等面向的評估方式，對只能採用 Windows Server + SQL Server 的企業內部專案極具參考價值。  
隨著 Azure PaaS 與 ASP.NET MVC4 日漸成熟，如今建置多租戶應用不再如六年前艱難；作者將以自身踩坑經驗，配合最新平台，於後續文章中示範更精煉的實作手法。  

## 段落重點
### 1. 引言—Blog回歸與「微」時代
作者久未更新部落格，反省微博、微信等短內容平台興起使長文創作動能下降，但也意識到完整技術文章的重要性，因此決定重拾鍵盤。

### 2. 多租戶與雲端背景
說明雲端技術已從概念走向成熟，Azure PaaS 讓大型 Web App 變得平易近人；SaaS 的核心價值在於能以單一應用服務多個客戶，即 Multi-Tenancy。

### 3. 為何要寫這系列
市面雖有相關理論，中文討論卻稀少；作者早於六年前自建過多租戶架構，踩過不少雷，希望結合 Azure 與 MVC4 把經驗轉化為系列文章。

### 4. 三種資料隔離架構概覽
引用 MSDN 圖表總攬 Separated DB、Separate Schemas、Shared Schema 三大模式，並強調「隔離深度＝成本」與「安全性」的拉鋸原則。

### 5. Separated DB 詳解
每租戶獨立資料庫，不怕 SQL 遺漏篩選條件導致資料外洩，備份、還原、升級皆可分戶處理；但資料庫授權與維運成本最高，且連線管理複雜。

### 6. Separate Schemas 詳解
所有租戶共用一顆 DB，但以不同 Schema 隔離表結構；相較分庫能省下硬體授權，又比同表模式安全，惟開發須動態切換 Schema、部署較繁瑣。

### 7. Shared Schema 詳解
全部租戶共享同一組 Table，以 TenantID 區分資料；開發與部署最直覺，硬體最省，但開錯一行 SQL 就可能讓 A 客戶看到 B 客戶資料，且在擴充欄位時需預留通用欄或採 Name-Value 儲存，導致 Query 難寫。

### 8. MSDN 表格導讀與擴充性議題
MSDN 文章列出三種架構在安全、效能、版本控管、備份及擴充性上的最佳做法；作者特別點出 Shared Schema 在「Extensibility Patterns」下常需以預留欄位或 NOSQL 式設計應對，對查詢與維護都是挑戰。

### 9. 技術演進與新選擇
2006 年尚無 Azure、MVC，今日已有雲端資源與框架可用；作者將示範如何利用現代工具降低開發複雜度，同時保留多租戶的彈性與安全。

### 10. 結語—系列預告
本文定位為概念篇，梳理多租戶三大資料隔離策略及其取捨；實作細節、Azure 配置與 MVC 範例將於下一篇陸續揭露，敬請期待。