# FlickrProxy #1 - Overview

## 摘要提示
- 頻寬瓶頸: 個人自架網站因上傳圖片佔用流量，常被頻寬限制拖累。  
- 現行做法: 透過 WLW Flickr 外掛將圖片預先上傳，但需依賴特定工具與帳號。  
- Server-Side Proxy: 作者偏好在伺服器端透明處理，避免被單一帳號或服務綁定。  
- HttpHandler 經驗: 過去已開發多個類似 Handler，證實可於執行期攔截並改寫請求。  
- 動態判斷與轉址: 構想為執行期檢查圖片是否已搬至 Flickr，若需要即時上傳並 301/302 轉址。  
- 彈性與備份: 伺服器端方案可隨時停用、汰換服務，且原始檔案仍保留於本機，方便備份。  
- 多媒體延伸: 未來希望把影片轉到 YouTube、壓縮檔虛擬化至 SkyDrive，形成統一 Provider 架構。  
- POC 完成: 透過 MediaProxy 先行驗證技術可行性，下一步開始實作正式版本。  

## 全文重點
作者經由與朋友討論相片分享的頻寬問題，反思目前常見的客戶端外掛（如 WLW Flickr 插件）雖然方便，卻把「上傳、取得連結、產生 HTML」等動作鎖死在發文當下，導致日後更換帳號、替換服務或離開 WLW 時缺乏彈性。為了保有自由度與備份完整性，他傾向將整個流程搬到伺服器端，利用類似 Proxy 的 HttpHandler 動態攔截圖片請求：  

1. 當使用者瀏覽文章、瀏覽器發出圖片請求時，Handler 先檢查該檔案是否已同步到 Flickr。  
2. 若未同步且判斷「無需外部托管」，就直接把本地檔案回傳；若需要外部托管，便即時呼叫 Flickr API 上傳。  
3. 上傳成功後，Handler 會更新對應關係並以 Redirect 將請求導向 Flickr，往後同一張圖便走外部流量。  

此方法雖然在第一次存取時多了一次檔案判斷與上傳的延遲，但換來低耦合、高彈性：  

• 可隨時停用或切換至其他圖床服務，而不影響既有文章。  
• 原始圖片仍留在自家主機，方便備份與災難還原。  
• 架構可複用於影片 (YouTube)、壓縮檔 (SkyDrive) 等不同媒體，只要替換 Provider 即可。  

作者已完成概念驗證（POC），證明攔截 HTML 並重寫所有圖片來源的技術可行。接下來將動手整合之前寫過的兩個 HttpHandler，打造統一 Provider 架構，實現「圖片→Flickr、影片→YouTube、ZIP→SkyDrive」的全面 Proxy 化目標。文章最後以「敬請期待」收尾，預告後續系列文章將陸續分享開發心得與成果。

## 段落重點
### 1. 動機：頻寬與圖片托管困境
作者與朋友討論自架 ADSL 網站時，發現最大瓶頸是圖片佔用頻寬。雖已有多款客戶端外掛能把圖片傳至 Flickr，但強迫使用者在發文時就決定圖床與帳號，往後搬遷或備份極不方便，因而萌生打造伺服器端解法的想法。

### 2. 客戶端外掛的限制
以 WLW Flickr Plugin 為例，軟體會在撰寫文章時完成「上傳、產生連結、插入 HTML」整套流程。問題在於 (1) 無法 retro-fit 舊文；(2) 依賴特定帳號與工具；(3) 未保留原始檔。這些缺點促使作者尋求替代方案。

### 3. Server-Side Proxy 構想
作者偏好類似 Proxy 的機制：所有圖片請求都經由自家網站的 HttpHandler。Handler 先確認本地是否需要外部託管，若需要即刻呼叫 Flickr API 進行上傳，再以 Redirect 把請求導向 Flickr。此流程集中在伺服器執行期，具備可停用、可更換服務以及保留本地檔案的彈性。

### 4. 技術基礎與既有經驗
回顧四年前的多個 HttpHandler 專案，作者已熟悉在 ASP.NET 中攔截與改寫請求的技巧。此次計畫將沿用相同理念，僅把儲存邏輯換成呼叫 Flickr API。同時計畫把先前兩個 Handler 整合進「統一 Provider 架構」，使不同媒體可對應不同雲端服務。

### 5. POC 與未來藍圖
作者已完成 Proof of Concept：曾將 Google News 頁面抓下，動態改寫所有圖檔到另一目錄以示範技術可行。未來藍圖不僅限於圖片，還想把影片 Proxy 到 YouTube、ZIP 虛擬成資料夾並嘗試轉存 SkyDrive。文章最後呼籲讀者期待下一集，象徵正式開發即將開始。