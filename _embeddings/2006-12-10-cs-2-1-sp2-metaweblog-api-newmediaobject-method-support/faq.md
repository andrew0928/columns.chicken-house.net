# CS 2.1 SP2 - MetaWeblog API / newMediaObject method support ..

## 問題與答案 (FAQ)

### Q&A 類別 A: 概念理解類

Q1: 什麼是 MetaWeblog API？
- A簡: 一種以 XML-RPC 為基礎的部落格遠端介面，支援發文、編輯與媒體上傳等操作。
- A詳: MetaWeblog API 是早期廣泛使用的部落格遠端發布協定，採用 XML-RPC 通訊，透過標準方法呼叫實作發文、取文、改文與上傳媒體等功能。其優點是簡單、跨平台、客戶端相容性高（如寫作工具可通用），缺點是規範較舊、擴充性有限。常見應用是從桌面或行動寫作工具直接管理部落格內容。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: A-Q8, A-Q21, B-Q2

Q2: 什麼是 newMediaObject 方法？
- A簡: MetaWeblog API 中負責上傳媒體檔（如圖片）的方法，回傳可公開存取的 URL。
- A詳: newMediaObject 是 MetaWeblog API 的核心方法之一，用於將二進位媒體（常見為圖片）以 Base64 包裝後透過 XML-RPC 傳給伺服器。輸入包含 blogid、認證資訊與檔案描述（name、type、bits），回傳含有檔案公開 URL 的結構。它讓文章編輯器可一鍵上傳並取得連結，取代繁瑣的 FTP 流程。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: A-Q9, A-Q10, B-Q1

Q3: newMediaObject 解決了什麼問題？
- A簡: 移除手動 FTP 上傳與路徑管理的麻煩，提供一致的上傳與回連 URL 流程。
- A詳: 傳統做法常需先用 FTP 將圖片傳至伺服器，再手動取得 URL 內嵌文章。newMediaObject 把上傳、命名與 URL 產生整合在 API 中，一次完成，降低錯誤與溝通成本。它也標準化客戶端行為，使多種寫作工具能在不同平台上採用一致的上傳能力。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: A-Q4, A-Q22, B-Q7

Q4: 為什麼要用 API 上傳而不是 FTP？
- A簡: API 一次完成上傳與取回 URL，較安全、可驗證與記錄，避免手動錯誤。
- A詳: API 上傳提供認證、授權與伺服器端驗證（大小、類型、配額），並自動產生公開 URL 與統一的檔案命名策略。相較 FTP，API 可更細緻控制權限與紀錄操作；也便於用戶端整合（自動將 URL 內嵌文章）。對團隊協作與審計、資安治理而言更優。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: A-Q22, B-Q13, D-Q8

Q5: MetaWeblog API 的核心價值是什麼？
- A簡: 以簡單標準化方式，連結多種客戶端與不同部落格系統的互通性。
- A詳: 它用少量方法定義了發文、取文、上傳媒體等常見需求，讓寫作工具與平台之間不需針對每家系統客製。核心價值在降低整合成本、提升生產力與一致體驗。雖協定較舊，但其廣泛支援與低門檻，使之仍具實用性。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: A-Q1, A-Q7, B-Q19

Q6: MetaWeblog 與 Blogger API、MovableType API 有何差異？
- A簡: 三者皆為早期部落格 API，方法命名與功能覆蓋不同，相容性與擴充性各異。
- A詳: Blogger API 偏重文章操作，MetaWeblog 在此基礎擴充並納入更通用欄位；MovableType API 另增特定平台特性。MetaWeblog 在客戶端支援度高、結構簡單；MovableType 豐富但專屬性強。實務上常以 MetaWeblog 作為最低共同標準。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q1, A-Q21, A-Q7

Q7: MetaWeblog 與 AtomPub 的差異？
- A簡: MetaWeblog 用 XML-RPC，AtomPub 用 HTTP/REST；後者標準化更完整、擴充性較佳。
- A詳: MetaWeblog 以 XML-RPC 呼叫固定方法；AtomPub（RFC 5023）以 HTTP 介面操作資源，結構化且擴充能力強，與現代網路架構更契合。MetaWeblog 勝在歷史相容與工具支援；AtomPub 則在規範完備度、安全與資源模型上更具優勢。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: B-Q2, B-Q13, A-Q5

Q8: 什麼是 XML-RPC？在 MetaWeblog 中扮演什麼角色？
- A簡: 一種以 XML 包裝 RPC 呼叫的通訊協定，是 MetaWeblog 的底層傳輸機制。
- A詳: XML-RPC 以 HTTP 為運輸層，透過 XML 描述方法名與參數，實現遠端程序呼叫。MetaWeblog 定義一組方法（如 newPost、newMediaObject），由 XML-RPC 承載與序列化資料（含 Base64 二進位）。簡單直觀，便於不同語言實作互通。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: B-Q2, A-Q1, A-Q12

Q9: newMediaObject 的參數有哪些？
- A簡: blogid、username、password，以及含 name、type、bits 的媒體結構。
- A詳: 呼叫時需提供：1) blogid 標識目標部落格；2) username/password 作為認證；3) struct mediaObject：name（檔名）、type（MIME）、bits（Base64 編碼的檔案內容）。伺服器依此驗證、存放並回傳可用 URL。某些實作亦支援額外欄位如 folder、overwrite 等。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: A-Q10, A-Q11, A-Q12

Q10: newMediaObject 的回傳結果是什麼？
- A簡: 一個包含 url（媒體公開連結）的結構，有時含型別或檔名資訊。
- A詳: 成功時回傳 struct，最關鍵欄位為 url，指向新上傳檔案的公開位置。部分實作會附帶 type、file、length 等資訊；失敗則回傳 XML-RPC fault，含錯誤碼與訊息。客戶端通常接收 url 後，立即將其嵌入文章內容中顯示。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: B-Q7, B-Q8, C-Q7

Q11: 什麼是 blogid？如何取得？
- A簡: 目標部落格的識別碼，從平台設定或 getUsersBlogs 方法取得。
- A詳: blogid 用於指明要操作的部落格或站台，有些平台固定為 1，有些為 GUID 或整數。可透過登入後台查詢、API 方法 metaWeblog.getUsersBlogs 或平台文件取得。多部落格環境中特別重要，以避免上傳至錯誤站點。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: C-Q1, B-Q3, D-Q1

Q12: 什麼是 bits 與 Base64 編碼？
- A簡: bits 為檔案二進位內容，需先 Base64 編碼後隨 XML-RPC 一併傳送。
- A詳: 因 XML-RPC 使用 XML 文本傳輸，二進位資料須以 Base64 轉為文本。客戶端讀取檔案（如 JPG）後編碼到 bits 欄位；伺服器收到後再解碼還原。這步確保跨平台傳輸正確，但會有約 33% 尺寸膨脹與 CPU 編解碼成本。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: B-Q2, B-Q9, D-Q8

Q13: MIME type 是什麼？為何重要？
- A簡: 描述檔案內容型態的標準字串，用來驗證與正確回應檔案。
- A詳: MIME（如 image/jpeg、image/png）協助伺服器判斷是否允許上傳、如何儲存與回應 Content-Type。正確的 MIME 有助瀏覽器正確顯示、避免安全風險（如上傳可執行檔）。常見以副檔名、檔頭偵測或雙重檢查確保一致性。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: B-Q6, D-Q5, C-Q5

Q14: 什麼是 Endpoint？如何定位？
- A簡: 提供 XML-RPC 呼叫的服務網址，通常在平台文件或後台設定可見。
- A詳: Endpoint 是客戶端發送 MetaWeblog 方法的 HTTP URL，例如 /xmlrpc 或 /metaweblog。不同系統路徑不同，需確認平台文件、後台 API 設定或自動探索。設定錯誤會導致 404 或 fault。建議以 HTTPS 保護帳密與內容。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: C-Q1, D-Q9, A-Q8

Q15: 什麼是 CS 2.1 SP2？與本文關係？
- A簡: Community Server 2.1 的服務包版本；本文宣告其支援 newMediaObject。
- A詳: CS 2.1 SP2 是早期常見的 .NET 社群/部落格平台版本之一。本文指出該版本開始直接支援 MetaWeblog API 的 newMediaObject 方法，使使用者可從客戶端直接上傳照片，不再需要另行透過 FTP 管理檔案與路徑。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: A-Q16, A-Q27, C-Q1

Q16: CS 2.1 SP2 對 MetaWeblog 的支援重點？
- A簡: 新增 newMediaObject 支援，能直接上傳圖片並取得 URL，簡化發文流程。
- A詳: 這版支援意味著平台端已實作認證、檔案驗證、儲存與 URL 產生的完整鏈路，客戶端（如寫作工具）可無縫上傳圖片。對使用者而言，降低摩擦、減少出錯、提升發文效率，是一次實用的體驗升級。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: A-Q2, C-Q1, A-Q28

Q17: 典型寫作客戶端如何使用 newMediaObject？
- A簡: 於發文時自動上傳媒體取得 URL，插入文章 HTML 或 Markdown 中。
- A詳: 客戶端在貼上圖片或拖曳媒體時，背景呼叫 newMediaObject 上傳；成功後取得 URL 並插入 <img> 或相應語法。若多張圖片，會逐一呼叫，並處理縮圖、對齊與說明文字。若上傳失敗，通常提供重試或離線暫存。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: C-Q7, B-Q1, D-Q8

Q18: 直接上傳照片的使用情境有哪些？
- A簡: 部落格發文插圖、相簿貼圖、教學截圖、產品圖示等即時媒體需求。
- A詳: 在日常發文中，上傳封面圖、步驟示意圖、程式截圖最常見。行動端拍照即上傳、工作記錄中的白板照片、活動花絮亦常用。API 化上傳能讓這些操作在同一介面中完成，不需切換工具或手動管理連結。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: A-Q3, C-Q7, A-Q28

Q19: 與內建媒體庫/檔案管理的關係？
- A簡: newMediaObject 上傳後的檔案通常同步出現在平台的媒體庫中管理。
- A詳: 多數平台會將 API 上傳的媒體納入媒體庫，支援瀏覽、刪除、重命名、分類與權限管理。這讓透過 API 與後台操作一致，並能配合清理政策與儲存配額，維持站點整潔與效能。也便於重複使用或引用舊檔。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: B-Q21, C-Q5, D-Q7

Q20: 上傳安全性與認證應注意什麼？
- A簡: 使用 HTTPS、最小權限帳號、限制檔案型別與大小，並記錄操作。
- A詳: 必須以 HTTPS 傳輸避免憑證外洩；帳號僅授與必要權限；啟用白名單（如僅允許圖片類型）、限制單檔大小與總配額；伺服器端進行副檔名與檔頭雙重檢查與惡意檔案掃描。完整日誌有助稽核與事後分析。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: B-Q11, B-Q12, D-Q6

Q21: newMediaObject 與 metaWeblog.newPost 的關係？
- A簡: 前者上傳媒體，後者建立或更新文章；常在一篇發文流程中搭配使用。
- A詳: 一般流程是先透過 newMediaObject 上傳圖片取得 URL，再以 newPost 或 editPost 將 URL 內嵌於內容中。兩者職責分離、組合靈活，讓客戶端能針對媒體與文字分別處理重試、回滾與版本管理，提升穩定性。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: A-Q2, C-Q7, B-Q20

Q22: API 與手動 FTP 的工作流程比較？
- A簡: API 自動化上傳與回傳 URL；FTP 需手動傳檔、拼路徑與內嵌，易出錯。
- A詳: API：客戶端讀檔→編碼→呼叫→伺服器驗證存檔→回傳 URL→自動插入。FTP：登入→上傳→確認路徑→複製 URL→貼回編輯器。API 可統一策略、審計與錯誤處理；FTP 較靈活但需操作經驗且缺乏集中治理。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: A-Q4, B-Q13, D-Q2

Q23: URL 回傳與公開存取的概念？
- A簡: 伺服器回傳可公開瀏覽的資源 URL，瀏覽器可直接載入該媒體。
- A詳: newMediaObject 成功後，回傳的 url 通常位於網站可公開路徑；用戶端可立即內嵌引用。若需權限控管，可由平台以保護路徑或簽章 URL 實作。URL 穩定性與可預測性對 SEO 與快取友好尤為重要。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: B-Q7, B-Q18, C-Q8

Q24: 檔案命名與衝突處理的基本觀念？
- A簡: 常見採用去重或附加時間戳/隨機字尾，避免覆寫與碰撞。
- A詳: 客戶端或伺服器可能改寫檔名以符合政策（小寫化、移除空白），並在重名時附加哈希或序號。良好策略可避免覆寫、提升可讀性與利於清理。對外鏈穩定性與去重儲存成本也很關鍵。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: B-Q5, D-Q7, C-Q8

Q25: 檔案大小、配額與政策的重要性？
- A簡: 控制單檔與總量，保護系統效能與成本，避免濫用。
- A詳: 設定單檔上限避免過大檔案拖垮資源；配置使用者或站點配額管理總儲存量；依內容需求設白名單與封鎖危險型別。配合通知與預警機制，能在接近上限前採取行動，避免服務中斷。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: D-Q4, B-Q12, C-Q5

Q26: 客戶端相容性與常見工具？
- A簡: 多數寫作工具（如 Windows Live Writer 等）支援 MetaWeblog 與上傳。
- A詳: 歷史上常見工具包含 Windows Live Writer/ Open Live Writer、MarsEdit、Ecto 等；眾多行動/桌面編輯器亦支援 MetaWeblog。選擇工具時看是否支援 newMediaObject、HTTPS、代理設定與相簿管理等能力。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: C-Q1, C-Q7, D-Q10

Q27: 本文的關鍵結論為何？
- A簡: CS 2.1 SP2 新增 newMediaObject 支援，可直接上傳照片，無需再用 FTP。
- A詳: 文章指出新版 MetaWeblog API 在 CS 2.1 SP2 可直接處理圖片上傳，作為 FTP 的替代。作者並以實際貼圖驗證，顯示平台已能回傳有效 URL 並正確顯示。這代表日常發文流程可明顯簡化並提升穩定性。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: A-Q15, A-Q16, A-Q28

Q28: 為何 CS 2.1 SP2 的此支援對使用者有價值？
- A簡: 降低上傳摩擦、減少錯誤、提升效率與安全，帶來更順暢的寫作體驗。
- A詳: 對內容創作者，上傳一體化意味貼圖、排版更順手；對維運，統一通道便於稽核與防護（白名單、配額、HTTPS）。減少 FTP 憑證散佈與錯置，有助資安。整體效益涵蓋體驗、成本、治理三方面。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: A-Q4, A-Q20, C-Q6

### Q&A 類別 B: 技術原理類

Q1: newMediaObject 背後如何運作？
- A簡: 客戶端以 XML-RPC 傳送含 Base64 的媒體，伺服器驗證存檔並回傳公開 URL。
- A詳: 原理說明：客戶端讀檔→Base64 編碼→XML-RPC 呼叫 newMediaObject。關鍵流程：1) 驗證帳密與授權；2) 檔頭與副檔名/MIME 核對；3) 產生安全檔名與目錄；4) 寫入儲存層；5) 建索引/媒體庫記錄；6) 回傳 URL。核心組件：XML-RPC 解析器、驗證模組、儲存抽象與 URL 生成器。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q2, B-Q2, B-Q7

Q2: XML-RPC 呼叫與序列化流程？
- A簡: 以 XML 包裝方法與參數，含 Base64 欄位，透過 HTTP POST 傳輸。
- A詳: 原理：方法名與參數在 XML 中編碼；Base64 表示二進位。關鍵步驟：1) 組裝 XML；2) 設 Content-Type；3) POST 至 Endpoint；4) 伺服器解析、執行方法；5) 回傳 XML 或 fault。核心組件：XML 產生器、HTTP Client/Server、Base64 編解碼器。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q8, A-Q12, D-Q9

Q3: 認證與授權檢查機制？
- A簡: 基於帳密的驗證，結合角色與權限，限制上傳型別與大小。
- A詳: 原理：伺服器先驗證 username/password，再檢查使用者、部落格與角色是否允許上傳。關鍵步驟：1) 驗證帳密；2) 取用戶設定；3) 比對白名單與配額；4) 記錄操作。核心組件：身份驗證、授權引擎、政策與審計模組。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q20, D-Q1, B-Q12

Q4: 伺服器端檔案存放與路徑解析？
- A簡: 依站台設定產生實體或物件儲存路徑，對應公開 URL 前綴。
- A詳: 原理：儲存層抽象出本機磁碟、網路共享或雲端桶；依日期/使用者/部落格分層。流程：生成目錄→寫入檔案→紀錄索引。核心組件：儲存提供者、路徑規則、URL 映射（虛擬目錄或簽章連結）。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: C-Q8, B-Q7, B-Q21

Q5: 檔名處理與重名避免策略？
- A簡: 正規化檔名並附加哈希/時間戳，確保唯一性與可讀性。
- A詳: 原理：將原始名稱清理（移除空白與危險字元），並以內容哈希或遞增序號避免碰撞。流程：比對目錄→若存在則改名→持久化。核心組件：檔名正規化器、去重哈希、衝突解決策略。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q24, D-Q7, B-Q7

Q6: MIME 偵測與驗證流程？
- A簡: 透過副檔名與檔頭雙重檢查，對照白名單才允許儲存。
- A詳: 原理：magic number 檢測與副檔名比對，避免偽裝。流程：讀前幾位元組→判型→比對允許清單→拒絕或通過。核心組件：MIME 探測器、白名單政策、錯誤回報（fault code）。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q13, D-Q5, C-Q5

Q7: 回傳 URL 生成邏輯？
- A簡: 以站台設定的公開前綴與儲存相對路徑組合，確保可被網頁載入。
- A詳: 原理：將儲存層的相對路徑映射到可公開的 URL（含網域、虛擬目錄）。流程：路徑→URL 映射→可選簽章/版本參數→回傳。核心組件：URL 產生器、站台設定、CDN/反向代理整合。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: C-Q8, B-Q18, A-Q23

Q8: 錯誤處理與 fault 結構？
- A簡: 失敗時回傳 XML-RPC fault，含錯誤碼與訊息，便於客戶端診斷。
- A詳: 原理：以 faultCode 與 faultString 描述錯誤（如 401、413、415 類型）。流程：檢查→發生錯誤→建立 fault→回傳。核心組件：例外對應器、錯誤碼表、日誌記錄。客戶端據此決定重試或提示用戶。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: D-Q1, D-Q4, D-Q5

Q9: 大檔處理與串流上傳原理？
- A簡: 以分段讀取、限制記憶體占用，並控制請求大小與逾時。
- A詳: 原理：客戶端分塊讀檔再 Base64，避免一次載入；伺服器串流寫入，設置 request size 與 timeout。流程：分段→編碼→POST→串流寫→校驗完整性。核心：串流 API、逾時/大小限制、資源回收。
- 難度: 高級
- 學習階段: 進階
- 關聯概念: D-Q8, C-Q9, B-Q12

Q10: 縮圖與媒體衍生物管線（一般做法）？
- A簡: 上傳後觸發產生縮圖/裁切，供前端不同尺寸載入。
- A詳: 原理：後處理管線監看新媒體，依規則產生多尺寸檔案。流程：接收→排程→影像處理→存放→關聯索引。核心：影像處理器（如尺寸、品質）、任務排程、儲存與 URL 命名規則。屬平台實作差異。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: C-Q7, B-Q4, B-Q7

Q11: 安全掃描與檔案消毒流程？
- A簡: 上傳即掃描惡意檔案，拒絕可疑內容，記錄並告警。
- A詳: 原理：整合防毒/惡意程式偵測引擎，檢查檔頭、腳本注入與巨集。流程：寫入暫存→掃描→合格才轉正→回傳 URL。核心：掃描引擎、隔離區、告警與日誌。可與白名單與 MIME 驗證互補。
- 難度: 高級
- 學習階段: 進階
- 關聯概念: A-Q20, D-Q2, B-Q6

Q12: 速率限制與配額的設計？
- A簡: 以使用者/站點為單位控制頻率與總量，防濫用與壓力尖峰。
- A詳: 原理：計數器與時間窗控頻，配額追蹤儲存量。流程：檢查次數與用量→超限則拒絕或排隊。核心：限流器、配額管理、通知機制。搭配記錄可定位濫用來源與趨勢。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q25, D-Q8, C-Q9

Q13: 與 FTP 的性能與可靠性比較原理？
- A簡: API 省連線往返與人工操作，錯誤可程式化處理，更易達穩定與追蹤。
- A詳: FTP 需人為步驟、易誤操作且難審計；API 可重試、回報明確錯誤碼、支援限流與配額。雖 Base64 造成體積膨脹，但整體流程自動化帶來更高成功率與可觀測性，在多客戶端情境更具優勢。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q4, A-Q22, D-Q2

Q14: CS 2.1 SP2 服務端架構如何接入此方法？
- A簡: 透過 XML-RPC 處理器映射至 newMediaObject，串接驗證、儲存與 URL 模組。
- A詳: 原理：Web 層接收 POST→方法路由→授權→媒體驗證→儲存提供者→媒體庫索引→回傳 URL。核心組件：XML-RPC Handler、Auth、Storage Provider、Media Index、Config。此模組化設計便於後續擴充。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q16, B-Q1, B-Q4

Q15: 日誌追蹤與稽核設計？
- A簡: 以請求 ID 串聯端到端日誌，記錄使用者、檔案、結果與錯誤。
- A詳: 原理：每次呼叫產生相關 ID，串接應用與儲存層日誌。流程：請求→事件記錄（大小、型別、耗時）→錯誤碼→告警。核心：集中式日誌、指標與追蹤，便於容量規劃與事故分析。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: D-Q2, B-Q8, B-Q12

Q16: 國際化檔名與編碼處理？
- A簡: 以 UTF-8 正規化並產生安全別名，避免亂碼與跨平台不一致。
- A詳: 原理：正規化 Unicode（NFC/NFD）、移除不安全字元，產生 slug 或 ID 形式檔名；保留原名作 metadata。流程：解析→正規化→別名→映射。核心：編碼工具、檔名策略、URL 編碼。確保各端一致顯示與存取。
- 難度: 高級
- 學習階段: 進階
- 關聯概念: D-Q3, A-Q24, C-Q8

Q17: 交易性與原子性保障？
- A簡: 以暫存→驗證→轉正流程，確保失敗不留殘檔且狀態一致。
- A詳: 原理：先寫入臨時路徑，全部檢查通過再移動到正式位置；失敗則清理。流程：暫存→掃描→驗證→提交或回滾。核心：臨時儲存、原子移動、錯誤處理。避免半成品連結與資源洩漏。
- 難度: 高級
- 學習階段: 進階
- 關聯概念: B-Q11, B-Q4, D-Q2

Q18: 快取與 CDN 整合機制？
- A簡: 以 CDN 前置與 Cache-Control/ETag 提升載入速度與減輕源站壓力。
- A詳: 原理：回傳 URL 指向 CDN 網域或經反向代理，並設適當快取頭。流程：上傳→源站儲存→CDN 首次回源→後續邊緣快取。核心：URL 重寫、快取政策、失效控制。對高流量影像特別有效。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: C-Q10, A-Q23, D-Q8

Q19: 向後相容與版本協商？
- A簡: 以保留既有方法與參數為主，擴充以可選欄位維持舊客戶端可用。
- A詳: 原理：不破壞既定 schema，新增欄位標記為可選；必要時以 capability 方法宣告支援。流程：能力檢查→條件使用新欄位。核心：版本策略、功能開關。確保舊工具仍能發文與上傳。
- 難度: 高級
- 學習階段: 進階
- 關聯概念: A-Q5, B-Q1, D-Q10

Q20: 客戶端重試與冪等性策略？
- A簡: 以網路錯誤重試與內容哈希去重，避免重傳造成重複檔案。
- A詳: 原理：對可恢復錯誤（逾時、暫時失敗）重試；上傳前計算哈希，伺服器或客戶端比對避免重複。流程：計畫性重試→失敗紀錄→人工或自動合併。核心：重試策略、去重機制、錯誤分級。
- 難度: 高級
- 學習階段: 進階
- 關聯概念: D-Q8, A-Q24, B-Q5

Q21: 檔案存儲的層級化與清理策略？
- A簡: 以日期/使用者分層，定期清理孤兒檔與過期衍生物。
- A詳: 原理：規劃目錄層級利於快照與備份；媒體庫維護引用關係，清理未被引用的舊檔或縮圖。流程：標記→掃描→刪除→報告。核心：參照清點、生命週期、備份還原策略。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q19, D-Q2, B-Q4

Q22: 內部服務與外部存儲（如雲端）的抽象？
- A簡: 以儲存介面抽象實作，可切換本機、NAS 或雲端桶，對上層透明。
- A詳: 原理：定義 IStorageProvider 之類介面，上層透過統一 API 操作。流程：依設定載入提供者→寫入/讀取→生成對應 URL。核心：依賴反轉、設定化、錯誤與重試。便於擴展與雲端化。
- 難度: 高級
- 學習階段: 進階
- 關聯概念: B-Q4, B-Q18, C-Q8

### Q&A 類別 C: 實作應用類

Q1: 如何在 CS 2.1 SP2 啟用 MetaWeblog 上傳？
- A簡: 確認啟用 XML-RPC/MetaWeblog，取得 Endpoint、blogid 與帳密，測試連線。
- A詳: 步驟：1) 後台啟用 XML-RPC/MetaWeblog 功能；2) 查詢 Endpoint URL 與 blogid；3) 建立具上傳權限的帳號；4) 以客戶端測試 newMediaObject。設定：使用 HTTPS。注意：確認白名單與大小上限，避免測試失敗。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: A-Q14, A-Q11, D-Q1

Q2: 如何用 Python 呼叫 newMediaObject 上傳圖片？
- A簡: 使用 xmlrpc.client 傳送含 Base64 的 bits，成功回傳 url 後內嵌使用。
- A詳: 步驟：1) pip 安裝；2) 讀檔並 Base64；3) 呼叫方法。程式碼：
```
from xmlrpc.client import ServerProxy, Binary
s=ServerProxy('https://example/xmlrpc')
with open('img.jpg','rb') as f:
  data={'name':'img.jpg','type':'image/jpeg','bits':Binary(f.read())}
print(s.metaWeblog.newMediaObject('1','user','pass',data))
```
注意：使用 HTTPS，處理 fault。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: B-Q2, A-Q9, D-Q5

Q3: 如何用 C# 呼叫 newMediaObject？
- A簡: 透過 XML-RPC 客戶端或自建 SOAP/HTTP POST，送出 name、type、bits。
- A詳: 步驟：1) 引入 XML-RPC 客戶端套件；2) 讀取檔案為 byte[]；3) 組裝 struct 呼叫。程式碼：
```csharp
var proxy = XmlRpcProxyGen.Create<IMetaWeblog>();
var bytes = File.ReadAllBytes("img.jpg");
var media = new MediaObject{ name="img.jpg", type="image/jpeg", bits=bytes };
var res = proxy.newMediaObject("1","user","pass", media);
```
注意：憑證驗證與逾時設定。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: B-Q2, A-Q10, D-Q6

Q4: 如何設定 HTTPS 以保護憑證？
- A簡: 於伺服器安裝有效憑證，強制 XML-RPC Endpoint 使用 HTTPS 連線。
- A詳: 步驟：1) 申請/部署 TLS 憑證；2) 綁定站台與強制重導到 HTTPS；3) 驗證中介憑證鏈；4) 更新客戶端 Endpoint。設定：關閉舊版協議、啟用強密碼套件。注意：確保時鐘正確，避免驗證失敗。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q20, D-Q6, A-Q14

Q5: 如何設定伺服器的檔案大小與副檔名白名單？
- A簡: 在平台與 Web 伺服器層設定上限與允許清單，拒絕超限或危險型別。
- A詳: 步驟：1) 平台後台設置單檔上限、總配額；2) 指定允許 MIME/副檔名；3) Web 伺服器（如 requestLimits）同步限制；4) 測試超限行為。注意：回傳明確錯誤，並在日誌中記錄原因。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q13, A-Q25, D-Q4

Q6: 如何從 FTP 遷移到 API 上傳流程？
- A簡: 梳理現有路徑與權限，改用客戶端 API，上傳後自動插入回傳 URL。
- A詳: 步驟：1) 盤點 FTP 認證與目錄；2) 關閉或收斂 FTP 權限；3) 設定 API 白名單/配額；4) 更新寫作工具配置 Endpoint；5) 教育使用者與試運行。注意：保留舊檔可見性，逐步切換降低風險。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: A-Q22, D-Q2, C-Q1

Q7: 如何自動把回傳 URL 嵌入文章內容？
- A簡: 客戶端上傳後取得 url，插入 <img> 或 Markdown 圖片語法。
- A詳: 步驟：1) 上傳取 url；2) 依編輯格式產生標記；3) 插入游標位置。HTML 例：
```html
<img src="https://cdn/img.jpg" alt="描述" />
```
Markdown：
```
![描述](https://cdn/img.jpg)
```
注意：提供 alt、寬高與 Lazyload 以優化體驗。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: A-Q10, B-Q10, D-Q2

Q8: 如何設定儲存路徑與公開 URL 前綴？
- A簡: 在平台配置檔與反向代理/CDN 中對應路徑映射與網域前綴。
- A詳: 步驟：1) 設定儲存根目錄與分層規則；2) 設定公開網域或虛擬目錄；3) 反代/CDN 轉發；4) 測試 URL 可達性。注意：跨域與快取頭設定，確保穩定載入與安全。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: B-Q4, B-Q7, C-Q10

Q9: 如何為大量圖片上傳做併發與重試？
- A簡: 控制並發數、指數退避重試，並以內容哈希去重與續傳策略。
- A詳: 步驟：1) 設並發上限（如 3–5）；2) 逾時/網路錯誤重試（退避）；3) 上傳前計算哈希避免重複；4) 記錄失敗清單再補傳。注意：避免壓垮服務，關注限流與配額。
- 難度: 高級
- 學習階段: 進階
- 關聯概念: B-Q9, B-Q12, D-Q8

Q10: 如何與 CDN 整合替換回傳 URL？
- A簡: 以反向代理或 URL 重寫，將源站 URL 轉為 CDN 網域與路徑。
- A詳: 步驟：1) 設定 CDN 網域與回源；2) 平台設定回傳 URL 前綴或發文時替換；3) 驗證快取命中與頭資訊；4) 監控流量。注意：版本參數避免灰度衝突，正確處理失效與原圖保留。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: B-Q18, C-Q8, D-Q2

### Q&A 類別 D: 問題解決類

Q1: 上傳回傳 401 Unauthorized 怎麼辦？
- A簡: 檢查帳密、權限與 blogid，確認 Endpoint 與 HTTPS 設定正確。
- A詳: 症狀：fault 401/認證失敗。原因：帳密錯、無上傳權、blogid 錯或 Endpoint 錯。解法：1) 用同帳密登入後台驗證；2) 確認角色有上傳權；3) 以 getUsersBlogs 取正確 blogid；4) 修正 Endpoint，優先用 HTTPS。預防：最小權限與憑證管理。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: A-Q11, C-Q1, A-Q14

Q2: 上傳成功但圖片無法顯示如何排查？
- A簡: 檢查回傳 URL 可達性、權限、MIME 回應與靜態檔映射。
- A詳: 症狀：編輯器顯示斷圖。原因：URL 指向錯誤、檔案未公開、MIME/回應頭錯、靜態路由設定有誤。步驟：1) 瀏覽器直接開 URL；2) 檢查 200 與 Content-Type；3) 查看伺服器日誌；4) 驗證反代/CDN。預防：自動健康檢查與上傳後探測。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: B-Q7, C-Q8, B-Q15

Q3: 檔名出現亂碼或問號怎麼處理？
- A簡: 啟用 UTF-8 正規化與安全別名，確保 URL 編碼一致。
- A詳: 症狀：上傳後檔名變亂碼或無法存取。原因：編碼不一致、未做 URL 編碼或檔名包含非法字元。步驟：1) 客戶端使用 UTF-8；2) 伺服器正規化檔名；3) 啟用 slug；4) 測試跨平台下載。預防：統一編碼政策與自動別名。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: B-Q16, A-Q24, B-Q7

Q4: 上傳超出大小限制要怎麼解？
- A簡: 降低檔案大小或調整平台與 Web 伺服器的上限設定。
- A詳: 症狀：fault 類似 413 或平台提示超限。原因：單檔上限或 requestLimits 太小。步驟：1) 壓縮影像（畫質/尺寸）；2) 調整平台上限；3) 同步 Web 伺服器設定；4) 重新上傳。預防：事先提示剩餘配額與自動壓縮。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: A-Q25, C-Q5, B-Q9

Q5: MIME type 不支援導致拒絕怎麼辦？
- A簡: 確認檔案真實型別並更新白名單或轉換為允許格式。
- A詳: 症狀：fault 指出型別不允許。原因：副檔名或檔頭不符、白名單過嚴。步驟：1) 用 file/magic 工具辨識；2) 修正副檔名或重新匯出；3) 調整白名單；4) 重新上傳。預防：客戶端上傳前檢查與轉檔。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: A-Q13, B-Q6, C-Q5

Q6: 遇到 SSL 憑證錯誤導致無法連線？
- A簡: 檢查憑證有效性與信任鏈，更新客戶端 Endpoint 為 HTTPS。
- A詳: 症狀：TLS 驗證失敗、握手錯誤。原因：憑證過期、鏈不完整、網域不匹配。步驟：1) 更新有效憑證；2) 安裝中介憑證；3) 確保主機名匹配；4) 客戶端信任根。預防：自動續簽與監測到期告警。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: C-Q4, A-Q20, A-Q14

Q7: 檔名重複造成覆寫或失敗如何避免？
- A簡: 啟用去重與改名策略（哈希/時間戳），避免相同名稱碰撞。
- A詳: 症狀：上傳覆寫舊檔或報衝突。原因：同名策略不完善。步驟：1) 伺服器啟用重名改名；2) 客戶端附加隨機/哈希；3) 媒體庫檢查既有檔；4) 以 URL 防快取誤替換。預防：一致命名規則與唯一鍵。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: B-Q5, A-Q24, B-Q21

Q8: 上傳速度慢或逾時如何改善？
- A簡: 優化圖片大小、啟用並發與重試、調整逾時並靠近部署。
- A詳: 症狀：長時間等待或 timeout。原因：檔案過大、網路延遲、伺服器限流。步驟：1) 壓縮圖檔；2) 控制並發與退避；3) 調整逾時與 keep-alive；4) 近源部署與 CDN。預防：配額與限流告警、容量規劃。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: B-Q9, B-Q12, C-Q9

Q9: 被防火牆或代理阻擋 XML-RPC？
- A簡: 確認端口與路徑允許，於代理設定例外，必要時改用 HTTPS 標準端口。
- A詳: 症狀：連線被拒或 403。原因：企業防火牆、WAF 規則或代理攔截。步驟：1) 使用 443/HTTPS；2) 加入允許清單；3) 檢查 WAF 規則誤擋；4) 改用可辨識路徑。預防：與網安協作建立白名單與監控。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q14, B-Q2, C-Q4

Q10: 客戶端不支援 newMediaObject 的替代方案？
- A簡: 改用支援 MetaWeblog 的工具，或以 AtomPub/後台上傳再插入連結。
- A詳: 症狀：工具僅能發文無法上傳。原因：未實作方法或版本太舊。步驟：1) 更換支援工具；2) 以後台媒體庫先上傳；3) 若平台支援 AtomPub，改用其媒體端點。預防：採用活躍維護的客戶端與標準。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: A-Q26, A-Q7, C-Q6

### 學習路徑索引
- 初學者：建議先學習哪 15 題
    - A-Q1: 什麼是 MetaWeblog API？
    - A-Q2: 什麼是 newMediaObject 方法？
    - A-Q3: newMediaObject 解決了什麼問題？
    - A-Q4: 為什麼要用 API 上傳而不是 FTP？
    - A-Q5: MetaWeblog API 的核心價值是什麼？
    - A-Q8: 什麼是 XML-RPC？在 MetaWeblog 中扮演什麼角色？
    - A-Q9: newMediaObject 的參數有哪些？
    - A-Q10: newMediaObject 的回傳結果是什麼？
    - A-Q11: 什麼是 blogid？如何取得？
    - A-Q14: 什麼是 Endpoint？如何定位？
    - A-Q15: 什麼是 CS 2.1 SP2？與本文關係？
    - A-Q16: CS 2.1 SP2 對 MetaWeblog 的支援重點？
    - A-Q27: 本文的關鍵結論為何？
    - C-Q1: 如何在 CS 2.1 SP2 啟用 MetaWeblog 上傳？
    - D-Q1: 上傳回傳 401 Unauthorized 怎麼辦？

- 中級者：建議學習哪 20 題
    - A-Q13: MIME type 是什麼？為何重要？
    - A-Q17: 典型寫作客戶端如何使用 newMediaObject？
    - A-Q18: 直接上傳照片的使用情境有哪些？
    - A-Q19: 與內建媒體庫/檔案管理的關係？
    - A-Q22: API 與手動 FTP 的工作流程比較？
    - A-Q23: URL 回傳與公開存取的概念？
    - A-Q24: 檔案命名與衝突處理的基本觀念？
    - A-Q25: 檔案大小、配額與政策的重要性？
    - A-Q26: 客戶端相容性與常見工具？
    - B-Q1: newMediaObject 背後如何運作？
    - B-Q2: XML-RPC 呼叫與序列化流程？
    - B-Q4: 伺服器端檔案存放與路徑解析？
    - B-Q6: MIME 偵測與驗證流程？
    - B-Q7: 回傳 URL 生成邏輯？
    - B-Q8: 錯誤處理與 fault 結構？
    - B-Q13: 與 FTP 的性能與可靠性比較原理？
    - C-Q2: 如何用 Python 呼叫 newMediaObject 上傳圖片？
    - C-Q3: 如何用 C# 呼叫 newMediaObject？
    - C-Q5: 如何設定伺服器的檔案大小與副檔名白名單？
    - D-Q2: 上傳成功但圖片無法顯示如何排查？

- 高級者：建議關注哪 15 題
    - A-Q7: MetaWeblog 與 AtomPub 的差異？
    - A-Q20: 上傳安全性與認證應注意什麼？
    - B-Q9: 大檔處理與串流上傳原理？
    - B-Q10: 縮圖與媒體衍生物管線（一般做法）？
    - B-Q11: 安全掃描與檔案消毒流程？
    - B-Q12: 速率限制與配額的設計？
    - B-Q15: 日誌追蹤與稽核設計？
    - B-Q16: 國際化檔名與編碼處理？
    - B-Q17: 交易性與原子性保障？
    - B-Q18: 快取與 CDN 整合機制？
    - B-Q19: 向後相容與版本協商？
    - B-Q20: 客戶端重試與冪等性策略？
    - B-Q21: 檔案存儲的層級化與清理策略？
    - B-Q22: 內部服務與外部存儲（如雲端）的抽象？
    - C-Q9: 如何為大量圖片上傳做併發與重試？