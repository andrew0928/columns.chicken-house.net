# Windows Live Writer - Plugin 處女作

## 摘要提示
- Windows Live Writer: 被公認為優秀的離線文章編輯器，但內建圖片上傳機制有缺陷。  
- JPEG 重新壓縮: WLW 會強制重存 JPEG，品質下降、檔案反而可能變肥。  
- 問題影響: 圖片畫質受損又佔空間，作者無法忍受。  
- Plugin 開發: 下載 WLW SDK，以 .NET 撰寫外掛繞過內建機制。  
- UNC ↔ URL 映射: 外掛預先設定網路分享與網址對應，自動複製圖檔並插入連結。  
- 設定介面: 於 WLW 偏好設定中新增 plug-in，並提供 Options 視窗調整。  
- 使用流程: 使用者在「Insert」選單選擇新項目，挑檔即完成上傳與貼圖。  
- MetaBlog API 嘗試: 因 WLW 外掛無法取得帳號資訊，作者被迫放棄此路徑。  
- 作品定位: 僅自用、無防呆；若官方日後修正問題外掛即成廢物。  
- 未來方向: 考慮改寫為真正透過 MetaBlog API 上傳，並加入帳密設定。

## 全文重點
作者長期使用 Windows Live Writer 撰寫部落格，卻發現程式無論透過 MetaBlog API 或 FTP，上傳圖片時都會強制重新儲存成 JPEG，而且採用較高的壓縮品質設定。此舉不僅為具破壞性的有損壓縮，導致影像品質下降，檔案大小有時甚至增加，形成「畫質變差、檔案變肥」的人財兩失局面。為解決這個令人詬病的缺陷，作者決定自行動手撰寫 WLW 外掛。  
他下載 Windows Live Writer SDK，以 .NET 進行開發，將想法化為一支簡易外掛。外掛的核心概念是讓使用者先在設定頁面中填入「網路分享(UNC)」與「對應網址(URL)」的映射關係；在實際插入圖片時，外掛會於本地端將選擇的檔案複製到指定分享資料夾，再自動在文章中插入對應的網路圖檔 URL，如此便可避免 WLW 的再壓縮動作，同時保持圖片品質與合理檔案大小。  
使用者體驗上，外掛安裝後會出現在 WLW「Tools → Preferences → Plugins」之中，可點擊 [Options] 打開自行設計的設定視窗。平日撰文時，只需在「Insert」選單中點擊「插入圖片(從網路芳鄰)」，系統隨即叫用標準檔案開啟對話框，選擇完圖片後一切自動完成，流程與原本的「Insert Picture From Web」近似但更加省事。  
作者原本規劃利用 MetaBlog API 直接上傳圖片，但實務測試發現 WLW 外掛架構並不開放部落格帳密資訊，以致無法在同一外掛中存取該 API，因而放棄此方案，暫時以 UNC 分享折衷。由於這僅是兩小時邊看 SDK 邊動手的作品，功能陽春、缺乏防呆，也未計畫對外發布 DLL；未來若 Microsoft 在新版 WLW 修正圖片處理機制，外掛即告失去意義；若仍未改善，則考慮重寫版本，於 Options 加入 Blog URL、帳號、密碼等設定，真正透過 MetaBlog API 完成圖片上傳。

## 段落重點
### 引言與問題描述
作者稱讚 Windows Live Writer 的易用性，卻痛陳其「強制 JPEG 重新儲存」造成畫質下降與檔案膨脹，並以左右對照圖及檔案大小數據說明問題的嚴重性。

### 決定撰寫 Plugin
嘗試各種設定無解後，作者與朋友討論決定以 Plug-in 方式解套；於是下載 WLW SDK，利用 .NET 動手開發，設計理念與「Insert Picture From Web」相似但自動化程度更高。

### 外掛設定介面
將 DLL 放進 Plug-ins 目錄後，使用者可於 WLW 偏好設定中看到新外掛；作者額外撰寫 Options 視窗，讓使用者填入「網路分享路徑」與「對應 URL」。

### 實際使用流程
完成設定後，在撰文時於「Insert」選單選擇「插入圖片(從網路芳鄰)」，出現標準檔案對話框；外掛自動將檔案複製到分享資料夾並插入對應網址，整個流程快速無痛。

### MetaBlog API 嘗試與受阻
作者原計畫直接透過 MetaBlog API 進行圖片上傳，奈何 WLW 外掛框架無法取得帳密資訊，推測是安全考量，故宣告暫停該方向研究。

### 版本定位與未來計畫
目前版本純為自用與技術試水，缺乏防呆且不對外發布；若官方修正圖片問題外掛即成歷史，否則作者考慮重寫、改用 MetaBlog API 並加入完整帳密設定，以提升實用價值。