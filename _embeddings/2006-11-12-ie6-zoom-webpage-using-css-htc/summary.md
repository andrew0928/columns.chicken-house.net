# IE6 縮放網頁：using css + htc

## 摘要提示
- 網頁縮放需求: 想在 IE6 也能像 IE7/Firefox 一樣任意縮放頁面。
- HTC 技術: IE5 以後提供的 client-side HTML Component，可透過 CSS 的 behavior 套用。
- 使用者樣式表: IE 允許自訂 CSS，能把行為散佈到所有開啟的網站。
- 解決方案組合: 利用「使用者 CSS ＋ HTC」在任何網頁注入縮放功能。
- 實作檔案: 只需 zoom.css、zoom.htc、zoom.html 三個檔案。
- 操作方式: ALT＋滑鼠左鍵叫出選單，選擇倍數即時縮放。
- 相容性問題: 早期 IE 可行，但新版 IE 的安全分區阻擋 cross-domain 呼叫。
- 安全限制: c:\zoom.htc 與網域內容不同分區，造成行為元件被封鎖。
- 未解挑戰: 如何在不違反 IE 安全機制下跨網域載入 HTC。
- 徵求點子: 作者呼籲有想法者提供更簡單的繞過或改善方案。

## 全文重點
作者起初在友站看到一段能讓 IE6 實現頁面縮放的小程式碼，但必須把 JavaScript 直接嵌入每一頁 HTML，對使用者來說不具通用性。於是他想到結合兩項 IE 專屬機制──「HTC（HTML Component）」與「使用者自訂 CSS」──把縮放功能注射到所有網頁。

HTC 自 IE5 起即存在，可藉由 CSS 的 behavior 屬性將一段客製化 Script 綁定到任何 HTML 元素。若再搭配 IE 提供的「使用者樣式表」，便能在不改動網站原始碼的前提下，全域套用某支 HTC。具體作法是：把 zoom.css 指定為 IE 的全域樣式表，內容僅需對 html 或 body 掛上 behavior:url(c:\zoom.htc)；HTC 內部實作捕捉 ALT＋左鍵，跳出縮放比例選單並動態調整頁面字型與元素尺寸。如此一來，只要在本機硬碟放置 zoom.htc、zoom.css，再啟用 IE 的「自訂樣式表」選項，任何網址都可即時縮放，操作上與新版瀏覽器無異。

實測結果在本機頁面 c:\zoom.html 表現完美，縮放選單能正常顯示並改變整頁倍率。然而當瀏覽 google.com 這類網域時卻失敗，IE 彈出安全警告並封鎖 HTC。原因在於新版 IE 擴大了分區（Security Zone）與網域隔離政策：本機磁碟的 HTC 檔屬於 Local Machine Zone，而 google.com 屬於 Internet Zone，兩者間的 script 行為被視為跨區交互（cross-zone scripting），預設不可執行。安全保護機制等於切斷了 HTC 與頁面溝通的橋梁，使這套方法僅能在同一安全分區或相同網域內運作。

作者對此束手無策，只能暫列為未解難題；他也思考過把 HTC 放到網路伺服器再以 https 或同網域方式載入，但仍需能滿足「不修改原站資源」的初衷。文章最後呼籲讀者若有更簡潔或安全的繞過方案，歡迎分享。整體而言，本文展示了 IE 特有技術的靈活性與現代瀏覽器安全性之間的拉鋸，也提醒開發者注意跨分區執行程式碼的風險與限制。

## 段落重點
### 1. 緣起：對 IE6 增添縮放功能
作者看到朋友文章，只要插入小段 HTML 即可縮放頁面；然而對使用者而言無法改動他人站點，於是尋求更普適的解法。

### 2. HTC 與使用者 CSS 的結合構想
介紹 HTC 是 IE5 起提供的客戶端元件，可透過 CSS 的 behavior 套入任何元素；若再利用 IE 的「使用者樣式表」選項，便能將 HTC 功能散佈到所有網頁。

### 3. 實作步驟與操作方式
說明需建立 zoom.htc、zoom.css、zoom.html；在 IE 設定自訂樣式表指向 c:\zoom.css；開啟頁面後按 ALT＋左鍵即可選擇縮放百分比，功能如預期運作。

### 4. 成功示範與初步成效
於本機測試頁顯示縮放選單截圖，證明 HTML 無須修改亦能即時縮放，實作手法在早期 IE 表現理想。

### 5. 安全分區造成的跨域阻礙
開啟 Google 首頁後遭 IE 安全機制阻擋，顯示本機 HTC 與網域層級不同而無法互動，點出新版 IE 針對跨區腳本的嚴格限制。

### 6. 未解問題與徵求建議
作者坦承尚未找到簡單繞過方式，但仍希望維持「不用修改原網頁」的目標；邀請讀者提供創意或改進思路，為 IE6 通用縮放功能尋找更完善的解決方案。