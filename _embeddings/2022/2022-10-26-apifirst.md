---
source_file: "_posts/2022/2022-10-26-apifirst.md"
generated_date: "2025-01-03 11:30:00 +0800"
version: "1.1"
tools:
  - github_copilot
  - claude_sonnet_3_5
model: "claude-3-5-sonnet-20241022"
---

# 架構師觀點 - API First 的開發策略 - 生成內容

## Metadata

### 原始 Metadata

```yaml
layout: post
title: "架構師觀點 - API First 的開發策略"
categories:
- "系列文章: 微服務架構"
tags: ["系列文章", "架構師的修練", "microservices"]
published: true
comments_disqus: false
comments_facebook: false
comments_gitalk: true
redirect_from:
logo: /wp-content/images/2022-10-26-apifirst/slides/slide01.png
```

### 自動識別關鍵字
keywords:
  primary:
    - API First
    - 微服務架構
    - 架構師
    - DevOps
    - API設計
  secondary:
    - 敏捷開發
    - API治理
    - 軟體架構
    - 康威定律
    - 抽象化設計

### 技術堆疊分析
tech_stack:
  languages:
    - C#
    - JavaScript
  frameworks:
    - ASP.NET Core
    - React
    - Scrum
  tools:
    - Docker
    - Visual Studio
    - API Management
    - Azure
  platforms:
    - Azure API Manager
    - Google Cloud Platform
    - AWS

### 參考資源
references:
  internal_links:
    - /2020/03/10/interview-abstraction/
    - 系列文章: 微服務架構
  external_links:
    - https://devopsdays.tw/speaker-page/115
    - https://premieragile.com/where-does-an-architect-fit-in-scrum/
    - https://www.facebook.com/gipi.net/posts/pfbid0E6PW6rXWC4HYb6LZKzb9YPiEMX46qQdJJ7jhqkzuaeNX2yVkp7ZEHbd9ryR5oQsnl
    - https://software-engineering-at-google.gh.miniasp.com/
  mentioned_tools:
    - API Design Patterns
    - Continuous API Management
    - Software Engineering at Google
    - Azure API Manager
    - Google Cloud Platform
    - Amazon Web Service

### 內容特性
content_metrics:
  word_count: 12000
  reading_time: "60 分鐘"
  difficulty_level: "高級"
  content_type: "技術分享"

## 摘要 (Summaries)

### 文章摘要 (Article Summary)

作者以其在DevOpsDays Taipei 2022 Keynote演講的內容為基礎，深入探討API First開發策略的重要性與實施方法。文章從組織文化變革的角度出發，分析為何API應該在開發流程中被擺在第一順位考量。作者強調API First並非技術問題，而是設計思維的轉變，需要團隊從產品導向轉向服務導向，優先確保Developer Experience (DX)再追求User Experience (UX)。文章詳細闡述了API經濟的商業價值，包括標準化帶來的規模效應、生態系統建立的可能性，以及如何透過API實現產品化與客製化的平衡。特別針對架構師在敏捷團隊中的角色進行深度分析，說明架構師如何透過抽象化設計和「設計公式」的概念，協助團隊在快速迭代中維持長期目標。文章也推薦了三本重要的學習資源，包括API治理、設計模式和Google軟體工程實踐，為想要推動API First的團隊提供系統性的學習路徑。

### 關鍵要點 (Key Points)

- API First是開發策略和思維模式的轉變，而非單純的技術實施
- 組織需要從產品導向轉向API導向，優先設計DX再發展UX
- 架構師在敏捷團隊中扮演維持長期目標和技術願景的關鍵角色
- API設計的核心在於正確的抽象化和「設計公式」的制定
- 康威定律影響下，API規格也會成為團隊間溝通協作的介面
- 推動API First需要搭配組織文化變革和持續學習機制

### 前言與API First期待分析 (Section Summaries)

作者首先說明本文源自DevOpsDays Taipei 2022的Keynote演講，並補充了演講中未能完整表達的內容。API First的核心概念是在開發流程中優先考慮API設計，而非將API作為產品的附屬功能。作者透過三個維度的問題來測試團隊的API成熟度：產品角度(先設計UI還是API)、技術角度(先求運作還是先訂規格)、經營角度(API是附帶功能還是產品)。這些問題幫助團隊理解自己目前偏向產品導向還是API導向，並認清推動API First所需要的期待調整。文章強調API First並非二擇一的選擇，而是在持續改善循環中正確掌握長期目標的方法。

### 老闆期待的API經濟 (Section Summaries)

從商業決策者的角度分析API First帶來的經濟效益。作者指出標準化和規模化是API經濟的核心價值，透過API能夠實現服務的標準化，進而支撐自動化和規模化的發展。文章以樂高積木為比喻，說明API如何像積木一樣需要具備製造品質、設計品質和降低使用門檻三個特性。在軟體開發中，這分別對應到開發能力(程式碼品質)、設計能力(domain知識設計)和工具鏈整合能力。作者分享了零售業系統跨足餐飲業的實際案例，展現API設計良好時如何支援跨領域應用。文章也提到團隊發展過程中M型化的趨勢，一端需要高度專精的API設計開發人員，另一端需要低門檻的應用開發環境。

### 架構師在敏捷團隊的角色定位 (Section Summaries)

深入探討架構師在敏捷開發環境中的關鍵作用。作者引用外國文章指出敏捷開發的挑戰包括：缺乏長期可視性、多團隊協作複雜性、優先處理可見需求、技術債務被邊緣化等問題。架構師的職責是在快速迭代中維持長期目標，具體包括：理解需求、設計公式(核心機制)、溝通架構、支持開發人員。作者特別強調「設計公式」概念，即透過抽象化找出需求背後的核心機制，這個機制就是API的基礎。以折扣計算系統為例，作者展示如何透過定義統一的input/output介面，讓各種複雜的折扣規則都能在同一套架構下運作。這種抽象化能力是決定API First成敗的關鍵因素。

### 團隊文化與能力建設 (Section Summaries)

推動API First需要系統性的文化變革和能力提升。作者強調所有改變都是困難的，因為需要面對團隊既有的習慣和思維模式。為了建立必要的能力，作者推薦透過讀書會等方式系統性學習他人經驗。文中介紹了三本重要書籍：《Continuous API Management》講述大規模API的治理策略和生命週期管理；《API Design Patterns》由Google工程師撰寫，涵蓋30種常見的API設計模式；《Software Engineering at Google》分享Google在軟體工程方面的文化和技術決策思維。這些資源為團隊提供了從治理、設計到工程文化的完整學習路徑，協助建立推動API First所需的綜合能力。

### 貝佐斯的API備忘錄案例 (Section Summaries)

作者引用Amazon創辦人貝佐斯在2002年發布的內部備忘錄，展現API First思維的遠見。該備忘錄要求所有工程團隊必須以對外開放標準提供API，跨團隊間只能透過API通訊，禁止共享資料庫等暴力手段，違反者一律開除。作者分析這份備忘錄的深層意義：保障公司最重要的服務價值、建立商業運作骨幹、強制面對分散式架構挑戰。這個20年前的決策讓AWS提早面對微服務架構的各種問題，也因此能發展出成熟的PaaS服務。文章透過這個案例說明API First不只是技術選擇，更是組織戰略決策，需要最高層級的支持和強制執行。

## 問答集 (Q&A Pairs)

### Q1. 什麼是API First開發策略？

Q: API First開發策略的核心概念是什麼？與傳統的產品開發方式有何不同？
A: API First是指在開發流程中優先考慮API設計，先訂好API規格再開始寫程式碼。與傳統方式的差別在於：產品角度上優先設計API再做UI，技術角度上先訂規格再同時開發API和APP，經營角度上將API當作產品而非附屬功能。這種方式強迫團隊優先面對真正的domain/business問題，然後才補上實作工作，類似於TDD的概念。

### Q2. 為什麼架構師在敏捷團隊中很重要？

Q: 在強調快速迭代的敏捷開發中，架構師扮演什麼樣的角色？
A: 架構師在敏捷團隊中負責維持長期目標和技術願景。敏捷開發容易忽略長期目標，因為重要但不緊急的事情(如技術債、架構設計)會被無限期擱置。架構師的職責包括：理解需求、設計核心機制(設計公式)、溝通架構、支持開發人員。最關鍵的是透過抽象化找出需求背後的脈絡，設計出能長期穩定運作的核心機制。

### Q3. 什麼是「設計公式」概念？

Q: 架構師提到的「設計公式」是什麼意思？如何應用在API設計上？
A: 「設計公式」是指透過抽象化找出多個需求背後的共同脈絡和核心機制。以折扣計算為例，不是針對每種折扣分別開發，而是設計統一的input/output介面，讓所有折扣規則都能在同一套架構下運作。這個核心機制就是API的基礎，能夠長期穩定運作，支援各種變化的業務需求。好的「設計公式」讓API規格不需要隨需求變動而大幅修改。

### Q4. API經濟的商業價值在哪裡？

Q: 從商業角度來看，推動API First能帶來什麼樣的經濟效益？
A: API經濟的核心價值在於標準化和規模化。透過API能夠標準化服務取得方式，這是自動化和規模化的基礎。當達到一定規模時，就能建立生態系統，吸引更多開發者發掘新應用，帶來新客群。API讓服務能夠融入客戶既有流程，兼顧產品化和客製化需求。就像樂高積木一樣，需要具備製造品質、設計品質和降低使用門檻三個特性，才能發揮最大價值。

### Q5. 康威定律如何影響API設計？

Q: 康威定律在API First開發策略中扮演什麼角色？
A: 康威定律指出系統結構會跟組織結構相同，因此API規格也會成為團隊間溝通協作的介面。這意味著當API規格設計不好卻無法改善時，問題可能出在組織分工而非純技術問題。貝佐斯的API備忘錄就是典型例子，強制所有團隊只能透過API通訊，禁止共享資料庫等方式，這樣的組織約束直接影響了系統架構的發展方向。

### Q6. 推動API First需要哪些準備？

Q: 要成功推動API First開發策略，團隊需要具備哪些能力和準備？
A: 推動API First需要文化變革和能力建設。文化方面需要從產品導向轉向API導向思維，組織需要支持長期目標的維持。能力方面建議透過讀書會系統性學習，包括API治理(Continuous API Management)、設計模式(API Design Patterns)和工程文化(Software Engineering at Google)。最重要的是培養正確的抽象化能力，能夠識別business domain的核心機制並轉化為穩定的API規格。

### Q7. API設計的邊界如何拿捏？

Q: 在API和APP之間應該如何劃分職責邊界？如何避免過度設計？
A: API應該專注於「服務」，APP專注於「應用」。API並非越多越好，而是越少越好，要避免把過多細節塞入API設計。可以透過SDK、code template或BFF來降低前端開發門檻，而非增加API複雜度。關鍵是找到正確的抽象層次，讓API能夠支援不同領域的應用，同時保持介面的穩定性。這需要有決策核心人物(產品長、技術長或架構師)來拿捏平衡。

### Q8. 如何在敏捷開發中維持API設計品質？

Q: 在強調快速交付的敏捷環境中，如何確保API設計的長期穩定性？
A: 關鍵是保留固定資源處理重要但不緊急的需求，避免技術債務被無限期擱置。有些團隊保留20%人力，有些採用3個Sprint後休耕1個Sprint的方式。架構師要協助識別這類需求的重要性，確保API設計相關的工作得到足夠關注。同時要建立以Contract為準的開發流程，在寫任何程式碼前先透過API規格取得stakeholder回饋，及早驗證設計可行性。

## 解決方案 (Solutions)

### P1. 團隊從產品導向轉向API導向困難

Problem: 團隊習慣以產品功能為中心的開發方式，難以轉向API First的思維模式，導致API設計總是依附於產品需求而缺乏長期規劃。

Root Cause: 傳統開發思維將API視為產品的附屬功能，缺乏從服務角度思考的經驗。團隊對於Developer Experience (DX)的重要性認知不足，習慣優先滿足使用者界面需求而忽略服務介面的設計品質。組織文化和評估標準仍以產品交付為主，缺乏對API長期價值的認知。

Solution: 建立API經濟意識和文化變革機制。透過三個維度的自我評估(產品角度、技術角度、經營角度)來診斷現狀，設定明確的轉型目標。建立DX優先於UX的開發原則，確保API設計品質能支撐良好的產品體驗。設立專門的API設計評審機制，並搭配系統性的學習計畫。

Example:
```yaml
# API First 轉型檢核表
產品角度: 
  - 先設計API規格再開發UI
  - 建立DX品質評估標準
技術角度:
  - 使用Contract-driven development
  - API規格先於程式碼實作
經營角度:
  - API當作產品經營
  - 建立API生命週期管理
```

### P2. 敏捷開發中技術債務和長期目標被忽略

Problem: 在強調快速迭代的敏捷開發環境中，重要但不緊急的技術債務和架構設計工作經常被延後，導致API設計品質下降和技術債務累積。

Root Cause: 敏捷開發的快速循環導致團隊只關注當前Sprint的可見需求，缺乏長期規劃視野。重要但不緊急的工作(如API設計、技術債務處理)在優先序排列中總是被後推。缺乏專門角色來維持長期技術願景和跨團隊協調。

Solution: 在敏捷團隊中建立架構師角色，專責維持長期目標和技術願景。採用固定資源分配策略，如20%人力專門處理技術債務或3+1 Sprint模式(3個功能Sprint後1個技術Sprint)。建立架構設計審查機制，確保每個Sprint的交付都符合長期架構目標。

Example:
```yaml
# 敏捷團隊架構師職責
了解需求: 識別具架構意義的需求
設計公式: 抽象化核心機制設計
溝通架構: 跨團隊架構一致性
支持開發: 提供技術指導和審查
資源配置: 20%專門處理技術債務
```

### P3. API設計缺乏正確的抽象化和核心機制

Problem: 團隊無法識別業務需求背後的核心機制，導致API設計過度依賴具體需求，缺乏通用性和擴展性，每次新需求都需要大幅修改API規格。

Root Cause: 缺乏正確的抽象化思維和domain modeling能力。團隊習慣針對每個具體需求直接設計API，未能看出需求背後的共同脈絡。缺乏對業務領域深度理解，無法識別真正的核心概念和不變的業務規則。

Solution: 建立抽象化設計方法論，學習從多個需求中找出共同的「設計公式」。採用Domain-Driven Design思維，先識別領域的核心概念和不變規則，再設計相應的API介面。建立核心機制和應用層的分離架構，讓API專注於穩定的核心服務，複雜的組合邏輯透過SDK或BFF處理。

Example:
```csharp
// 抽象化設計範例：折扣計算核心機制
public interface IDiscountCalculator 
{
    // 統一的輸入輸出介面
    CalculationResult Calculate(ShoppingCart cart);
}

public class ShoppingCart 
{
    public List<Product> Items { get; set; }
    public MemberCard Member { get; set; }
    public List<Coupon> Coupons { get; set; }
}
```

### P4. 跨團隊API協作和治理困難

Problem: 多個團隊各自開發API時缺乏統一標準，導致介面不一致、重複開發、整合困難等問題。API版本管理和向前相容性處理機制不完善。

Root Cause: 缺乏統一的API治理框架和標準制定機制。團隊間缺乏有效的API設計溝通管道，各自為政導致標準分歧。API生命週期管理不完善，缺乏系統性的版本控制和相容性策略。

Solution: 建立企業級API治理中心，制定統一的API設計標準和最佳實踐。採用API-first的協作流程，要求團隊間透過API規格進行溝通。建立API註冊中心和版本管理機制，實施強制性的API審查和核准流程。參考康威定律調整組織結構，讓系統架構與組織架構保持一致。

Example:
```yaml
# API治理框架
設計標準:
  - RESTful API設計原則
  - 統一錯誤處理格式
  - 標準化命名規範
治理流程:
  - API設計審查
  - 版本相容性檢查
  - 效能和安全檢核
工具支援:
  - API註冊中心
  - 自動化測試
  - 文件生成系統
```

### P5. API設計過度複雜或過度簡化

Problem: 團隊在API設計時難以拿捏適當的抽象層次，要不過度複雜導致使用困難，要不過度簡化無法滿足實際需求，影響API的實用性和可維護性。

Root Cause: 缺乏清晰的API邊界劃分原則，對於何時該在API層處理複雜度、何時該在應用層處理缺乏判斷標準。對於不同使用情境的需求理解不深，無法設計出適合多種應用場景的API介面。缺乏回饋機制來驗證API設計的實用性。

Solution: 建立明確的API設計原則：API專注於核心服務，複雜的組合邏輯透過SDK、Code Template或BFF處理。採用分層設計策略，提供核心API加上便利性包裝的組合。建立API可用性測試機制，透過實際使用場景驗證設計合理性。參考樂高積木模式，確保API具備良好的組合性和擴展性。

Example:
```yaml
# API設計分層策略
核心API層:
  - 提供基礎的CRUD操作
  - 專注於資料和核心邏輯
  - 保持介面穩定和簡潔
便利性包裝層:
  - SDK提供高階操作
  - BFF處理特定場景需求
  - Code Template降低使用門檻
應用整合層:
  - 特定業務流程組合
  - 客製化邏輯處理
  - UI適配和優化
```

### P6. 缺乏系統性API學習和能力建設

Problem: 團隊對於API設計、治理和管理缺乏系統性知識，主要依賴個人經驗和零散學習，難以建立企業級的API能力。

Root Cause: API相關知識涵蓋面廣，從設計模式到治理策略都需要專門學習，但市面上缺乏完整的學習路徑指引。團隊忙於日常開發工作，缺乏時間進行系統性學習。缺乏有經驗的導師或外部專家指導，學習效率低下。

Solution: 建立結構化的API學習計畫，透過讀書會等方式系統性學習業界最佳實踐。推薦三本核心書籍作為學習路徑：先讀《API Design Patterns》學習設計模式，再讀《Continuous API Management》了解治理策略，最後讀《Software Engineering at Google》學習工程文化。搭配實際專案演練，將理論知識應用到實際工作中。

Example:
```yaml
# API學習路徑規劃
第一階段: API設計基礎
  - 書籍: API Design Patterns
  - 重點: 30種常見設計模式
  - 實作: 設計核心API介面
第二階段: API治理管理  
  - 書籍: Continuous API Management
  - 重點: 生命週期和治理策略
  - 實作: 建立API註冊中心
第三階段: 工程文化建立
  - 書籍: Software Engineering at Google
  - 重點: 大規模軟體工程實踐
  - 實作: 導入API First工作流程
```

## 版本異動紀錄

### v1.1 (2025-01-03)
- 修正摘要格式，改用第三人稱敘述，加入生成工具資訊
- 完善技術堆疊分析和參考資源連結
- 調整問答集和解決方案內容，使其更貼近實際應用場景

### v1.0 (2025-01-03)
- 初始版本
