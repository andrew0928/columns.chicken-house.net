---
source_file: "docs/_posts/2020/2020-11-23-security-talk.md"
generated_date: "2025-08-03 15:00:00 +0800"
version: "1.1"
tools:
  - github_copilot
  - claude_sonnet_3_5
model: "claude-3-5-sonnet-20241022"
---

# [架構師觀點] 資安沒有捷徑，請從根本做起! - 生成內容

## Metadata

### 原始 Metadata

```yaml
layout: post
title: "[架構師觀點] 資安沒有捷徑，請從根本做起!"
categories:
- "系列文章: 架構師觀點"
tags: ["架構師", "資安"]
published: true
comments: true
redirect_from:
logo: /wp-content/images/2020-11-23-security-talk/2020-11-23-01-45-18.jpg
```

### 自動識別關鍵字

keywords:
  primary:
    - 資訊安全
    - 軟體架構設計
    - 密碼安全管理
    - 身份認證機制
    - 權限控制系統
  secondary:
    - Hash加密演算法
    - JWT Token驗證
    - Session管理
    - RBAC權限模型
    - 安全架構設計

### 技術堆疊分析

tech_stack:
  languages:
    - 通用程式語言概念
  frameworks:
    - .NET Authorization
    - JWT (JSON Web Token)
    - 加密演算法框架
  tools:
    - 密碼雜湊工具
    - 數位簽章工具
    - 安全測試工具
  platforms:
    - 分散式系統
    - Web應用程式
    - API服務

### 參考資源

references:
  internal_links:
    - /series/architect-perspective/
  external_links:
    - https://www.youtube.com/watch?v=spkUZQt_4pI&feature=emb_logo
  mentioned_tools:
    - RSA加密演算法
    - Hash函數
    - JWT Token
    - .NET Authorization
    - RBAC/PBAC/ABAC

### 內容特性

content_metrics:
  word_count: 4500
  reading_time: "25 分鐘"
  difficulty_level: "中級"
  content_type: "觀念闡述"

## 摘要 (Summaries)

### 文章摘要 (Article Summary)

作者基於業界常見的密碼儲存爭議，深入探討資訊安全在軟體開發中的根本地位與正確實踐方法。作者強調資安是品質要求而非功能需求，需要從設計階段就建立正確的安全機制，而非依賴後期的測試或補強。文章透過密碼儲存、Session管理、權限控制等具體案例，說明如何運用Hash加密、JWT Token、RBAC等成熟技術來建立可信賴的系統。作者特別指出，安全問題本質上是信任問題，必須透過正確的技術決策和架構設計來獲得使用者信任。文章強調避免自行開發安全機制的重要性，建議採用經過驗證的標準演算法和框架，並從系統設計的根本層面確保安全性，而非依賴表面的防護措施。整篇文章傳達了「品質是內建的，不是測試出來的」核心理念，為架構師和開發者提供了實用的安全設計指導原則。

### 關鍵要點 (Key Points)

- 資安是品質要求而非功能需求，需要從設計階段就納入考量而非後期補強
- 密碼儲存應使用Hash+Salt機制，完全避免儲存原始密碼以防範資料外洩風險
- JWT Token提供分散式系統中有效的身份認證解決方案，平衡安全性與效能需求
- 權限控制應採用統一的授權機制如RBAC，避免各功能獨立設計造成的安全漏洞
- 應採用成熟的加密演算法和安全框架，避免自行開發未經驗證的安全機制

### 段落摘要 (Section Summaries)

1. **功能需求與品質要求的本質差異**：作者明確區分功能需求與品質要求的根本差異，說明功能需求是正向表列的已知問題解決，而品質要求是負向表列的未知風險防範。作者指出資安屬於品質要求範疇，無法透過簡單的測試案例來驗證，必須在設計階段就建立正確的安全機制。這種認知差異直接影響開發團隊對安全問題的重視程度和處理方式。作者強調品質問題沒有捷徑，只能從根本做起，通過正確的架構設計來預防安全風險。文章以密碼儲存為例，說明正確的Hash+Salt機制如何從設計層面就杜絕密碼外洩的可能性，體現了品質要求的預防性特質。

2. **資安作為信任建立的技術基礎**：作者深入闡述資安問題的本質是信任問題，必須透過正確的技術實作來建立使用者對系統的信任。作者解釋為什麼成熟的加密演算法比自製演算法更安全，主要原因包括數學理論基礎、全球專家驗證、以及安全性依賴金鑰而非演算法保密性。作者通過統計學攻擊和程式碼保護的例子，說明自製安全機制的潛在風險和脆弱性。文章強調正確選擇演算法和金鑰長度的重要性，以及在時程壓力下仍需堅持安全標準的原則。作者特別指出，資安投資往往在短期內看不到效益，但對於建立長期信任關係至關重要。

3. **分散式系統的Session認證機制**：作者詳細分析分散式系統中Session管理的挑戰與解決方案，特別是跨服務認證的技術難題。作者說明JWT Token如何解決服務間認證的通訊成本問題，透過數位簽章機制讓各服務能夠獨立驗證Token有效性。文章以火車票驗證為類比，生動說明Token防偽機制的運作原理和重要性。作者強調每個Request都必須進行Token驗證的必要性，即使會增加CPU運算負擔，但相較於網路通訊成本仍然划算。這個段落展示了在現代微服務架構中，如何平衡安全性、效能和可擴展性的實際考量，為架構師提供了具體的技術指導。

4. **統一權限控制機制的設計原則**：作者深入探討權限管理系統的常見陷阱和正確設計方法，強調統一授權機制的重要性。作者指出權限檢查只在UI層面進行的危險性，以及共用資源在不同功能入口下的權限矛盾問題。文章建議採用成熟的權限管理模式如RBAC、PBAC、ABAC，而非各功能獨立設計權限邏輯。作者強調通用規範的重要性，規範越通用越不容易出錯，特例過多往往會在規則設計層面就存在漏洞。文章提供了實作層面的指導，包括控制資料進出關卡、統一身份識別方式、以及在每個API正確實作授權檢查。這個段落為複雜企業系統的權限設計提供了系統性的思考框架。

5. **安全設計的根本原則與實踐建議**：作者總結安全設計的核心原則，強調「品質是內建的，不是測試出來的」重要理念。作者指出高品質系統在設計開發階段就已決定其安全水準，測試只能發現缺陷而無法根本提升品質。文章建議開發者避免標新立異，應採用設計良好的框架和公認標準的模式來處理安全問題。作者強調持續學習和經驗累積的重要性，以及在面對時程壓力時仍需堅持安全標準的職業態度。這個段落不僅提供技術指導，更傳達了正確的安全文化和價值觀，幫助架構師建立長期的安全思維模式，為團隊樹立正確的安全開發標準。

## 問答集 (Q&A Pairs)

### Q1: 為什麼資安是品質要求而非功能需求？
Q: 資訊安全為什麼屬於品質要求而不是功能需求？
A: 功能需求是正向表列，透過測試案例驗證已知問題的解決。品質要求是負向表列，需要防範各種未知的攻擊和極端情況。資安問題無法透過簡單的功能測試來保證，必須在設計階段就建立正確的安全機制，確保系統在各種攻擊情境下都能維持安全。

### Q2: 密碼應該如何正確儲存？
Q: 為什麼不能儲存原始密碼，正確的密碼儲存方式是什麼？
A: 正確的做法是使用Hash+Salt機制，設定密碼時只儲存加鹽後的Hash值，驗證時將輸入密碼照同樣方式處理後比對Hash值。由於Hash是單向運算無法逆推，即使資料庫外洩也無法還原原始密碼，從根本上防範密碼外洩風險。

### Q3: 為什麼不建議自行開發加密演算法？
Q: 自行開發的加密方法為什麼不安全？
A: 自製演算法缺乏數學理論基礎和全球專家驗證，容易有未知漏洞。公開的演算法如RSA經過長期驗證，安全性來自金鑰保護而非演算法保密。自製演算法可能被統計學攻擊破解，且程式碼通常需要團隊共同維護，無法依賴保密性來確保安全。

### Q4: JWT Token如何解決分散式系統的認證問題？
Q: 在微服務架構中，JWT如何實現跨服務認證？
A: JWT包含使用者資訊和數位簽章，讓各服務能夠獨立驗證Token有效性，無需跨服務通訊確認。每個Request都需要驗證Token簽章、檢查過期時間等，雖然增加CPU運算但能避免網路通訊成本，在安全前提下提供高效的認證機制。

### Q5: 權限控制系統應該如何設計？
Q: 如何避免權限管理系統的常見陷阱？
A: 應採用統一的授權機制如RBAC，而非讓各功能獨立設計權限邏輯。權限檢查不能只在UI層進行，必須在API層面統一實作。設計通用的權限規範，避免過多特例造成規則矛盾。控制好資料進出關卡，統一身份識別方式，確保每個存取點都正確實作授權檢查。

### Q6: 如何平衡安全性與開發效率？
Q: 在時程壓力下如何堅持安全標準？
A: 安全機制應該內建在設計中而非後期補強，採用成熟的框架和標準模式可以減少開發成本。短期的時程節省往往會在後期付出更大代價，建立正確的安全文化和開發標準，讓安全成為開發流程的自然一部分，而非額外負擔。

### Q7: 什麼是統一授權機制的優勢？
Q: RBAC、PBAC、ABAC等權限模型有什麼差異？
A: RBAC基於角色的存取控制適合組織明確的環境，PBAC基於政策的控制提供更靈活的規則，ABAC基於屬性的控制支援細粒度的動態決策。統一的授權機制能避免不同功能間的權限矛盾，提供一致的安全標準，降低系統維護複雜度。

### Q8: 如何建立正確的安全開發文化？
Q: 團隊應該如何培養正確的安全意識？
A: 認知到「品質是內建的，不是測試出來的」，在設計階段就考慮安全需求。避免標新立異，採用經過驗證的安全框架和模式。建立持續學習機制，跟上安全技術發展。在組織中建立安全優先的價值觀，讓每個開發者都理解安全的重要性和實作方法。

## 解決方案 (Solutions)

### P1: 密碼儲存安全漏洞
Problem: 系統直接儲存使用者原始密碼，一旦資料庫外洩將造成大規模密碼洩露，嚴重損害使用者信任和公司商譽。
Root Cause: 將密碼儲存視為功能需求而非安全需求，缺乏對密碼保護重要性的正確認知，或為了方便密碼找回功能而採用可逆加密方式。
Solution: 實作Hash+Salt密碼儲存機制，設定密碼時將密碼加鹽後進行Hash運算並儲存Hash值，驗證時將輸入密碼進行同樣處理後比對。採用如bcrypt、scrypt等專門的密碼Hash函數，確保運算複雜度足以防範暴力破解。完全避免儲存原始密碼或可逆加密密碼。
Example: 
```
設定密碼: 原始密碼 + 隨機Salt → Hash函數 → 儲存Hash值
驗證密碼: 輸入密碼 + 相同Salt → Hash函數 → 比對Hash值
```

### P2: 分散式系統認證複雜度
Problem: 微服務架構中使用者在Service A完成認證後，Service B無法有效驗證認證狀態，導致每次跨服務呼叫都需要額外的認證確認，增加系統複雜度和延遲。
Root Cause: 傳統的Session機制依賴伺服器端狀態儲存，在分散式環境下需要額外的狀態同步機制，造成架構複雜度和通訊成本增加。
Solution: 採用JWT Token機制實作無狀態認證，Token包含使用者資訊和數位簽章，各服務可獨立驗證Token有效性。每個Request都驗證Token簽章、過期時間、發行者等資訊，確保Token未被竄改且仍在有效期內。建立統一的Token生成和驗證機制。
Example: 
```
認證流程: 使用者登入 → 驗證成功 → 生成JWT Token → 後續Request攜帶Token
驗證流程: 接收Request → 解析Token → 驗證簽章 → 檢查過期時間 → 授權存取
```

### P3: 權限控制系統安全漏洞
Problem: 系統存在權限檢查不一致的問題，部分功能缺乏適當的授權驗證，或不同功能對相同資源有矛盾的權限規則，造成安全漏洞。
Root Cause: 缺乏統一的權限管理架構，各功能模組獨立實作權限邏輯，權限檢查只在UI層進行而API層缺乏保護，共用資源的權限規則定義不清。
Solution: 建立統一的授權架構如RBAC系統，定義清楚的角色和權限對應關係。在API層面實作統一的權限檢查，確保每個資源存取都經過授權驗證。設計通用的權限規範，避免特例造成的規則矛盾。實作集中式的權限管理和稽核機制。
Example: 
```
統一授權流程: Request → 身份識別 → 角色確認 → 權限檢查 → 資源存取
權限定義: 角色 → 權限集合 → 資源對應 → 操作類型 → 存取規則
```

### P4: 自製安全機制風險
Problem: 團隊自行開發加密演算法或安全機制，看似提供了保護但實際上存在未知的安全漏洞，可能被攻擊者利用造成更大的安全風險。
Root Cause: 對安全技術的複雜性認知不足，過度自信於自製方案的安全性，缺乏對成熟安全標準的了解和應用。
Solution: 採用經過驗證的標準加密演算法如AES、RSA等，使用成熟的安全框架和函式庫。遵循業界最佳實踐，如OWASP安全指導原則。建立安全程式碼審查機制，確保安全實作的正確性。持續關注安全社群的最新發展和漏洞通報。
Example: 
```
加密實作: 選擇標準演算法 → 使用成熟函式庫 → 正確配置參數 → 安全金鑰管理
安全審查: 程式碼審查 → 安全測試 → 漏洞掃描 → 滲透測試 → 持續監控
```

### P5: 安全設計文化缺失
Problem: 團隊將安全視為可選的附加功能而非必要的品質要求，在時程壓力下經常犧牲安全標準，導致系統存在根本性的安全設計缺陷。
Root Cause: 缺乏正確的安全文化和價值觀，將安全問題視為功能需求而非品質要求，短期利益考量優於長期安全投資。
Solution: 建立「品質是內建的，不是測試出來的」安全文化，在設計階段就納入安全考量。制定明確的安全開發標準和流程，建立安全培訓機制提升團隊安全意識。將安全指標納入專案評估標準，確保安全投資得到應有重視。建立持續的安全改進機制。
Example: 
```
安全文化建立: 安全培訓 → 標準制定 → 流程整合 → 指標評估 → 持續改進
設計整合: 需求分析 → 威脅建模 → 安全設計 → 安全實作 → 安全測試 → 安全部署
```

## 版本異動紀錄

### v1.1 (2025-08-03)
- 修正摘要格式，改用第三人稱敘述，加入生成工具資訊
- 按照最新的embedding-structure.instructions.md規範重新生成
- 更新front matter格式，加入source_file、generated_date等欄位
- 調整Q&A和解決方案格式，使其更符合指令要求

### v1.0 (2020-11-23)
- 初始版本
