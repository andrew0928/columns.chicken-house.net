# 大工程: 60GB 的 DV avi 壓成 WMV

## 摘要提示
- 硬碟備份習慣: 作者偏好把檔案先堆在硬碟，定期清理後才備份，避免燒成 CD 的麻煩與冗餘。
- DV 檔案龐大: DV 一小時約近 10GB，壓縮慢、處理成本高，累積到 60GB 壓力爆表。
- 多機協作壓檔: 家用 server 與 X31 筆電夜間接力壓縮，但手動點擊流程耗時又煩。
- 自動化動機: 懶惰促進效率，驅動作者改以工具與批次檔自動化轉檔。
- 工具選用: 採用 Microsoft Media Encoder 9.0，研究後建立自動化流程。
- 批次化處理: 複製檔案到指定目錄即自動轉檔，省去人工操作。
- 五種輸出配置: 依用途輸出五種 WMV 規格，涵蓋備份、家用播放、行動裝置與網站。
- 多裝置覆蓋: 支援 DVD 級、Xbox、Pocket PC、SmartPhone、網頁串流等觀看情境。
- 成果分享: 部落格左側的影片即為網站版輸出成果，作者對自動化成效滿意。
- 工具徵求: 徵求可用命令列將 AVI 轉 MPG/MPEG-2/DivX 的工具建議。

## 全文重點
作者自述長期以硬碟集中存放、定期清理後才備份的習慣，避免頻繁燒錄 CD 所帶來的管理與使用成本。然而隨著孩子出生，照片與 DV 影片快速累積，DV 來源尤其棘手：一小時素材近 10GB、壓縮速度又慢，短時間內便在家用等級不高但硬碟特別大的個人伺服器上堆出 60GB 的龐大庫存。面對磁碟壓力與手動處理的繁瑣，作者起初讓 server 與 X31 筆電夜間輪流壓檔，但每處理完一個檔案仍需手動點擊續作，幾天就受不了。以「懶惰驅動進步」為念，作者轉而研究 Microsoft Media Encoder 9.0，並撰寫批次檔建立全自動流程：只要將 DV-AVI 檔複製進特定目錄，系統便自動進行轉檔，對每支來源影片同時輸出五種用途明確、參數預設的 WMV 版本。

五種輸出設計分別對應不同使用場景與頻寬限制：最高畫質版（720x480、2.1Mbps）留作接近 DVD 品質的長期備份；中畫質版（360x240、1.2Mbps）拷入家中 Xbox，讓家人輕鬆觀看；兩種行動裝置版本（Pocket PC 250kbps、SmartPhone 140kbps）滿足攜帶外出展示的需求；最後是網頁播放版（140kbps/65kbps）用於網站嵌入與線上分享。此一自動化機制有效將龐大的 DV 原始檔轉為可用、可分享、可保存的多目標成品，並顯著減少人工操作。作者對成果滿意，並在部落格側欄展示網站版輸出成品，同時表示若有人需要批次檔可留言索取。文末也拋出技術詢問：有無可透過命令列將 AVI 轉為 MPG/MPEG-2/DivX 的工具，以延伸目前自動化能力，避免再次受制於必須用滑鼠點擊的 GUI 流程。

## 段落重點
### 硬碟優先的備份哲學與其隱憂
作者不喜歡立刻燒 CD，認為日後搜尋、調用不便，且許多資料一旦燒錄便再也不碰，使備份顯得冗餘。因此採取「先堆硬碟、後清理、再備份」策略。此習慣在一般檔案上尚可，但面對影像素材便露出隱憂：DV 每小時近 10GB，處理慢、體積大，容易在不經意間擠爆硬碟。隨著小孩出生、影像需求大增，個人 server 雖等級普通卻配有大容量硬碟，仍迅速累積至 60GB 的 DV-AVI，逼得作者必須正視與處理。

### 手動壓檔的瓶頸與自動化的動機
起初作者讓家用 server 持續壓檔，回家後再用 X31 筆電加入戰局，希望以時間換取產出。然而每完成一支影片仍需以滑鼠手動開啟下一輪作業，流程斷點多、需要人盯，效率不彰。在連續幾天的重複勞作後，作者決定以「懶惰促進效率」為由，尋求能全自動批次轉檔的解法，將繁瑣操作交給工具與腳本處理，解放人力並穩定產出。

### Media Encoder 9.0 與批次流程設計
作者選擇 Microsoft Media Encoder 9.0 作為核心轉檔工具，花時間研究其參數與批次化可行性，最終寫出簡單批次檔：只需把 DV-AVI 檔案複製到指定目錄，系統便能自動觸發並處理，且針對同一來源同時輸出五種 WMV 規格。這些規格涵蓋不同解析度與碼率，以對應實際使用場景。整體流程無需人為介入，減少夜間看守與點擊時間，也避免遺漏或操作錯誤，讓大量素材能在背景穩定消化。

### 五種輸出用途與分享成效
五種輸出明確對應情境：最高畫質版保留近 DVD 的觀感作長期備份；中畫質版方便拷入 Xbox 給家人觀賞；Pocket PC 與 SmartPhone 版本滿足行動展示、節省儲存與頻寬；網站版則兼顧更低碼率以利線上播放與部落格嵌入。作者對成果頗為得意，部落格側欄的幾支影片即來自網站版輸出。最後作者開放提供批次檔給有需要的讀者，並徵詢可透過命令列將 AVI 轉成 MPG/MPEG-2/DivX 的工具建議，期望進一步擴充自動化版圖。

## 資訊整理

### 知識架構圖
1. 前置知識：
   - 影像基本概念：解析度、比特率、編碼格式（AVI、WMV、MPEG、DivX）
   - DV 影像特性：DV-AVI 擷取檔案體積大（約 10GB/小時）
   - Windows 平台操作：批次檔、命令列工具的基本使用
   - 儲存與備份策略：硬碟儲存、分層備份與用途分發

2. 核心概念：
   - 影片壓縮與轉檔：從 DV-AVI 壓成多種 WMV 版本以適配不同裝置
   - 批次自動化流程：以批次檔驅動 Microsoft Media Encoder 9 自動處理
   - 多情境輸出設定：依裝置與用途設定解析度/比特率（DVD 備份、家用播放、行動裝置、網站串流）
   - 儲存管理策略：先集中硬碟、定期清理與備份的個人資料管理習慣
   - 工具選擇與限制：圖形介面操作麻煩，需求為命令列可控的編碼工具

3. 技術依賴：
   - Microsoft Media Encoder 9：核心編碼與批次處理工具
   - Windows 作業系統與批次檔：監控資料夾、觸發轉檔
   - 轉碼設定檔（Profiles）：定義解析度、比特率、音視訊參數
   - 硬體資源：CPU 計算時間長、硬碟空間需求高（原始 DV 與多版本輸出）

4. 應用場景：
   - 家用影音歸檔：將 DV 家庭錄影片轉壓保存
   - 多裝置播放分發：Xbox、PDA、SmartPhone 等裝置專用版本
   - 網頁發布與串流：低碼率版本上站點分享
   - 定期批次處理：長時間背景轉碼，降低手動操作成本

### 學習路徑建議
1. 入門者路徑：
   - 了解 DV 影像大小與基本編碼概念（解析度/比特率對檔案大小與品質的影響）
   - 安裝並熟悉 Microsoft Media Encoder 9 的基本操作與預設設定檔
   - 從單一檔案手動轉檔開始，觀察輸出品質與檔案大小

2. 進階者路徑：
   - 建立自訂 Profiles（720x480 高碼率、360x240 中碼率、行動裝置低碼率）
   - 撰寫批次檔，將檔案放入指定資料夾後自動觸發 WMV 轉檔
   - 規劃儲存與命名規則，配合備份流程（高品質版留存、低碼率版分發）

3. 實戰路徑：
   - 以監控資料夾的批次流程，將 DV-AVI 自動產出 4-5 種用途版本
   - 整合家中播放器（如 Xbox）與網站後台上傳流程，形成端到端發佈
   - 監控CPU與硬碟使用率，排程夜間轉碼，避免影響白天使用

### 關鍵要點清單
- DV-AVI 體積特性: DV 擷取約 10GB/小時，長期堆積易爆硬碟 (優先級: 高)
- 多版本輸出策略: 針對不同播放情境設定多種解析度與比特率 (優先級: 高)
- Microsoft Media Encoder 9 使用: 作為核心轉檔工具與自動化引擎 (優先級: 高)
- 批次自動化流程: 以批次檔驅動，避免人工逐檔點選 (優先級: 高)
- 高品質備份版: 720x480、約 2.1 Mbps 作為 DVD 等級保存 (優先級: 中)
- 家用中碼率版: 360x240、約 1.2 Mbps 供家中裝置（如 Xbox）播放 (優先級: 中)
- 行動裝置版-PDA: 250 kbps 版本適合 PocketPC 隨身觀看 (優先級: 中)
- 行動裝置版-手機: 140 kbps 版本適合 SmartPhone (優先級: 中)
- 網站串流版: 140/65 kbps 低碼率版本適合網頁播放 (優先級: 高)
- 儲存與備份策略: 先集中硬碟、定期清理後再備份的工作流 (優先級: 中)
- 編碼效能管理: 長時間背景轉碼，善用伺服器與筆電共同分擔 (優先級: 中)
- 設定檔管理: 統一命名與參數模板，確保輸出一致性 (優先級: 中)
- 命令列工具需求: 需要可由命令列將 AVI 轉為 MPG/MPEG-2/DivX 的工具 (優先級: 高)
- 兼容性考量: 不同裝置對解析度與碼率的相容性需事前測試 (優先級: 中)
- 使用者體驗優化: 降低手動操作與等待成本，提高整體處理效率 (優先級: 低)