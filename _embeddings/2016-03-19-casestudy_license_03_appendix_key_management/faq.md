# [設計案例] 授權碼 如何實作? #3 (補) - 金鑰的保護

# 問答集 (FAQ, frequently asked questions and answers)

## Q: 使用授權碼的安全性最終取決於什麼因素？
安全性最終取決於金鑰的管理，尤其是 PRIVATE KEY 是否被妥善保管，以及客戶端取得的 PUBLIC KEY 是否正確未被掉包。

## Q: 為什麼 PRIVATE KEY 一定要嚴格保護？
因為一旦外人取得你的 PRIVATE KEY，就能冒充原廠身分，簽出任何組態的授權碼，系統將無法辨識其真偽。

## Q: 客戶為何需要取得原廠的 PUBLIC KEY？
客戶端必須用原廠的 PUBLIC KEY 來驗證授權碼的數位簽章，以確定授權碼確實由原廠簽發且內容未被竄改。

## Q: 若合作廠商將原廠的 PUBLIC KEY 偷換成自己產生的 PUBLIC KEY，會發生什麼事？
合作廠商就能用自己掌握的 PRIVATE KEY 產生假的授權碼，而客戶因使用被掉包的 PUBLIC KEY 驗證，仍會認為授權碼合法，導致整個授權機制失效。

## Q: 如何防止 PUBLIC KEY 被替換的風險？
1. 在系統（軟體／硬體／韌體）內預先內建並保護 PUBLIC KEY，例如遊戲主機利用 TPM 等機制保護金鑰。  
2. 透過公正第三方 CA 發行憑證，讓客戶可向 CA 取得正確的 PUBLIC KEY。  
3. 以「必須連回原廠」的機制強制驗證，例如線上升級、定期連線檢測或維護合約配發金鑰等。

## Q: 小型軟體開發商若無法自建完整金鑰保護體系，有哪些折衷方案？
可以：
1. 直接提供由原廠簽名的更新包，未用正確 PUBLIC KEY 的系統無法升級。  
2. 強迫系統定期連回原廠網站或 KMS 伺服器驗證。  
3. 透過實體維護合約或其它管道，人為發放並驗證金鑰。

## Q: 為何引入 CA 會增加成本與複雜度？
使用公正第三方 CA 需要支付憑證年費，且必須建置與維運整套 PKI 架構；若自行架設 CA，也需確保所有客戶都在可控範圍內並維護 CA 的安全與營運。