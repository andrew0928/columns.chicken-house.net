{
  "title": "[TxF] #2. \u5148\u4F5C\u529F\u8AB2 - \u719F\u6089 P/Invoke \u53CA Win32 \u6A94\u6848\u8655\u7406...",
  "published": true,
  "categories": [
    "\u7CFB\u5217\u6587\u7AE0: \u4EA4\u6613\u5F0F (Transactional) NTFS"
  ],
  "tags": [
    ".NET",
    "C#",
    "MSDN",
    "Transactional NTFS"
  ],
  "tech-stacks": [
    "C#",
    ".NET Framework",
    ".NET Framework 2.0",
    "C/C\u002B\u002B",
    "Windows",
    "Windows API",
    "Win32 API",
    "Transactional NTFS (TxF)",
    "P/Invoke",
    "kernel32.dll",
    "HANDLE",
    "IntPtr",
    "SafeHandle",
    "SafeFileHandle",
    "System.IO",
    "FileStream",
    "StreamReader",
    "Console",
    "Visual Studio",
    "Windows Vista",
    "Windows Server 2008",
    "Windows 7",
    "Windows Server 2008 R2"
  ],
  "keywords": [
    "P/Invoke",
    "Win32",
    "Windows API",
    "MoveFile",
    "CreateFile",
    "CloseHandle",
    "SafeHandle",
    "SafeFileHandle",
    "IntPtr",
    "FileStream",
    "System.IO",
    "HANDLE",
    "pointer",
    "unmanaged code",
    "managed code",
    "kernel32.dll",
    "Transactional NTFS",
    "TxF",
    ".NET",
    "C#",
    "MSDN",
    "enum",
    "flags"
  ],
  "generator": "BlogIndex.SyncPost v0.3.0.0, gpt-5",
  "references": [
    "/post/TxF-1-Transactional-NTFS-e5889de9ab94e9a997.aspx",
    "http://msdn.microsoft.com/en-us/library/aa446536.aspx",
    "http://msdn.microsoft.com/en-us/library/aa365239(VS.85).aspx",
    "http://msdn.microsoft.com/zh-tw/library/e59b22c5.aspx",
    "http://msdn.microsoft.com/zh-tw/library/aa984739(VS.71).aspx",
    "/images/2010-03-23-txf-2-homework-first-pinvoke-and-win32-file-handling/image_6.png",
    "/images/2010-03-23-txf-2-homework-first-pinvoke-and-win32-file-handling/image_7.png",
    "/images/2010-03-23-txf-2-homework-first-pinvoke-and-win32-file-handling/image_8.png",
    "http://go.microsoft.com/fwlink/?linkid=14202",
    "http://msdn.microsoft.com/zh-tw/library/system.runtime.interopservices.safehandle(v=VS.90).aspx",
    "http://www.pinvoke.net/index.aspx",
    "http://en.wikipedia.org/wiki/Pinvoke",
    "http://msdn.microsoft.com/zh-tw/library/fh21e17c(v=VS.90).aspx"
  ],
  "summary": "\u672C\u6587\u70BA Transactional NTFS \u7CFB\u5217\u7684\u524D\u5C0E\uFF0C\u8AAA\u660E\u5728\u5B98\u65B9\u50C5\u63D0\u4F9B Win32 API\u3001\u672A\u63D0\u4F9B\u53D7\u63A7\u7A0B\u5F0F\u5EAB\u7684\u60C5\u6CC1\u4E0B\uFF0C\u65BC C# \u4E2D\u5FC5\u9808\u900F\u904E P/Invoke \u547C\u53EB\u975E\u53D7\u63A7\u7A0B\u5F0F\u78BC\u4F86\u9032\u884C\u6A94\u6848\u64CD\u4F5C\u3002\u6587\u7AE0\u5148\u4EE5 MoveFile \u70BA\u5165\u9580\u7BC4\u4F8B\uFF0C\u5C55\u793A\u4EE5 DllImport \u5BA3\u544A kernel32.dll \u7684 API \u4E26\u5728 C# \u4E2D\u547C\u53EB\uFF0C\u63A5\u8457\u9032\u4E00\u6B65\u793A\u7BC4\u4EE5 CreateFile \u53D6\u5F97\u6A94\u6848 HANDLE\uFF0C\u4E26\u900F\u904E IntPtr \u50B3\u5165 FileStream \u8B80\u53D6\u6A94\u6848\u5167\u5BB9\uFF0C\u8AAA\u660E managed \u8207 unmanaged \u4E16\u754C\u4E4B\u9593\u4EE5\u6307\u6A19\u8207 HANDLE \u6E9D\u901A\u7684\u65B9\u5F0F\u3002\u6587\u4E2D\u6307\u51FA .NET Framework 2.0 \u8D77\u5DF2\u4E0D\u5EFA\u8B70\u4F7F\u7528\u63A5\u53D7 IntPtr \u7684 FileStream \u5EFA\u69CB\u5F0F\uFF0C\u6539\u7528 SafeFileHandle \u4EE5\u63D0\u5347\u8CC7\u6E90\u56DE\u6536\u8207\u5B89\u5168\u6027\uFF0C\u4E26\u4ECB\u7D39 SafeHandle/SafeFileHandle \u7684\u6982\u5FF5\u8207\u95DC\u9589\u8CC7\u6E90\u7684\u6B63\u78BA\u4F5C\u6CD5\u3002\u4F5C\u8005\u5F37\u8ABF\uFF0C\u638C\u63E1 P/Invoke \u5E38\u898B\u578B\u5225\u5C0D\u61C9\u3001HANDLE \u8207\u65D7\u6A19\u53C3\u6578\u7B49\u5BE6\u52D9\u6280\u5DE7\uFF0C\u5C31\u80FD\u7406\u89E3\u591A\u6578 TxF \u7684\u4F7F\u7528\u65B9\u5F0F\uFF1B\u6587\u672B\u63D0\u4F9B\u5BE6\u7528\u53C3\u8003\u8CC7\u6E90\uFF08PINVOKE.NET\u3001MSDN \u7684 MoveFile \u8207 SafeHandle \u6587\u4EF6\u3001Wikipedia \u7684 P/Invoke \u4ECB\u7D39\uFF09\uFF0C\u4E26\u9810\u544A\u4E0B\u7BC7\u5C07\u793A\u7BC4\u9996\u500B\u4EA4\u6613\u5F0F\u6A94\u6848\u8655\u7406\u7BC4\u4F8B\uFF0C\u63D0\u9192\u8B80\u8005\u6E96\u5099\u652F\u63F4 TxF \u7684 Windows \u7248\u672C\u3002"
}