# (TBD) 權限管理機制的設計

# 問答集 (FAQ, frequently asked questions and answers)

## Q: 向量資料庫無法直接提供 record-level 權限時，官方建議用什麼方式來實作使用者層級的授權？
官方做法是在每筆文件（memory record）上加上 metadata「Tags」，並在查詢時透過 filter 條件過濾。例如替文件加上 `UserId`、`Role`、`Catalog`…等標籤，查詢時帶入 `filters:{ "catalog":["C05"] }` 之類的條件，就只會取得使用者被授權範圍內的向量結果。

## Q: 為什麼大量的事前索引、分析會和「個人化／資訊安全」需求產生衝突？
因為索引與統計是在「不知道當下查詢者是誰」的情況下預先完成的。若不同使用者對同一份資料有不同可見範圍，預先產生的索引就無法區分誰能看、誰不能看；若在搜尋結果中誤把未授權片段顯示給使用者，就會造成敏感資訊外洩。

## Q: RBAC（Role-Based Access Control）如何透過角色與文件分類來降低權限管理複雜度？
把「人」歸納成少量角色，把「文件」歸納成少量分類，再定義「角色 × 分類」矩陣即可。原本 100 人 × 5000 文件需管理 500,000 個布林設定；若只用 5 個角色與 20 個分類，權限組合立即降到 5 × 20 = 100 條規則即可維護。

## Q: 在 100 位員工、5000 份文件的情境下，採用 5 個角色與 20 個分類後，權限組合會從多少減少到多少？
會從 100 × 5000 = 500,000 種布林設定，降低成 5 × 20 = 100 種設定，大幅減少維護工作量與儲存成本。

## Q: 在 NoSQL 或向量資料庫中，應如何以 Tag 與 Filter 實踐 RBAC 過濾？
1. 在文件上加 tag，例如  
   `{ ..., "tags":{ "catalog":["C01","C05"] } }`  
2. 在應用程式端先查出使用者所屬角色可存取的 catalog 清單。  
3. 查詢時把該清單直接帶入 filter，例如  
   `filters:{ "catalog":["C05"] }`。  
由於 tag 數量有限且可索引，查詢仍可在數十~數百毫秒內完成，同時確保僅回傳被授權的文件或向量結果。