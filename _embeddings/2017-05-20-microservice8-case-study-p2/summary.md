# 架構師觀點 - 轉移到微服務架構的經驗分享 (Part 2)

## 摘要提示
- 微服務導入門檻: 微服務先天複雜，需先做 POC 驗證並循序漸進。
- 系統現況評估: 舊有人資 e-Learning 系統因單體式架構導致維護、部署、雲端化皆困難。
- 一窩蜂驅動風險: 盲目追新技術易失敗，必須有計畫與替代方案。
- 架構師角色: 需具備實作能力，以程式碼與團隊溝通並控制風險。
- 重構而非重寫: 透過漸進重構小步快跑，保留既有穩定功能。
- 服務切割策略: 依商業價值與痛點排序，先拆 Content、檔案、通訊三大區塊。
- Courseware Service: 將原 CDN 擴充為具認證、計費、加密的獨立教材服務。
- Subversion 應用: 以集中版控解決教材版本、同步、備援與自動化問題。
- Message Queue: 以 MSMQ+Worker 建即時、非同步、可靠的服務間通訊。
- Think Big, Start Small: 確立長期藍圖，挑最有 ROI 的項目先做。

## 全文重點
本文延續 Part 1，作者以實際專案分享如何將十多年歷史、典型 ASP.NET + SQL Server 的大型單體式人資 e-Learning 平台，分階段導入微服務。首先審視原系統已因程式碼耦合、整包部署、無法彈性擴充而面臨維運瓶頸，且同時需支援 On-Premise 與 SaaS，故決定以「降低維護與雲端化難度」為首要目標。  
作者強調勿「一窩蜂驅動開發」：對新技術保持好奇沒錯，但過度自信、缺計畫、沒替代方案將導致專案失敗。因而採取「保守漸進」策略：大量 Spikes/POC 驗證、先挑高投報項目、由具實戰能力的架構師領導，並選擇重構取代重寫，以持續交付降低風險。  
在架構調整上，作者重新界定服務邊界並拆出三個關鍵元件：  
1) Content Service 從單純 CDN 升級為 Courseware Service，整合教材發佈 API、OAuth 認證、學習紀錄、HLS+AES 加解密與獨立資料庫，使其成為可獨立營運的 PaaS 級服務。  
2) 以 Subversion 取代傳統檔案伺服器，利用集中版控天生的版本差異儲存、壓縮、存取權限與網路傳輸機制，簡化教材版本管理、同步與備援。  
3) 以 MSMQ 為基礎建構 Message Queue + Worker 的 RPC 機制，解決 REST 被動、同步、長連線、點對點等限制，提供非同步、重送、發布/訂閱等可靠通訊能力。  
最後總結三項規劃核心：a) 如何切割可獨立部署的服務；b) 哪些功能可用成熟第三方服務替代；c) 需先建立哪些基礎建設（如 MQ、Reverse Proxy）。貫徹 Think Big-Start Small 的原則，才能讓系統與組織同步成長，為後續容器化與全面微服務鋪路。

## 段落重點
### 實際轉移案例
作者先說明微服務轉型的基本門檻與風險，選擇透過大量 POC 驗證，自下而上逐步拆分。案例系統為十多年歷史的 ASP.NET 單體 e-Learning 平台，功能龐大、模組耦合嚴重，維護、布署、雲端化與可用性皆陷入瓶頸。優先目標鎖定「降低維護複雜度」及「簡化雲端部署」，並列出四大痛點：維護困難、雲端化困難、部署困難及可靠度不足。基於規模與人力現實，決定僅落實對商業最有利的微服務做法，而非一次到位。

### 一窩蜂驅動開發!!
引用〈一窩蜂驅動開發〉一文提醒：好奇、樂觀、熱血雖好，但若過度自信、缺乏評估就導入新技術，易使團隊陷入困局。避免方法包含：1) 快速 Spikes 驗證關鍵假設；2) 僅在高 ROI 時才投資；3) 依賴具紮實技術底與實作能力的架構師。作者分享自己利用一週將小模組改成微服務 + Container 的實驗過程，並強調架構師必須能寫程式，才能以 Code 與團隊溝通、贏得信任，並在 POC 階段快速失敗、降低正式導入風險。

### 回到微服務化，我們最後做了那些改變?
重新審視原 WEB + DB + FileServer 架構的落伍之處後，作者提出三大設計目標：服務細粒度、布署彈性（Hybrid Cloud）、充分利用雲端資源與商業模式。據此規劃出新的多服務藍圖，並把關鍵工作聚焦於 Courseware、版本儲存、服務間通訊三個核心。

### Content Service 從單純的 CDN 升級為 Courseware Service
將原僅負責靜態檔案分流的 Content Server，重構為能獨立營運的 Courseware Service。新服務整合教材上傳/發佈 API、OAuth 使用者驗證、閱讀紀錄與計費、HLS+AES 串流加密與專屬 SQL DB；所有客戶系統皆透過 API 存取，達到 Single-Responsibility 與獨立部署，可視為平台級 PaaS 元件。

### 採用 SVN (subversion) 來取代原有的 file server
因教材需版本控制、差異儲存、權限與安全傳輸，傳統目錄＋Robocopy/DFS 難維護且成本高。作者評估多種方案後決定用集中式 Subversion：除了節省雲端儲存費用，還能利用現成 API 進行自動化、備份與異地備援。相比自行開發檔案庫，SVN 具有成熟生態、低風險、高效益，符合「善用成熟服務」原則。

### 系統之間的通訊方式，採用 Message Queue
REST 點對點同步呼叫無法滿足長時間、即時通知、重送與廣播需求，因此在關鍵流程以 MSMQ + Worker 實作 RPC 機制。好處包括：非同步處理降低前端等待、訊息持久化增強可靠度、可支援發布/訂閱、多消費者與重試機制，亦為日後事件驅動架構奠基。

### 小結 - 微服務架構規劃的要點
作者自評目前仍屬「Microservice-Ready」階段，並重申規劃三要素：1) 服務切割與邊界劃分；2) 能否用成熟服務替代自建；3) 先佈建共通基礎設施（MQ、Reverse Proxy 等）。遵循 Think Big-Start Small，可讓系統隨組織與商業模式演進，且每一步都具備明確回報與可逆性，為後續容器化與全面微服務化（Part 3）奠定基礎。

### 相關資源與後續
文末附上 DevOps Meetup 投影片與活動紀錄連結，並預告下一篇將深入探討微服務基礎建設與容器化部署考量。