# 換了四核心，MCE就掛了...

## 問題與答案 (FAQ)

### Q&A 類別 A: 概念理解類

A-Q1: 什麼是 Windows Media Center（MCE）？
- A簡: MCE 是 Windows 的多媒體中心，整合電視錄影、播放與遙控介面。
- A詳: Windows Media Center（MCE）是 Windows（如 Vista）提供的家庭多媒體中心，整合電視收看、錄影、回放、媒體庫與遙控器操作。其特色是無縫整合 Windows Media 播放與錄影（如 .dvr-ms），並對受保護內容遵循 DRM 規則。適用於客廳電腦或具電視卡的桌機，提供電視錄影後的時移與延後觀看。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: A-Q2, A-Q3, B-Q1

A-Q2: 什麼是 .dvr-ms 錄影格式？
- A簡: .dvr-ms 是 MCE 的電視錄影封裝格式，可能含 DRM 保護。
- A詳: .dvr-ms 為 MCE 早期使用的錄影檔格式，封裝 MPEG-2 視訊與音訊、節目資訊與時間索引。若內容提供者啟用保護旗標，檔案會套用 Windows Media DRM，導致播放需通過授權檢查。優點是時間位移支援佳；限制是受保護檔案綁定裝置與授權環境。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: A-Q3, B-Q5, D-Q2

A-Q3: 什麼是 Windows Media DRM？
- A簡: 微軟的數位版權管理機制，用以保護受限制的媒體播放。
- A詳: Windows Media DRM 是微軟用於媒體內容的加解密與授權機制，透過金鑰、授權伺服器與用戶端安全元件，判定內容是否可播放。它會檢查裝置的硬體指紋與個別化狀態，確保授權與裝置綁定一致。應用於受保護的音樂、影片與 MCE 錄影等情境。
- 難度: 初級
- 學習階段: 核心
- 關聯概念: A-Q4, A-Q5, B-Q2

A-Q4: 什麼是 Indiv01.key？
- A簡: 用戶端 DRM 個別化金鑰檔，代表此電腦的唯一識別。
- A詳: Indiv01.key 是 Windows Media DRM 個別化（individualization）產生的用戶端金鑰檔，內含此電腦專屬的識別與安全組件資訊。播放受保護內容時，系統會用它驗證授權綁定。若硬體組態變動（例：CPU 核心數變化），此識別可能失效，導致播放被拒或發生錯誤。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q5, B-Q3, D-Q4

A-Q5: 什麼是 DRM 的「個別化」（Individualization）？
- A簡: 為每台電腦建立專屬 DRM 安全元件與金鑰的過程。
- A詳: 個別化是 DRM 用戶端初始化流程，從微軟服務下載安全元件，並依電腦硬體組態產生獨特金鑰（如 Indiv01.key）。其特點是將授權使用綁定到特定裝置。應用場景包括首次播放受保護內容、重建 DRM 環境，或硬體變更後的重新設定。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q4, B-Q2, B-Q8

A-Q6: 為什麼更換 CPU 會影響 DRM？
- A簡: DRM 以硬體指紋綁定授權，CPU 變更會改變指紋。
- A詳: Windows Media DRM 會以硬體組態建立裝置指紋，CPU 核心數與型號屬於可能參與的因素之一。更換 CPU（例如由雙核換為四核）會使指紋不同，系統視為新裝置，原授權不再匹配，導致播放受保護內容時被拒或異常中止。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: B-Q4, B-Q6, D-Q1

A-Q7: 四核心與雙核心在 DRM 上的差異是？
- A簡: 差異不在核心本身，而在指紋變動引發授權不匹配。
- A詳: 對 DRM 而言，四核或雙核並無「可播/不可播」的本質差異；關鍵在於硬體指紋是否改變。當從雙核換成四核時，CPU 可用核心數不同，若屬指紋計算的一部分，便會導致授權認為裝置已更換，需要重新個別化與重新授權。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: A-Q6, B-Q6, B-Q4

A-Q8: 為什麼 MCE 與 Windows Media Player 都會受影響？
- A簡: 兩者共用 Windows Media DRM 安全元件，授權失效則同掛。
- A詳: MCE 與 Windows Media Player（WMP）在播放受保護內容時，皆呼叫相同的 Windows Media DRM 安全元件與授權檢查。因此一旦 DRM 個別化或授權綁定失效，不論在 MCE 或 WMP 播放 .dvr-ms 或其他受保護檔，結果皆會一致地被拒或崩潰。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: B-Q1, B-Q9, D-Q3

A-Q9: General Protection Failure（GPF）是什麼？
- A簡: 傳統保護錯誤，應用程式存取違規導致崩潰。
- A詳: General Protection Failure 是應用程式執行時發生的存取違規或保護錯誤，常由不預期的例外、元件衝突或錯誤處理不足引起。在本文案例中，播放路徑進入 DRM 驗證環節後失敗，應用層呈現 GPF 式崩潰畫面，並顯示錯誤模組線索。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: D-Q2, B-Q12, B-Q7

A-Q10: 為什麼有些人換 Q9300 後不會出問題？
- A簡: 可能未播放受保護檔，或已重新個別化與授權。
- A詳: 是否出問題取決於「是否播放受保護內容」與「DRM 狀態」。若播放的錄影不含 DRM，或系統已自動或手動完成個別化與授權重建，就能正常播放。因此同樣換 Q9300，有人正常、有人成功重建、有些才遇到拒播或崩潰。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: A-Q2, A-Q5, B-Q11

A-Q11: MCE 錄影的保護機制如何決定？
- A簡: 依節目來源的保護旗標與授權策略決定是否套 DRM。
- A詳: MCE 是否為錄影加上 DRM，取決於內容提供者/廣播方的保護旗標與地區規範。使用者多半無法任意關閉此保護。若旗標開啟，MCE 會將錄影存為 .dvr-ms 並套用 DRM；反之則為未受保護的檔案，跨裝置播放彈性較高。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q2, B-Q5, D-Q6

A-Q12: Codec 與 DRM 有何差異？
- A簡: Codec 解碼資料；DRM 控制授權。兩者各司其職。
- A詳: Codec（編解碼器）負責將壓縮的影音資料解碼為可播放訊號；DRM 負責權限與授權檢查，決定是否允許解碼與輸出。受保護內容會在解碼前先通過 DRM 驗證。若 DRM 失效，即使 Codec 正常也會拒播或崩潰。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: B-Q1, B-Q10, D-Q3

A-Q13: 硬體指紋在 DRM 中扮演什麼角色？
- A簡: 做為授權綁定的依據，用以辨識裝置的「唯一性」。
- A詳: DRM 會用硬體指紋（由多項硬體屬性組成的摘要）辨識裝置，確保授權僅在授權的環境中生效。當指紋變動超出容忍範圍（如 CPU 核心數改變），系統會視為不同裝置，要求重新個別化與授權，否則拒絕播放受保護內容。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q6, B-Q4, B-Q16

A-Q14: 在 Vista 中使用 MCE 的核心價值是什麼？
- A簡: 客廳化體驗：整合錄影、回看、遙控與媒體管理。
- A詳: Vista MCE 提供易用的客廳式操作體驗，整合電視節目錄影、媒體庫、遙控器支援與 Windows 生態系。其價值在於「一體化」與「家庭使用情境」：單一介面處理看電視、錄影與回放，並於支援情境下保障內容權益。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: A-Q1, A-Q2, B-Q10

A-Q15: 為什麼需要 DRM？
- A簡: 保障內容授權與使用規則，避免未經授權的散佈。
- A詳: DRM 的目的在平衡使用者觀看需求與內容方權益，透過授權、裝置綁定與加密，限制未授權的複製與播放。於廣播與隨選內容中，DRM 讓提供者能定義使用範圍（裝置數、期限），也促成合法數位內容的商業模式。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: A-Q3, A-Q11, B-Q2

A-Q16: Indiv01.key 損毀或不匹配會有何影響？
- A簡: 受保護內容無法播放，應用程式可能崩潰或拒播。
- A詳: 當 Indiv01.key 損毀、遺失或與目前硬體指紋不匹配時，DRM 驗證無法通過，受保護的 .dvr-ms 或其他內容被拒播放。依應用程式錯誤處理差異，可能是彈出錯誤、停用播放，或如案例般顯示 GPF 而崩潰。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q4, D-Q4, B-Q12

A-Q17: 重新個別化對使用者意味著什麼？
- A簡: 重建 DRM 環境，清除舊授權並重新取得播放權。
- A詳: 重新個別化會重置 DRM 用戶端安全元件與金鑰，等同清空既有授權狀態。之後需依來源服務重新取得授權，受保護內容才可播放。優點是快速恢復可用性；代價是需重新授權、可能影響既有檔案可播放性。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: B-Q8, B-Q11, D-Q5

A-Q18: 硬體更換與重灌的關係是什麼？
- A簡: 大幅硬體變更可能等同新機，重灌或重建授權皆需評估。
- A詳: 在 DRM 與某些授權機制眼中，重大硬體變更（如 CPU、主機板）可能等同「換了一台機器」。因此即使不重灌 OS，仍須重建 DRM 或重新授權。若變更廣泛或系統不穩，重灌也成為一種選項，但成本較高。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: D-Q8, C-Q2, B-Q16

A-Q19: KB891664 是什麼？
- A簡: 微軟說明硬體變更導致 Windows Media DRM 失效的知識庫。
- A詳: KB891664 是微軟的支援文件，說明當電腦硬體變動後，Windows Media DRM 可能無法運作，並提供清除與重建（個別化）步驟。依其流程操作後，系統會重新產生金鑰並需要重新取得授權，恢復受保護內容播放。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: B-Q8, C-Q1, D-Q5

A-Q20: 此案例的關鍵學習點是什麼？
- A簡: CPU 變更致 DRM 綁定失效；重建 DRM 即可恢復播放。
- A詳: 更換 CPU（雙核→四核）改變硬體指紋，導致 DRM 個別化金鑰與授權不匹配，MCE/WMP 播放受保護錄影時崩潰。依 KB891664 清除並重建 DRM，再重新取得授權即可解決。前置規劃與風險意識可減少排障時間。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: D-Q1, C-Q1, B-Q4

### Q&A 類別 B: 技術原理類

B-Q1: MCE 播放受保護內容時如何與 DRM 互動？
- A簡: 播放前先呼叫 DRM 驗證授權，通過後才交由 Codec 解碼。
- A詳: 技術原理說明：MCE 透過多媒體堆疊（如 DirectShow）建立播放管線，遇到受保護內容時，先由 Windows Media DRM 安全元件驗證授權。關鍵流程：1) 讀取檔頭與保護資訊；2) 驗證個別化金鑰；3) 與授權檔比對；4) 放行解碼。核心組件：DRM 安全元件、Indiv01.key、封裝分離器、解碼器與渲染器。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q8, B-Q10, B-Q2

B-Q2: Windows Media DRM 的授權驗證流程為何？
- A簡: 以個別化金鑰與授權檔比對裝置指紋，合格才解密播放。
- A詳: 技術原理說明：DRM 使用對稱/非對稱金鑰保護內容金鑰，播放時以裝置個別化金鑰解封授權。關鍵流程：1) 檢查個別化狀態；2) 載入授權；3) 驗證硬體綁定；4) 釋放內容金鑰；5) 解密串流。核心組件：個別化金鑰（Indiv01.key）、授權存放、授權伺服器通訊模組。
- 難度: 高級
- 學習階段: 進階
- 關聯概念: A-Q3, A-Q5, B-Q8

B-Q3: Indiv01.key 的生成機制是什麼？
- A簡: 個別化過程依硬體資訊產生裝置專屬金鑰與安全元件。
- A詳: 技術原理說明：個別化服務從伺服端下發安全元件，客端蒐集硬體資訊計算裝置指紋，生成專屬金鑰。關鍵流程：1) 連線個別化服務；2) 下載安全組件；3) 彙整硬體屬性；4) 生成與保存金鑰。核心組件：個別化服務、用戶端安全庫、硬體指紋計算模組。
- 難度: 高級
- 學習階段: 進階
- 關聯概念: A-Q4, A-Q5, B-Q13

B-Q4: 硬體變更如何觸發 DRM 拒播？
- A簡: 指紋比對失敗即視為新裝置，授權不匹配而拒絕播放。
- A詳: 技術原理說明：DRM 將授權與裝置指紋綁定，播放時比對當前指紋與授權中的綁定摘要。關鍵流程：1) 擷取現況硬體摘要；2) 與授權綁定比對；3) 超出容忍即標記失配；4) 中止解密。核心組件：硬體指紋模組、授權驗證器、錯誤回報機制。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q6, A-Q13, D-Q1

B-Q5: .dvr-ms 的封裝與保護如何運作？
- A簡: 以 ASF/時間索引封裝串流，視旗標套用 DRM 保護。
- A詳: 技術原理說明：.dvr-ms 基於 ASF 容器封裝影音串流與節目中繼資料，支援時間位移。關鍵流程：1) 錄製時封裝串流；2) 寫入節目與時間索引；3) 若旗標啟用，綁定 DRM。核心組件：封裝器、時間索引、DRM 標記與授權關聯。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q2, A-Q11, B-Q1

B-Q6: 為何更換 CPU 核心數會改變硬體指紋？
- A簡: 指紋可能包含 CPU 屬性，核心數改變導致摘要不同。
- A詳: 技術原理說明：硬體指紋由多項屬性組合計算（可能含 CPU 型號、核心數）。核心數變化等於輸入參數更動，摘要改變。關鍵流程：1) 收集 CPU 屬性；2) 產生摘要；3) 與授權綁定比對。核心組件：CPU 屬性收集器、指紋哈希模組、授權驗證器。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q7, A-Q6, B-Q4

B-Q7: 當 MCE 當機時，錯誤模組如何判讀？
- A簡: 讀取錯誤對話框或記錄，鎖定模組名稱判斷環節。
- A詳: 技術原理說明：崩潰報告包含故障模組與偏移。關鍵流程：1) 擷取錯誤畫面/詳細資訊；2) 辨識模組（如 Indiv01.key）；3) 對照元件功能；4) 縮小範圍至 DRM 或解碼。核心組件：錯誤回報器、事件檢視器、符號/模組對照表。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: A-Q9, D-Q2, C-Q4

B-Q8: 何謂 DRM 清除與重建（重個別化）流程？
- A簡: 清空舊授權與金鑰，重新下載安全元件與產生金鑰。
- A詳: 技術原理說明：重設 DRM 會刪除既有授權存放與個別化金鑰，再次連線個別化服務重建。關鍵流程：1) 清除授權與金鑰；2) 連線個別化；3) 下載安全元件；4) 產生新金鑰。核心組件：授權存放、個別化服務、用戶端安全庫。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q17, A-Q19, C-Q1

B-Q9: 為何 WMP、MCE、MPC 會同時受影響？
- A簡: 共用底層 DRM 與解碼管線，DRM 失效則皆失敗。
- A詳: 技術原理說明：不同播放器（含第三方）若走同一解碼與 DRM 管線，將共享 DRM 組件狀態。關鍵流程：1) 建立播放管線；2) 檢查 DRM；3) 狀態共用導致一致結果。核心組件：DRM 安全元件、封裝分離器、DirectShow/Media Foundation 節點。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q8, B-Q1, D-Q3

B-Q10: Vista 下的多媒體堆疊怎麼設計？
- A簡: 以 DirectShow/Media Foundation 組管線，串接封裝、解碼、DRM。
- A詳: 技術原理說明：Vista 使用 DirectShow 與 Media Foundation 組合播放管線。關鍵流程：1) 檔案來源與封裝分離；2) DRM 驗證；3) 解碼；4) 渲染輸出。核心組件：Source Filter、Splitter、DRM SE、Decoder、Renderer、MCE UI 層。
- 難度: 高級
- 學習階段: 進階
- 關聯概念: B-Q1, B-Q9, A-Q12

B-Q11: 重新個別化後授權如何重新取得？
- A簡: 依內容來源重新抓取授權，方可解密播放。
- A詳: 技術原理說明：重個別化清空授權，播放時需向授權伺服器或供應者流程請領。關鍵流程：1) 啟動播放；2) 觸發授權請求；3) 驗證資格；4) 儲存新授權。核心組件：授權伺服器、授權客戶端、受保護內容之授權連結。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q17, D-Q6, C-Q7

B-Q12: DRM 失效時應用程式可能呈現哪些行為？
- A簡: 拒播、顯示授權錯誤、或直接崩潰，視錯誤處理而定。
- A詳: 技術原理說明：DRM 驗證失敗後，應用可選擇中止播放、提示修復或異常終止。關鍵流程：1) 驗證失敗信號；2) 應用層處理分支；3) 回傳錯誤或 crash。核心組件：DRM 錯誤碼、應用錯誤處理器、例外攔截器。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: A-Q9, D-Q2, D-Q3

B-Q13: 微軟安全元件更新與個別化的關聯是什麼？
- A簡: 個別化會抓取最新安全元件，確保 DRM 正常運作。
- A詳: 技術原理說明：個別化不僅生成金鑰，也同步更新 DRM 安全組件。關鍵流程：1) 檢查版本；2) 下載更新；3) 登錄新元件；4) 驗證環境。核心組件：個別化服務、版本檢查器、安全組件安裝器。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: B-Q3, B-Q8, C-Q1

B-Q14: 為何錯誤模組可能顯示 Indiv01.key 而非 DLL？
- A簡: 崩潰點涉及 DRM 金鑰與安全元件，報告以金鑰檔名呈現。
- A詳: 技術原理說明：當錯誤發生於與金鑰交互的安全元件，崩潰報告可能抓到關鍵資源名（如 Indiv01.key）。關鍵流程：1) 元件存取金鑰；2) 遇到不匹配或例外；3) 報告模組名。核心組件：DRM SE、金鑰存取層、錯誤回報器。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q4, B-Q7, D-Q4

B-Q15: 事件檢視器在此議題可提供哪些線索？
- A簡: 崩潰來源、錯誤碼、模組名與時間序列，有助定位。
- A詳: 技術原理說明：Windows 事件檢視器記錄應用錯誤與系統事件。關鍵流程：1) 開啟應用程式/系統記錄；2) 尋找 MCE/WMP 錯誤；3) 檢視故障模組、錯誤碼；4) 比對操作時間。核心組件：EventLog、應用錯誤事件、WER 報告。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: B-Q7, C-Q4, D-Q2

B-Q16: 不同硬體變更對 DRM 的影響類型？
- A簡: 小變更可能無感；大變更（CPU/主機板）常觸發重個別化。
- A詳: 技術原理說明：DRM 以多參數計算指紋，變更幅度與類型影響比對結果。關鍵流程：1) 評估變更（CPU、板、儲存）；2) 重算指紋；3) 超標即要求重個別化。核心組件：指紋計算、差異評分、授權驗證器。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q18, B-Q4, C-Q2

B-Q17: 什麼是授權綁定（device binding）？
- A簡: 將內容授權鎖定於特定裝置指紋以限制播放範圍。
- A詳: 技術原理說明：授權綁定把解密權限與裝置指紋關聯，避免任意複製。關鍵流程：1) 採集指紋；2) 授權寫入綁定；3) 播放時比對。核心組件：授權檔、指紋模組、驗證器。此機制是案例中換 CPU 後需重建的根源。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: A-Q13, B-Q2, B-Q4

B-Q18: 什麼是受保護的播放路徑（Protected Path）？
- A簡: 對內容解密與輸出提供防護的系統級路徑。
- A詳: 技術原理說明：受保護路徑確保解密後的媒體僅在可信組件鏈中流動。關鍵流程：1) DRM 驗證；2) 解碼於可信環境；3) 安全輸出。核心組件：DRM 安全元件、受信任解碼器、輸出保護。此機制使得各播放器共享相同限制。
- 難度: 高級
- 學習階段: 進階
- 關聯概念: B-Q10, B-Q9, A-Q12

B-Q19: 為何重啟（reboot）是修復流程中的必要步驟？
- A簡: 釋放被鎖定的安全元件，重新載入新的 DRM 狀態。
- A詳: 技術原理說明：DRM 安全元件與播放管線可能常駐記憶體或鎖定檔案。關鍵流程：1) 清除/替換檔案；2) 重啟釋放鎖定；3) 以新元件與金鑰啟動。核心組件：檔案鎖定機制、服務常駐程序、啟動載入器。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: C-Q1, D-Q5, B-Q8

B-Q20: 此案例的技術診斷策略是什麼？
- A簡: 讀錯誤→定位模組→搜尋知識庫→重建 DRM→驗證。
- A詳: 技術原理說明：以故障模組為線索，快速映射到 DRM。關鍵流程：1) 觀察 GPF 介面與 Detail；2) 發現 Indiv01.key；3) 搜尋 KB891664；4) 依流程重建；5) 驗證播放。核心組件：錯誤回報、知識庫、個別化服務、播放器。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: A-Q20, C-Q5, D-Q1

### Q&A 類別 C: 實作應用類（10題）

C-Q1: 如何依 KB891664 清除並重建 DRM？
- A簡: 依 KB 步驟清空授權與金鑰，重新個別化並再取授權。
- A詳: 具體實作步驟：1) 關閉所有播放器；2) 依 KB891664 清除 DRM 授權與金鑰；3) 連線個別化服務重建；4) 重啟；5) 重新播放以觸發授權取得。關鍵設定：照 KB 指示操作，勿手動刪除未知檔。注意事項：清除會使既有受保護內容需重新授權；操作前確認網路可用與時間正確。
- 難度: 初級
- 學習階段: 核心
- 關聯概念: A-Q19, B-Q8, D-Q5

C-Q2: 更換 CPU 前如何準備以降低播放中斷風險？
- A簡: 先評估受保護內容、備妥網路與時間、預留重建時段。
- A詳: 具體實作步驟：1) 檢視是否仰賴受保護錄影；2) 排定維護時段；3) 準備 KB891664 指引；4) 更換後立即測試播放。關鍵設定：同步時鐘、確保網路可連外。注意事項：必要時告知家人停機影響；避免同時更換多組硬體以利定位。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: A-Q18, B-Q16, D-Q9

C-Q3: 如何確認某 .dvr-ms 是否受 DRM 保護？
- A簡: 嘗試跨裝置播放或檢視屬性，看是否需授權方能播放。
- A詳: 具體實作步驟：1) 於同機 WMP 播放觀察是否觸發授權提示；2) 嘗試移至另一台機器播放；3) 檢視檔案屬性/詳細資訊。關鍵設定：使用原系統帳號測試。注意事項：不可任意解密；確認來源授權政策；判斷僅作維運用途。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q2, A-Q11, B-Q5

C-Q4: 如何檢查錯誤模組與蒐集線索？
- A簡: 讀取錯誤詳情與事件檢視器，聚焦故障模組名稱。
- A詳: 具體實作步驟：1) 觸發錯誤後點選詳細資訊；2) 記錄模組名（如 Indiv01.key）；3) 打開事件檢視器查應用程式日誌；4) 對照時間與錯誤碼。關鍵設定：保留螢幕截圖。注意事項：避免過度安裝解碼包干擾；先定位再行變更。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: B-Q7, B-Q15, D-Q2

C-Q5: 如何驗證重建 DRM 後播放已恢復？
- A簡: 以相同檔案於 MCE/WMP 測試，確認無授權錯誤與崩潰。
- A詳: 具體實作步驟：1) 重啟後先用 WMP 播放受保護檔；2) 再用 MCE 播放相同檔案；3) 新錄一段內容測試。關鍵設定：確保網路與時間正確。注意事項：若仍失敗，重複個別化步驟並檢視錯誤碼，避免同時啟動多播放器。
- 難度: 初級
- 學習階段: 核心
- 關聯概念: B-Q11, D-Q5, D-Q6

C-Q6: 如何用 MCE 與 WMP 的差異來定位問題？
- A簡: 兩者同失敗偏向 DRM；僅 MCE 失敗可能為 UI/外掛問題。
- A詳: 具體實作步驟：1) 同檔於 WMP、MCE 各播一次；2) 比較錯誤訊息；3) 若皆失敗且涉 Indiv01.key，優先走 DRM 修復。關鍵設定：使用相同使用者。注意事項：先排除檔案毀損；避免套裝解碼器干擾基準測試。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: A-Q8, B-Q9, D-Q3

C-Q7: 若無法重新取得授權，如何處置？
- A簡: 檢查網路/時間，確認供應方授權狀態，再行重試。
- A詳: 具體實作步驟：1) 測試網路連外；2) 校時；3) 重新個別化；4) 依供應方流程登入/授權；5) 若來源已停用授權則無法播放。關鍵設定：防火牆/Proxy 設定。注意事項：重建前評估風險；保留紀錄以供後續支援。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: B-Q11, D-Q7, D-Q6

C-Q8: 如何建立硬體升級的回復計畫？
- A簡: 設維護視窗、手邊備妥 KB 流程、驗證清單與回退策略。
- A詳: 具體實作步驟：1) 定義維護時間；2) 準備 KB891664 指引；3) 建立驗證清單（WMP/MCE 測試）；4) 規劃回退（恢復原硬體）。關鍵設定：記錄變更。注意事項：一次只變更一項硬體；保留可用替代機。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: A-Q18, D-Q9, B-Q20

C-Q9: 家用伺服器與桌機該如何分攤風險？
- A簡: 在桌機先驗證升級，再搬至伺服器環境部署。
- A詳: 具體實作步驟：1) 先於桌機替換硬體並測試 MCE/WMP；2) 確認受保護內容可用；3) 再在伺服器施作。關鍵設定：環境一致性。注意事項：伺服器更換前備份、公告停機；避免同時多變更。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: A-Q20, C-Q8, D-Q9

C-Q10: 如何紀錄硬體變更以備故障追溯？
- A簡: 建變更單記錄時間、項目、前後狀態與驗證結果。
- A詳: 具體實作步驟：1) 記錄更換項（CPU 型號/核心數）；2) 紀錄時間與操作人；3) 變更前後播放測試結果；4) 錯誤截圖存檔。關鍵設定：集中存放紀錄。注意事項：保持一次一變更；便於對應影響與回退。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: B-Q20, C-Q4, D-Q2

### Q&A 類別 D: 問題解決類（10題）

D-Q1: 換四核心後 MCE 一開就當怎麼辦？
- A簡: 多半是 DRM 綁定失效，依 KB891664 重建 DRM 後重試。
- A詳: 問題症狀：MCE 啟動播放錄影即 GPF 或當掉。可能原因：CPU 變更導致硬體指紋改變、Indiv01.key 與授權不匹配。解決步驟：1) 依 KB891664 清除與重建 DRM；2) 重啟；3) 重新取得授權；4) 驗證播放。預防：升級前預留重建時段，先於桌機驗證。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: A-Q6, A-Q19, C-Q1

D-Q2: 播放 .dvr-ms 出現 General Protection Failure？
- A簡: 先看故障模組，若為 Indiv01.key，屬 DRM 問題優先處理。
- A詳: 症狀：播放即崩潰並顯示 GPF。原因分析：受保護錄影遇 DRM 驗證失敗。解決步驟：1) 檢視詳細錯誤模組；2) 依 KB891664 重建 DRM；3) 用 WMP/MCE 交叉測試。預防：避免同時大量硬體更動；保留錯誤紀錄以利追蹤。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: A-Q9, B-Q7, C-Q4

D-Q3: WMP、MCE、MPC 都掛掉如何處理？
- A簡: 共用 DRM 堆疊失效；先重建 DRM，再排除其他因素。
- A詳: 症狀：多播放器播放同檔皆失敗。原因：底層 DRM 或封裝/解碼共用元件出問題。解決步驟：1) 用非受保護檔測試；2) 若僅受保護檔失敗，依 KB 重建 DRM；3) 更新系統。預防：維持系統簡潔，避免多重解碼器衝突。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q8, B-Q9, C-Q6

D-Q4: 錯誤模組顯示 Indiv01.key 代表什麼？
- A簡: 指向 DRM 個別化金鑰問題，需重建 DRM 與授權。
- A詳: 症狀：錯誤詳情中模組為 Indiv01.key。原因：金鑰不匹配或損毀導致驗證失敗。解決步驟：1) 重建 DRM；2) 重啟；3) 重新取得授權。預防：重大硬體變更前後，安排驗證與必要的重建流程。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: A-Q4, B-Q14, C-Q1

D-Q5: 依 KB891664 操作後仍無法播放？
- A簡: 再檢查網路、時間、重啟與授權取得流程是否完成。
- A詳: 症狀：重建後仍拒播。原因：未成功個別化、無法連線授權伺服器、時間誤差。解決步驟：1) 檢查網路/時間；2) 重做個別化；3) 嘗試重新播放觸發授權；4) 系統更新。預防：操作中確保關閉播放器，完整重啟一次。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: B-Q19, C-Q5, C-Q7

D-Q6: 重新個別化後舊錄影仍無法播放？
- A簡: 需依來源重新取得授權；若來源停用則無法播放。
- A詳: 症狀：重建成功但舊檔仍失敗。原因：舊授權清空，需重新授權；供應方可能不再提供授權。解決步驟：1) 播放時依導引取得授權；2) 若來源停用則無解。預防：升級前評估關鍵內容風險，儘早觀賞或再錄製。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: B-Q11, A-Q11, C-Q7

D-Q7: 無法連線個別化或授權服務怎麼辦？
- A簡: 檢查網路、防火牆、系統時間與憑證，恢復後重試。
- A詳: 症狀：個別化或授權階段卡住。原因：連線受阻、時間漂移、憑證問題。解決步驟：1) 測試連外；2) 校時；3) 暫停防火牆限制；4) 重試個別化；5) 以另一時間再試。預防：升級前先確認網路品質與系統時間同步。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: C-Q7, B-Q11, B-Q13

D-Q8: 重灌與重建 DRM 何時選擇哪個？
- A簡: 僅 DRM 問題選重建；系統廣泛損毀或多問題再考慮重灌。
- A詳: 症狀：播放相關問題但系統其餘正常。原因：DRM 綁定失效常可透過重建解決。解決步驟：1) 先走 KB 重建；2) 若多處異常、系統不穩，再評估重灌。預防：定期更新、變更單管理，降低重灌需求。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: A-Q18, C-Q8, B-Q20

D-Q9: 如何預防未來升級再度發生同類問題？
- A簡: 升級前規劃、一次一變更、備妥重建流程與測試清單。
- A詳: 症狀：升級頻繁導致反覆中斷。原因：變更管理不足。解決步驟：1) 設計升級腳本與檢核表；2) 建立維護視窗；3) 先在非關鍵機器演練；4) 升級後立即驗證。預防：記錄變更、避免疊代變更多項硬體。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: C-Q2, C-Q8, C-Q10

D-Q10: 換硬體後影音效能不佳還可能是什麼原因？
- A簡: 驅動、解碼器衝突、電源管理或散熱，與 DRM 無關亦可致慢。
- A詳: 症狀：可播放但卡頓或延遲。原因：顯示卡/音效驅動、解碼器設定衝突、電源計畫限頻、散熱不足。解決步驟：1) 更新驅動；2) 檢查解碼器；3) 設高效能電源；4) 檢查溫度。預防：升級後做效能健康檢查。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: B-Q10, C-Q6, C-Q5

### 學習路徑索引
- 初學者：建議先學習哪 15 題
    - A-Q1: 什麼是 Windows Media Center（MCE）？
    - A-Q2: 什麼是 .dvr-ms 錄影格式？
    - A-Q3: 什麼是 Windows Media DRM？
    - A-Q4: 什麼是 Indiv01.key？
    - A-Q6: 為什麼更換 CPU 會影響 DRM？
    - A-Q8: 為什麼 MCE 與 Windows Media Player 都會受影響？
    - A-Q9: General Protection Failure（GPF）是什麼？
    - A-Q11: MCE 錄影的保護機制如何決定？
    - A-Q19: KB891664 是什麼？
    - A-Q20: 此案例的關鍵學習點是什麼？
    - B-Q1: MCE 播放受保護內容時如何與 DRM 互動？
    - B-Q4: 硬體變更如何觸發 DRM 拒播？
    - C-Q1: 如何依 KB891664 清除並重建 DRM？
    - C-Q4: 如何檢查錯誤模組與蒐集線索？
    - D-Q1: 換四核心後 MCE 一開就當怎麼辦？

- 中級者：建議學習哪 20 題
    - A-Q5: 什麼是 DRM 的「個別化」？
    - A-Q7: 四核心與雙核心在 DRM 上的差異是？
    - A-Q12: Codec 與 DRM 有何差異？
    - A-Q13: 硬體指紋在 DRM 中扮演什麼角色？
    - B-Q2: Windows Media DRM 的授權驗證流程為何？
    - B-Q3: Indiv01.key 的生成機制是什麼？
    - B-Q5: .dvr-ms 的封裝與保護如何運作？
    - B-Q6: 為何更換 CPU 核心數會改變硬體指紋？
    - B-Q7: 當 MCE 當機時，錯誤模組如何判讀？
    - B-Q9: 為何 WMP、MCE、MPC 會同時受影響？
    - B-Q11: 重新個別化後授權如何重新取得？
    - B-Q15: 事件檢視器在此議題可提供哪些線索？
    - B-Q16: 不同硬體變更對 DRM 的影響類型？
    - C-Q2: 更換 CPU 前如何準備以降低風險？
    - C-Q3: 如何確認某 .dvr-ms 是否受 DRM 保護？
    - C-Q5: 如何驗證重建 DRM 後播放已恢復？
    - C-Q6: 如何用 MCE 與 WMP 的差異來定位問題？
    - D-Q2: 播放 .dvr-ms 出現 General Protection Failure？
    - D-Q3: WMP、MCE、MPC 都掛掉如何處理？
    - D-Q5: 依 KB891664 操作後仍無法播放？

- 高級者：建議關注哪 15 題
    - B-Q10: Vista 下的多媒體堆疊怎麼設計？
    - B-Q12: DRM 失效時應用程式可能呈現哪些行為？
    - B-Q13: 微軟安全元件更新與個別化的關聯是什麼？
    - B-Q14: 為何錯誤模組可能顯示 Indiv01.key 而非 DLL？
    - B-Q18: 什麼是受保護的播放路徑（Protected Path）？
    - B-Q19: 為何重啟（reboot）是修復流程中的必要步驟？
    - B-Q20: 此案例的技術診斷策略是什麼？
    - A-Q15: 為什麼需要 DRM？
    - A-Q16: Indiv01.key 損毀或不匹配會有何影響？
    - A-Q17: 重新個別化對使用者意味著什麼？
    - D-Q4: 錯誤模組顯示 Indiv01.key 代表什麼？
    - D-Q6: 重新個別化後舊錄影仍無法播放？
    - D-Q7: 無法連線個別化或授權服務怎麼辦？
    - D-Q8: 重灌與重建 DRM 何時選擇哪個？
    - D-Q10: 換硬體後影音效能不佳還可能是什麼原因？