# 換了四核心，MCE就掛了...

## 摘要提示
- 四核心升級: 將桌機 CPU 由 E6300 升級為 Q9300 後，整體效能與溫度皆優，但 Media Center 卻連續當機。  
- 當機症狀: 只要開啟 MCE 或播放 .dvr-ms 檔案就跳出「美化過的 GPF」畫面，連 Media Player、MPC 都無法播放。  
- 直覺懷疑: 曾懷疑是 Microsoft 影音解碼器對四核心支援不良，但查詢後發現他人使用 Q9300 並無問題。  
- 關鍵線索: 詳細錯誤資訊指出「Indiv01.key」模組異常，這並非一般 DLL，而是 DRM 金鑰檔。  
- 公式解答: Microsoft KB891664 說明硬體變更（含 CPU 核心數）會讓 Windows Media DRM 機制失效。  
- 問題原因: 換 CPU 導致系統生成的新硬體指紋與舊 DRM 金鑰不符，MCE 認定為「非法複製」而拒播。  
- 解決步驟: 依 KB 指令刪除舊 DRM 授權並重新初始化，即可重新取得合法金鑰並恢復播放。  
- 時間成本: 真正處理只花十分鐘與一次重開機，但前期排查耗掉數小時心力。  
- 教訓心得: 更換硬體前需有備份 DRM 與重灌心理準備，否則極易被「正版保護」反咬。  
- 讀者參考: 提醒使用 Vista MCE 且打算升級四核心的用戶，先瞭解 DRM 綁定機制以免踩雷。  

## 全文重點
作者將家用桌機的 Core 2 Duo E6300 更換成四核心 Q9300，暫時體驗新 CPU 再移作 Server。硬體層面一切完美，然而在 Vista Media Center（MCE）收看與錄製電視時卻立即崩潰，連 Windows Media Player、Media Player Classic 播放先前錄製之 .dvr-ms 檔案亦同樣報錯。初期懷疑四核心與 Microsoft 影音解碼器相容性不佳，但搜尋後發現他人配置正常，遂轉而檢視錯誤資訊。  
例外視窗顯示異常模組為「Indiv01.key」。Google 得知此檔為 Windows Media DRM 生成之個別金鑰，用以辨識硬體組態並保護受版權內容。查詢 Microsoft 支援中心 KB891664，確認若電腦硬體變動（含 CPU 數量）則 DRM 子系統會判定為新裝置，原帳戶金鑰失效。故作者更換 CPU 後，MCE 將原錄影視為非法拷貝而阻斷播放。  
依 KB 指示刪除舊 DRM 資料、重新啟動並讓系統重新領取金鑰，即可恢復播放功能。整個修復過程只需十分鐘，但尋找原因耗費數小時，引發對 DRM 綁定過度嚴苛的無奈與吐槽。最終提醒讀者：硬體升級前須了解 DRM 機制，或做好重灌與授權重建的心理準備。  

## 段落重點
### 1. 四核心升級與初步異常
作者將桌機的 E6300 換成 Q9300，測得速度更快、溫度更低，原以為萬事俱備；未料開啟 Vista MCE 觀看電視即當機，顯示美化過的 General Protection Failure。嘗試改用不同播放器播放 .dvr-ms 檔案亦全數失敗，引發對四核心兼容性的質疑。

### 2. 錯誤訊息與線索搜尋
點選錯誤詳細資訊僅見「Indiv01.key」模組，乍看不像常見 DLL。Google 後得知該檔屬於 Windows Media DRM 個別金鑰。比較其他使用 Q9300 + MCE 的案例皆正常，排除 CPU 相容性問題，於是將焦點鎖定在 DRM 機制。

### 3. KB891664 與問題根因
翻查 Microsoft 支援中心找到 KB891664，說明硬體變更會導致 DRM 系統失效。由於系統產生金鑰時會把硬體組態（含可用 CPU 核心數）納入指紋，作者換 CPU 等同換機，被認定為在新電腦上播放加密內容，因此遭到 MCE 阻擋。

### 4. 修復流程與結果
按 KB 指引手動刪除舊 DRM 授權檔並重啟，系統隨即重新生成金鑰。完成後 MCE 與所有播放器恢復正常播放，驗證問題確為 DRM 綁定。整體修復僅花十分鐘，加上一次重開機即可。

### 5. 心得與建議
雖然問題解決迅速，但在找出原因前已耗掉數小時，突顯 DRM 對硬體升級的高敏感度。作者感嘆正版保護反而造成使用者困擾，並提醒欲為 MCE 升級四核心或更換硬體者，務必事先備份授權或準備重建環境，以免重蹈覆轍。