# Canon Digital Camera 相機獨享 - 記憶卡歸檔工具

## 摘要提示
- 歸檔困擾: 使用數位相機拍照量大，手動分類與命名相片十分耗時。  
- 批次檔初步解法: 作者先用 Windows 批次檔自動搬移並依日期與主題命名。  
- EXIF 侷限: 批次檔無法解析 EXIF 資訊，日期易錯、相片與相機來源難區分。  
- 多機重覆命名: 兩台以上 Canon 相機會產生相同檔名，導致檔案衝突。  
- 自製工具誕生: 作者以 .NET 2.0 開發 DigitalCameraFiler.exe 全自動化。  
- 命令列導向: 工具無 GUI、適合喜歡批次操作與輕量流程的使用者。  
- 全格式處理: 支援 JPG、CRW、AVI 等，並可獨立儲存 RAW 與影片。  
- 彈性命名: 透過 config 檔 targetPattern 與 arguments 自訂目錄與檔名格式。  
- 自動轉正: 新版工具可依 EXIF 方向欄位自動旋轉照片。  
- 免費下載: 作者公開程式與設定檔，提供網址供有需要者取用。

## 全文重點
作者分享自己整理數位相機記憶卡的經驗與解決方案。由於數位相機拍照無耗材成本，檔案數量暴增，傳統「插卡→複製→手動改名、分資料夾」的流程既繁瑣又易出錯。市面上雖有 Picasa、Adobe Album、ACDSee 等完整影像管理軟體，但他只想要一個「把檔案搬到對的地方」的小工具，不想安裝龐大套件。  
最初他以 Windows 批次檔實現：根據執行當日日期與自訂主題，將 JPG、CRW、AVI 分別搬移至 c:\photos 與 c:\videos 等目錄，並自動刪除附帶的 THM 縮圖。這樣確實解決了「一鍵歸檔」的需求，卻仍有四大缺點：  
1. 以執行日期為準，若半夜才複製，日期易與實際拍攝日相差一天。  
2. 多日累積檔案只能混在同一資料夾，無法再細分。  
3. 同名檔易在多台相機間衝突。  
4. 無 EXIF 解析能力，無法自動旋轉直拍照片。  
批次檔難以超越這些限制，於是作者直接用 .NET 2.0 開發 DigitalCameraFiler.exe。這支命令列工具可：  
• 讀取 EXIF 的拍攝日期、相機型號與方向，精準決定目錄與檔名並自動旋轉；  
• 透過 appSettings 中的 targetPattern 與 arguments 自訂不同檔案類型的儲存路徑與命名格式；  
• 依「日期 + 主題 + 相機型號 + 原檔名」模式生成具可讀性的路徑，例如  
  c:\photos\2006-1102 [公園外拍]\Canon PowerShot G2 #IMG_1234.jpg；  
• 將影片（AVI）分開存放至 c:\video，並保留拍攝序號。  
使用方式很簡單：先編輯 DigitalCameraFiler.exe.config，設定 default.title 與三種 targetPattern，再於命令列執行  
  DigitalCameraFiler.exe 來源磁碟機 主題  
例如：DigitalCameraFiler.exe F:\ 公園外拍  
工具就會掃描 F:\DCIM，完成搬移與命名並清除不需要的 THM。作者最後附上下載連結，歡迎同好取用並給予回饋。

## 段落重點
### 問題描述：手動歸檔的痛點
作者指出數位相機讓拍照變廉價，檔案量暴增；以往手動分類、命名、轉正、分機種會耗費大量時間。雖有 Picasa 等大型管理軟體，但對只想快速備份的人而言過於笨重，因此萌生自行開發輕量工具的念頭。

### 原始批次檔解決方案
先以簡易批次檔 copypic.cmd 解決基本需求：依「年月日 + 主題」建立目錄，將 JPG、CRW、AVI 移動並刪除影片縮圖。透過參數可指定主題及覆寫日期，兩年來運作良好，極大幅度簡化了記憶卡清空流程。

### 批次檔缺點與限制
批次檔無法讀 EXIF，只能用複製當日作日期依據，導致夜半作業日期錯置；多日照片無法細分；兩台 Canon 相機檔名 IMG_0001 互撞；也欠缺自動旋轉與更多條件判斷，邊際需求愈來愈難以支撐。

### 自製 .NET 工具 DigitalCameraFiler
為突破批次檔限制，作者以 .NET 2.0 撰寫全新命令列程式 DigitalCameraFiler.exe。核心功能：1) 解析 EXIF 拍攝日期與方向；2) 以 config 檔決定不同副檔名的 targetPattern；3) 雙相機不衝突的完整命名；4) 影片與 RAW 分開路徑；5) 可於命令列一次執行。

### 設定檔結構與運作模式
在 DigitalCameraFiler.exe.config 中，使用者可調整 default.title、video/general/photo.targetPattern 與 arguments。arguments 對應 EXIF 欄位與檔名元件，system.string.Format 方式可靈活組合。執行時只需指定來源磁碟與主題，程式即批次搬移、改名、轉正。

### 結語與下載
新的 DigitalCameraFiler 兼具輕量、可攜與高度可自訂，對習慣命令列且只需檔案層級管理的人尤其便利。文章最後提供下載連結，誠邀讀者試用並鼓勵回饋，作者也分享自己從「批次檔→程式化」的過程，示範如何以少量程式碼大幅提升日常工作效率。