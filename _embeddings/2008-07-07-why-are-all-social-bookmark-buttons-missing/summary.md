# 為什麼一堆推文的按鈕都不見了?

## 摘要提示
- 推文計數消失: 作者發現部落格中原本顯示推文數字的按鈕突然全部消失。
- 連結失效: 透過推推王返回文章時出現「Oops!」，確認連結已無法對應。
- URL 比對: 比較推推王紀錄與實體網址，發現兩者的網址字串不同。
- BlogEngine.NET 升級: 近期從 1.3 升級到 1.4，懷疑新版變動引起問題。
- SLUG 規則更動: 1.4 版移除逗號、將連續 “–––” 合併為 “–”，導致原網址失效。
- 版本差異確認: 透過 VSS 比對原始碼，證實 SLUG 產生邏輯確實被修改。
- 影響範圍: 只有少數早期文章受 SLUG 變動影響，推文計數因網址不符而遺失。
- 修正策略: 因受影響篇數不多，作者選擇在推推王手動更新網址而非撰寫修復程式。
- 維運教訓: 升級 CMS 前須評估網址穩定性，避免既有外部連結與統計錯失。
- 結案: 手動修改後推文按鈕恢復正常，問題排除。

## 全文重點
作者日前發現部落格中原本顯示推文次數的小按鈕忽然全部消失。檢視頁面 HTML 與外部服務推推王的紀錄後，他確認推文資料仍存在，但從推推王點回文章卻出現「Oops!」錯誤。進一步比對兩邊網址，發現推推王保留的連結含有 “---” 字串，而目前部落格上的網址只有單一 “-”。回想最近將 BlogEngine.NET 從 1.3 升級到 1.4，作者懷疑新版自動產生 SLUG 的邏輯變動。透過 VSS 比對程式碼，確定 1.4 移除了逗號並把連續多個破折號合併，導致舊網址失效，外部服務無法正確回傳推文數。由於受影響文章數量有限，作者未撰寫修補程式，而是在推推王將舊網址手動改成新網址，立即恢復推文計數。事件提醒部落客與網站維運者，在升級 CMS 或調整 URL 規則前，需先評估對外部連結與統計資料的影響，並事先規畫轉址或批次修正，才能避免流量與互動數據流失。此次排解過程以手動方式快速結案，也讓作者對系統升級的潛在風險有更深刻的體會。

## 段落重點
### 問題發現與初步檢查
作者在瀏覽部落格時注意到多篇文章的推文按鈕不再顯示數字，判斷可能是外部服務或網站本身出現異常。透過連到推推王搜尋同篇文章，確定推文數仍存在，說明資料本身並未遺失。當他嘗試由推推王返回原文時卻出現「Oops!」，顯示連結失效。這一步確認問題並非推推王端，而是部落格內部的 URL 已改變，導致外部服務記錄與實際頁面脫鉤。

### 原因分析：SLUG 調整
作者把推推王保存的舊網址與當前頁面網址逐字比對，發現舊網址中段出現 “---”，新版僅剩 “-”。回想近期才把 BlogEngine.NET 由 1.3 更新至 1.4，他立即懷疑新版 SLUG 生成邏輯所致。利用 VSS 取出兩版程式碼比較，確認 1.4 版在產生 SLUG 時新增了「移除逗號」與「將連續破折號合併」的處理流程。此差異導致舊文章升級後自動生成的新網址與外部早已索引的舊網址不符，進而造成推文按鈕無法對應推文計數。

### 解決方案與結論
確定主因後，作者評估受影響的文章僅有數篇，決定不寫批次程式修復，而是直接到推推王編輯每篇文章的 URL，改成新 SLUG。修正後按鈕立刻恢復推文數字，問題宣告解決。這次事件提醒他：1) 升級 CMS 前須檢查 URL 穩定性；2) 如有變動需提前規畫 301 轉址或批次更新；3) 外部統計服務多仰賴固定網址，任何自動化改動都可能導致數據流失。透過本次經驗，他加深了對系統升級風險與網站維運細節的重視，也為未來可能的大幅改版預留更多檢測與備援策略。