# 再度換裝 Vista ... Vista Ultimate (x64)

## 問題與答案 (FAQ)

### Q&A 類別 A: 概念理解類

A-Q1: 什麼是 Windows Vista Ultimate x64？
- A簡: Vista 的 64 位元旗艦版，整合 Media Center、平板電腦、IIS7 與完整備份等功能，支援更大記憶體與新版驅動。
- A詳: Windows Vista Ultimate x64 是 Vista 的 64 位元旗艦版本，將家庭娛樂的 Media Center、商務所需的完整系統映像備份（Complete PC Backup）、平板電腦手寫/墨跡、IIS7 網頁伺服器等特性整合於單一版本。相較 32 位元系統，x64 能處理更大實體與虛擬記憶體，並要求 64 位元驅動，提升穩定性。對既想保有 MCE，又要研究 IIS7、擴充 RAM 或使用 64 位元開發者而言，是兼顧娛樂與生產力的折衷方案。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: A-Q3, A-Q4, B-Q19, A-Q13

A-Q2: 什麼是 32 位元與 64 位元作業系統的差異？
- A簡: 64 位元提供更大定址空間與不同驅動模型；32 位元相容性佳但記憶體受限，驅動與程式位元數須匹配。
- A詳: 32 位元（x86）作業系統的虛擬位址空間受限，多數應用程式僅能使用 2GB（可調至 3GB），且總體可用實體記憶體常卡在 3~4GB。64 位元（x64）提供巨大的位址空間、較佳的記憶體管理與安全性隔離，核心與驅動需為 64 位元，使用 WOW64 來相容 32 位元應用。差異核心在於定址能力、驅動要求、相容性處理及效能輪廓。升級前須評估驅動、外掛、編解碼器與業務軟體的位元數相容。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: B-Q1, B-Q3, A-Q18, D-Q5

A-Q3: 為什麼需要從 XP 升級到 Vista x64？
- A簡: 擴充 RAM、保留 Media Center、研究 IIS7、使用內建備份與細節改良，並解決舊版相容與開發環境限制。
- A詳: 升級動機包含多面向：硬碟擴充便於新舊系統並存；欲擴 RAM 超過 4GB 需 x64；XP MCE2005 想保留 Media Center 又要 64 位元，實際選項只剩 Vista x64；IIS7 在 Vista 可先行研究；Vista 內建 DVD Codec、基本影片剪輯、Tablet PC 墨跡等內建功能實用；SuperFetch 改善常用應用載入感受；VS2008 已解決 Vista/x64 的除錯問題；Vista SP1 成熟度提升；另有 Complete PC 映像備份與 VHD 整合的管理便利性。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: A-Q1, A-Q13, B-Q19, C-Q1

A-Q4: 什麼是 Windows XP Media Center Edition（MCE）與其在 Vista 的延續？
- A簡: MCE 是家用多媒體介面。Vista 融合 Media Center，不需另版；x64 亦可保留相關功能。
- A詳: XP MCE 是以家庭影音為核心的特殊版本，整合電視/節目錄影、遠端控制與媒體導覽介面。到了 Vista，Media Center 被納入多個版本（含 Ultimate），不再是獨立 SKU。因此使用者可在 Vista x64 同時保有 MCE 功能與 64 位元系統優勢，不必在 Tablet PC、Media Center、x64 之間取捨。這解決了 XP 時代引導多版本權衡的痛點。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: A-Q1, A-Q22, C-Q7

A-Q5: 什麼是 WOW64（Windows-on-Windows 64）？
- A簡: WOW64 是 x64 上執行 32 位元應用的相容層，提供 API 轉譯、檔案與登錄重導，隔離兩種位元世界。
- A詳: WOW64 為 64 位元 Windows 提供的 32 位元相容機制。它以用戶模式子系統攔截與轉譯 32 位元 API 呼叫至 64 位元內核，並透過檔案（system32 ↔ SysWOW64）與登錄（HKLM\Software ↔ Wow6432Node）重導，確保 32 位元程式自治。限制是同一個 Process 內不可混 32/64 模組，驅動必須純 64 位元。WOW64 讓多數 32 位元應用在 x64 上無須重寫即可正常運作。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: B-Q1, B-Q21, D-Q2

A-Q6: 為何同一個程序內不能混用 32 與 64 位元程式碼？
- A簡: 因位址寬度、呼叫約定與載入器限制不同，模組 ABI 不相容，混用將導致崩潰與不可預期行為。
- A詳: 32/64 位元在指標長度、暫存器配置、呼叫慣例與結構對齊上均不相容。Windows 載入器會檢查可執行檔與 DLL 的機器類型（PE Header），禁止在同一流程混合不同架構模組，以避免函式呼叫與資料結構被錯誤解讀。驅動層更嚴格，核心空間只允許 64 位元驅動。相容層（如 WOW64）提供的是進程級隔離，而非進程內混搭。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: B-Q3, D-Q5, C-Q2

A-Q7: 驅動程式與 DLL（含外掛/編解碼器）在 x64 相容性上有何差異？
- A簡: 驅動必須純 64 位元；DLL/外掛需與宿主位元一致，32 位元外掛只能被 32 位元程式載入。
- A詳: 核心驅動（.sys）在 x64 必須全為 64 位元，且多數情況需簽章。使用者模式的 DLL、COM、ActiveX、Codec 等屬於進程內模組，必須與宿主進程的位元數一致，因此 32 位元外掛只能由 32 位元應用載入；反之亦然。這使得 IE 64 雖可用，卻無法載入多數僅有 32 位元的 ActiveX，故需改用 IE 32。相容策略常是全套 32 位元路徑。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q6, B-Q4, D-Q4

A-Q8: 什麼是 ActiveX/COM 與影像編解碼器（Codec），在 Vista x64 有何角色？
- A簡: 它們是可插拔元件，提供功能擴展。位元數需匹配宿主，否則無法載入或呼叫。
- A詳: ActiveX/COM 與各式 Codec（如 Raw、Video、WIC）本質是可重複使用的二進位元件。Windows 透過登錄與 CLSID 進行註冊與查找，宿主程序載入並呼叫其介面。於 x64，元件必須與宿主位元一致（32 載 32；64 載 64），否則無法載入。這直接影響瀏覽器外掛、圖像縮圖、WPF/WIC 影像解碼、ODBC 驅動等場景。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: B-Q5, B-Q18, C-Q3

A-Q9: 為什麼在 x64 上仍常需要 IE 32 位元版本？
- A簡: 多數 ActiveX 僅提供 32 位元，IE64 無法載入，使用 IE32 能維持外掛與網站的相容性。
- A詳: 雖然 IE 有 64 位元版本，但網路生態中許多 ActiveX/瀏覽器外掛仍僅編譯為 32 位元。由於進程內不可混用異位元模組，IE64 不能載入 32 位元 ActiveX。解法是改用 IE32（在 x64 上同時存在）以載入 32 位元外掛，確保網站功能正常。這是 x64 過渡期的常態策略。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: A-Q7, D-Q4, C-Q5

A-Q10: 什麼是 Canon Raw Codec？在 x64 環境的重要性？
- A簡: Canon 提供的 CR2 影像解碼器。於 x64 僅有 32 位元版時，需以 32 位元宿主載入才能用。
- A詳: Canon Raw Codec 是用於解碼 Canon 相機 .CR2 檔的影像編解碼器，讓系統、應用顯示縮圖、讀取影像與中繼資料。在 Vista x64 的情境下，若官方僅提供 32 位元版，則 64 位元宿主（如 64 位元程式或殼層）無法直接載入。解法是採用 32 位元宿主（如 32 位元 Windows Live Gallery 或自家程式改為 x86）以透過 WOW64 正確使用該 Codec。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: C-Q3, C-Q2, D-Q1

A-Q11: 什麼是 WPF 影像編解碼與其與 WIC 的關係？
- A簡: WPF 透過 WIC 使用影像編解碼器。位元需匹配宿主，故 32 位元 Codec 要由 32 位元 WPF App 載入。
- A詳: WPF（Windows Presentation Foundation）使用 Windows Imaging Component（WIC）做影像處理與解碼。WIC 以可插拔 Codec 模式運作，依 CLSID 解析對應的解碼器。於 x64 系統，WPF 應用若為 64 位元，僅能載入 64 位元 WIC Codec；若改編譯為 x86，則可載入 32 位元 Codec（如 Canon Raw），恢復顯示與中繼資料讀取。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: C-Q2, B-Q5, D-Q2

A-Q12: 什麼是 Windows Live Gallery（相片庫）32/64 位元版本的差別？
- A簡: 兩者功能相近，但能載入的外掛/Codec 位元數不同；選對版本決定相容性。
- A詳: Windows Live Gallery 在 x64 系統同時提供 32 與 64 位元版本。UI 功能相仿，但可載入的外掛、縮圖處理器與影像 Codec 受位元數限制。若需使用僅有 32 位元的 Canon Raw Codec，就必須啟動 32 位元版本。另需留意其可能常駐行為，錯版先啟後續打開仍沿用舊進程。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: D-Q3, C-Q4, A-Q23

A-Q13: 什麼是 Vista Complete PC Backup？為何實用？
- A簡: 內建的整碟映像備份，產生 VHD，可直接還原或於虛擬化工具掛載存取。
- A詳: Vista 的 Complete PC Backup 可將整顆磁碟做成一個映像檔，微軟採用 VHD 格式，與 Virtual PC/Virtual Server 相容。它讓系統備援更直覺：在 Vista 內即可建立映像，日後用安裝光碟啟動即可還原；或於主機上以 VHDMOUNT 掛載，直接存取檔案。對常測試、切換系統或需快速回復環境者特別划算。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: C-Q6, B-Q9, B-Q10

A-Q14: 什麼是 VHD（Virtual Hard Disk）以及與虛擬化的關係？
- A簡: VHD 是虛擬硬碟檔格式，能被虛擬機或工具掛載，Vista 備份亦產生此格式。
- A詳: VHD 為微軟提出的虛擬硬碟封裝檔格式，一個檔案內包含磁碟結構與資料，可被 Virtual PC、Virtual Server 等虛擬化平台識別。Vista 的 Complete PC Backup 以 VHD 保存整碟影像，讓映像可於虛擬化工具直接掛載檢索或驗證。這種一致格式降低備援、測試、移轉的摩擦。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: A-Q13, C-Q6, B-Q10

A-Q15: 什麼是 VHDMOUNT？
- A簡: Virtual Server 2005 R2 SP1 隨附的工具，可將 VHD 於主機掛載為磁碟，方便檢索與復原。
- A詳: VHDMOUNT 是一個將 VHD 檔案直接掛載到作業系統的工具，掛載後會出現新磁碟機號，可像一般磁碟讀寫。對於使用 Vista Complete PC 生成的 VHD 映像，可用 VHDMOUNT 快速開啟取檔、驗證備份內容，無需完整還原。需安裝對應的驅動並以系統管理員權限操作。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: C-Q6, B-Q10, D-Q8

A-Q16: 什麼是 IIS7？為何在 Vista 探索它？
- A簡: IIS7 是模組化網頁伺服器，新式組態與管線。Vista 內建，便於開發者快速上手與測試。
- A詳: IIS7 將核心改為模組化，整合整體管線（Integrated Pipeline）、以 XML（applicationHost.config）為中心的組態、細緻的授權與診斷。開發者可在 Vista（非 Server 版）啟用 IIS7 的必要元件，快速部署與試驗模組與設定，無須等待 Windows Server 2008。這對研究新特性、開發與教學十分便利。
- 難度: 初級
- 學習階段: 核心
- 關聯概念: B-Q19, C-Q8, D-Q6

A-Q17: 什麼是 SuperFetch？為何常被誤解？
- A簡: SuperFetch 會預先載入常用程式到記憶體，提升啟動體感。佔用 RAM 非記憶體外洩。
- A詳: SuperFetch 分析使用習慣，利用閒置 RAM 預取常用應用與資料進行快取，提升程序啟動與切換的體感速度。被「高記憶體佔用」誤解為浪費，實際上屬於可回收快取，應用需要時會釋放。對常用的大型軟體啟動速度的主觀感受改善明顯。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: B-Q8, D-Q7, A-Q3

A-Q18: 為何升級 x64 有助於突破 4GB 記憶體限制？
- A簡: x64 擁有更大位址空間，核心與應用可充分利用 >4GB 實體記憶體，減少映射瓶頸。
- A詳: 在 32 位元系統，虛擬位址與驅動映射等因素導致實體記憶體可用上限常落在約 3~3.5GB。x64 擁有更大的虛擬與實體定址能力，核心區與裝置映射不再擠占同一窄小空間。應用程式在滿足 LargeAddressAware 等條件下，於 x64 可擴展到更大虛擬記憶體使用。對影像處理、虛擬機、開發工具皆有助益。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: B-Q7, D-Q9, A-Q2

A-Q19: 為何 32 位元應用在 x64 上仍可能受惠？
- A簡: WOW64 讓 32 位應用享受較快的記憶體管理與較大可用位址（需 LAA），整機體驗更佳。
- A詳: 雖未重編為 64 位，32 位應用在 x64 內核下仍得利於更寬裕的內部資源與改良的管理機制。部分記憶體運算、I/O 路徑與系統呼叫在新平台優化；且在設為 LargeAddressAware 時，32 位應用於 x64 可使用最多 4GB 虛擬位址空間（相較 x86 預設 2GB）。整體上可減少碎片與切換成本。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: B-Q7, D-Q9, A-Q5

A-Q20: 什麼是 .NET 的 AnyCPU、x86、x64 目標平台差異？
- A簡: AnyCPU 隨環境 JIT；x86 強制 32 位元；x64 強制 64 位元。需依相依元件位元數選擇。
- A詳: .NET 組件可標記為 AnyCPU（CLR 依 OS 決定 JIT 為 32/64 位）、x86（僅 32 位）或 x64。當應用需載入僅有 32 位元原生 DLL/Codec/COM 時，AnyCPU 在 x64 會成為 64 位元導致載入失敗，應改編為 x86 以取得相容性；反之，若需使用 64 位專屬功能或大記憶體，可選 x64。目標平台即相容策略的開關。
- 難度: 初級
- 學習階段: 核心
- 關聯概念: C-Q2, D-Q2, B-Q12

A-Q21: 為何將 .NET 程式改為 x86 能解決 Canon Raw Codec 問題？
- A簡: 因 Canon 僅有 32 位元 Codec，x86 宿主才能載入並解析 CR2 與中繼資料。
- A詳: 問題本質為位元數不匹配。當 .NET 應用為 AnyCPU 時，在 x64 會以 64 位元啟動，無法載入 32 位元 Canon Raw Codec。將組態改為 x86，讓應用固定為 32 位元進程，即可由 WIC/WPF 正常找到並載入 32 位元 Codec，恢復縮圖、影像解碼與 metadata 抽取能力。
- 難度: 初級
- 學習階段: 核心
- 關聯概念: C-Q2, A-Q10, D-Q1

A-Q22: 什麼是 Vista 的 Tablet PC 功能？
- A簡: 內建墨跡/手寫辨識、筆輸入 API 與面板，搭配數位板即可使用平板功能。
- A詳: Vista 將 Tablet PC 功能整合進一般版本：包含筆輸入管線（Ink）、手寫辨識引擎、輸入面板（TIP）與應用 API。即使使用市售數位板，也能啟用寫字、注釋與手勢。這讓過去需選購 Tablet PC 版 XP 的功能，在 Vista 得以與 Media Center、x64 同時擁有。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: C-Q7, B-Q16, A-Q4

A-Q23: 為何 Windows Live Gallery 會「常駐」影響位元版本切換？
- A簡: 因其可能以 COM/OLE 伺服器常駐，首次啟動的位元版本維持中，後續呼叫沿用該進程。
- A詳: 某些應用（含 WL Gallery）採用 COM/OLE 本地伺服器模式啟動，首次啟動後進程會常駐等待下一次要求。若先啟動 64 位元版本，之後即使從 32 位捷徑開啟，也可能附著在既有 64 位進程上，導致仍無法載入 32 位 Codec。需終止既有進程或重新啟動系統再開正確版本。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: D-Q3, C-Q4, B-Q22

A-Q24: 為何提到 Vista SP1 代表時機成熟？
- A簡: SP1 匯整修補與相容性改進，解決早期 Vista 與開發工具在 x64 上的多項小問題。
- A詳: 大型服務包（SP）通常整合功能穩定性調整、驅動相容性擴充與效能修補。對 Vista 而言，SP1 推出後搭配 VS2008 等新版工具，先前在 Vista/x64 上的除錯與相容性問題已大幅緩解，提高升級信心與可用性。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: A-Q3, D-Q6, B-Q23

A-Q25: 為何「內建功能夠用就用」是升級的誘因？
- A簡: Vista 內建 DVD Codec、簡易影片編輯、完整備份等，降低外掛依賴與相容風險。
- A詳: 內建功能通常與系統版本、平台相容性最佳，更新也隨系統維護。Vista 內建的 DVD 解碼、基本影片編輯、Complete PC 備份等功能足以滿足普遍需求，使用內建可減少第三方外掛造成的位元不匹配、驅動問題與維護成本，對追求穩定實用者具吸引力。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: A-Q13, A-Q17, C-Q6

---

### Q&A 類別 B: 技術原理類

B-Q1: WOW64 相容層如何運作？
- A簡: 透過用戶模式子系統轉譯 32 位呼叫，並以檔案/登錄重導隔離，讓 32 位應用在 x64 正常運行。
- A詳: 原理說明：WOW64 提供轉譯器與 thunk 層，攔截 32 位 API，轉為 64 位內核可理解的呼叫；並將 system32 重導至 SysWOW64、登錄寫入重導至 Wow6432Node。關鍵步驟：建立 32 位子系統、配置分開的 DLL 搜尋路徑、維護指標寬度轉換。核心組件：Wow64.dll、Wow64win.dll、Wow64cpu.dll 與檔案/登錄重導機制。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q5, B-Q21, D-Q2

B-Q2: 32 位元應用在 x64 的執行流程為何？
- A簡: 由 WOW64 啟動 32 位進程，載入 32 位系統 DLL，經 thunk 層呼叫 64 位內核完成作業。
- A詳: 原理說明：CreateProcess 檢測可執行檔機器類型為 x86，啟動 WOW64 子系統，載入 32 位 ntdll、kernel32 等。關鍵步驟：1) 映射 32 位映像；2) 初始化 WOW64 堆疊/TEB/PEB；3) 透過 thunk 轉至 64 位內核；4) 檔案/登錄重導。核心組件：32 位系統 DLL、WOW64 模組、NT 內核系統呼叫介面。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: B-Q1, B-Q21, A-Q19

B-Q3: 為何載入器禁止混用 32/64 位元模組？
- A簡: PE Header 機器類型不同，ABI 不相容；載入器以此拒載，避免崩潰與記憶體損毀。
- A詳: 原理說明：Windows 載入器依 PE 檔頭（Machine）決定可載入的模組類型及匯入解析。關鍵步驟：驗證映像、檢查依賴、配置位址空間與重配置，若偵測異架構，直接中止。核心組件：LdrLoadDll、PE 解析器、匯入表/重定位機制。禁止混搭可避免呼叫約定不一致造成參數破壞與堆疊錯亂。
- 難度: 高級
- 學習階段: 進階
- 關聯概念: A-Q6, D-Q2, C-Q2

B-Q4: 為何 64 位元 Windows 無法載入 32 位元驅動？
- A簡: 核心模式無 WOW64，相容層僅在使用者模式；驅動必須純 64 位且多需簽章。
- A詳: 原理說明：WOW64 僅存在於使用者模式，核心空間（Ring 0）不提供跨位元轉譯。關鍵步驟：PnP/SCM 載入驅動時檢查映像架構與簽章，32 位元驅動會被拒載。核心組件：NTOSKRNL、I/O Manager、Code Integrity。這使虛擬光碟、虛擬網卡等軟體驅動需提供 x64 版本方能運行。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q7, D-Q5, A-Q2

B-Q5: WIC/WPF 如何尋找並載入影像 Codec？
- A簡: 透過 CLSID 註冊查表，依位元數載入對應 DLL，與宿主進程同位元執行。
- A詳: 原理說明：WIC 以 COM 註冊的編解碼器（CLSID、MIME/副檔名）解析影像格式。關鍵步驟：1) 查詢登錄對應編碼器；2) 依宿主位元數選擇 DLL；3) 建立 COM 物件解碼資料流。核心組件：WIC Imging Factory、COM 註冊、對應 Codec DLL。x64 宿主只能載入 64 位 DLL，故 Canon 32 位 Codec 僅能由 32 位 WPF/WIC 宿主使用。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q11, C-Q2, D-Q1

B-Q6: IE 32/64 與 ActiveX 的相容性機制為何？
- A簡: IE 藉由進程位元數限定可載入 ActiveX 的位元；64 位 IE 不載 32 位 ActiveX。
- A詳: 原理說明：ActiveX 以 COM 元件形式註冊，IE 於進程內載入。關鍵步驟：1) IE 判斷自身位元；2) 讀取登錄 CLSID；3) 嘗試載入對應位元 DLL 或本地伺服器；4) 若不匹配即失敗。核心組件：IE 宿主、COM 子系統、ActiveX 控制項 DLL。相容策略通常是指定使用 IE 32。
- 難度: 初級
- 學習階段: 核心
- 關聯概念: A-Q9, D-Q4, C-Q5

B-Q7: 32 位應用在 x64 的記憶體位址空間如何配置？
- A簡: 預設 2GB 使用者空間；若 LAA 可至 4GB。核心區與裝置映射不再擠壓同域。
- A詳: 原理說明：32 位進程的虛擬位址空間在 x64 預設仍為 2GB 使用者、2GB 內核；使用 LargeAddressAware 可讓使用者空間擴至 4GB。關鍵步驟：連結旗標/映像屬性設定、系統配置讀取。核心組件：PE Header LAA 旗標、NT 記憶體管理器、WOW64。這讓大影像處理/VM 類應用受惠。
- 難度: 中級
- 學習階段: 進階
- 關聯概念: A-Q18, A-Q19, D-Q9

B-Q8: SuperFetch 的工作機制是什麼？
- A簡: 以行為分析建立快取模型，閒置時預取資料至 RAM，需求時即取；可隨時回收。
- A詳: 原理說明：監控程序啟動、檔案存取時序，建模預測將來需求。關鍵步驟：1) 收集遙測；2) 排程預取；3) 動態調整快取；4) 記憶體壓力來時回收。核心組件：Memory Manager、Prefetcher/SuperFetch 服務、I/O 優先級。它非洩漏，屬於可回收快取。
- 難度: 初級
- 學習階段: 核心
- 關聯概念: A-Q17, D-Q7, A-Q25

B-Q9: Vista Complete PC 備份影像運作原理？
- A簡: 透過 VSS 建立一致性快照，將磁碟映像封裝為 VHD，可還原或掛載檢視。
- A詳: 原理說明：利用 Volume Shadow Copy Service 建快照，確保檔案系統一致。關鍵步驟：1) 觸發 VSS；2) 讀取磁區映像；3) 產生 VHD；4) 寫入目標。核心組件：VSS、備份服務、VHD 格式。還原時以 Windows PE 啟動還原映像；亦可於主系統掛載檢視。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q13, C-Q6, B-Q10

B-Q10: VHDMOUNT 如何將 VHD 掛載為磁碟？
- A簡: 安裝驅動後，以工具將 VHD 映射為虛擬磁碟裝置，建立卷並指派機碼。
- A詳: 原理說明：VHDMOUNT 透過過濾驅動將檔案映射為塊裝置。關鍵步驟：1) 安裝驅動；2) 指定 VHD 路徑；3) 掛載建立裝置；4) 指派磁碟代號。核心組件：VHDMOUNT CLI/GUI、內核驅動、磁碟管理。卸載時釋放鎖定與卸除裝置。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: C-Q6, D-Q8, A-Q15

B-Q11: 殼層縮圖在 x64 與 x86 的處理管線有何不同？
- A簡: 由位元一致的 Shell Extension/WIC Codec 生成縮圖；x64 殼層無法用 32 位元縮圖處理器。
- A詳: 原理說明：Explorer 透過 Shell Thumbnail Provider 或 WIC Codec 解影像。關鍵步驟：1) 查找對應提供者；2) 以宿主位元載入；3) 產縮圖與快取。核心組件：Explorer、Shell Extensions、WIC。x64 Explorer 只能載入 64 位元縮圖提供者，故需 32 位宿主（如 WLPG 32）顯示 CR2 縮圖。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q12, D-Q3, B-Q5

B-Q12: .NET AnyCPU 在 x64 的 JIT 選擇流程？
- A簡: CLR 依 OS 位元數決定 32/64 JIT；載入原生相依時若不匹配會失敗。
- A詳: 原理說明：AnyCPU 組件於啟動時由 CLR 判斷環境，x64 上使用 64 位 JIT。關鍵步驟：1) CLR 啟動；2) 解析 AppConfig/相依；3) JIT 目標架構；4) 載入原生 DLL/COM。核心組件：mscorwks/mscorlib、JIT、P/Invoke/COM Interop。當需載入 32 位元原生元件時，應改編譯 x86。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q20, C-Q2, D-Q2

B-Q13: VS2005/2008 在 Vista x64 的除錯機制差異？
- A簡: VS2008 原生相容 Vista/UAC 與 x64，較少權限/相容問題；VS2005 需補丁與提權。
- A詳: 原理說明：Vista 引入 UAC 與新 Debug API 要求，VS2008 已適配。關鍵步驟：VS2005 需安裝 Vista 相容性外掛/更新，並以系統管理員執行以附加至受保護進程。核心組件：DbgClr、msvsmon、UAC。VS2008 亦改善 64 位調試、IIS7 附加等流程。
- 難度: 初級
- 學習階段: 核心
- 關聯概念: D-Q6, C-Q10, A-Q24

B-Q14: PAE 與 x64 擴充記憶體的差異？
- A簡: PAE 在 32 位上擴充實體記憶體映射，應用虛擬空間仍受限；x64 同時擴虛擬與實體。
- A詳: 原理說明：PAE 透過更大頁表映射更多實體記憶體，但每進程虛擬位址仍多半 2GB。x64 從架構上擴大虛擬與實體定址。關鍵步驟：頁表配置、記憶體管理器策略。核心組件：MMU、NT 記憶體管理。結果：x64 對單一進程大記憶體需求更友善。
- 難度: 中級
- 學習階段: 進階
- 關聯概念: A-Q18, B-Q7, D-Q9

B-Q15: 雙開機（XP+Vista）在啟動管理上的運作？
- A簡: Vista 使用 Bootmgr/BCD 管理啟動；可共存 XP，於新碟安裝再設定 BCD 選單。
- A詳: 原理說明：Vista 引入 Bootmgr 與 BCD 取代 NTLDR/Boot.ini。關鍵步驟：1) 安裝於新碟；2) Bootmgr 掃描系統；3) BCD 建立項目；4) 顯示選單。核心組件：Bootmgr、BCD、Winload。可透過 bcdedit 或圖形工具調整預設與超時。
- 難度: 初級
- 學習階段: 核心
- 關聯概念: C-Q1, D-Q10, A-Q3

B-Q16: Vista 的筆墨跡管線如何工作？
- A簡: 以 Ink 收集筆劃，經辨識引擎轉文字，TIP 提供輸入介面，供應用程式使用。
- A詳: 原理說明：數位板驅動提供筆座標與壓力，Ink API 儲存筆劃，辨識器產生候選文字。關鍵步驟：校正→收集→辨識→提交。核心組件：Tablet PC API、TIP、Recognizer。應用可即時呈現墨跡或轉文字輸入。
- 難度: 初級
- 學習階段: 核心
- 關聯概念: A-Q22, C-Q7, D-Q5

B-Q17: Canon Raw Codec 在 x64 的 COM 註冊與尋址？
- A簡: 註冊於 Wow6432Node，供 32 位 COM 客戶端查找；64 位宿主無法發現或載入。
- A詳: 原理說明：Canon Codec 以 COM 註冊，32 位註冊表位於 Wow6432Node。關鍵步驟：regsvr32 32 位註冊→CLSID 在 32 位視圖可見→32 位宿主 CoCreateInstance。核心組件：COM 註冊機制、Registry Redirection、WIC。64 位宿主查找 64 位視圖，因無對應登錄而失敗。
- 難度: 中級
- 學習階段: 進階
- 關聯概念: A-Q10, B-Q5, C-Q3

B-Q18: Explorer 縮圖與 WIC Codec 的互動機制？
- A簡: 殼層優先用縮圖提供者；無則呼叫 WIC Codec 解圖產生縮圖並快取。
- A詳: 原理說明：Explorer 查詢 Shell Thumbnail Provider；若無，透過 WIC Imging Factory 嘗試解碼。關鍵步驟：判斷副檔名→查詢 Handler→載入→解碼→快取。核心組件：Shell Extension、WIC Codec、Thumbnail Cache。位元不匹配即無法載入。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: B-Q11, A-Q12, D-Q3

B-Q19: IIS7 的模組化架構與整合管線如何設計？
- A簡: 功能拆為可插拔模組，Managed/Native 同管線；以 XML 組態與細粒度委派管理。
- A詳: 原理說明：IIS7 將驗證、授權、壓縮、URL Rewrite 等拆為模組，並整合 ASP.NET 與原生請求管線。關鍵步驟：配置 applicationHost.config→載入模組→處理請求事件。核心組件：Integrated Pipeline、Module Provider、Appcmd。開發者可於 Vista 啟用需要的元件測試。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q16, C-Q8, D-Q6

B-Q20: 以 Cache 提升體感速度的「錯覺」背後機制？
- A簡: 預取/快取降低冷啟 I/O 延遲，實際 CPU 不變；體感改善主要來自磁碟命中率提升。
- A詳: 原理說明：透過 SuperFetch 預熱工作集，使應用載入時命中記憶體而非磁碟。關鍵步驟：行為分析→預取→命中→回收。核心組件：頁快取、I/O 排程、記憶體管理。雖非計算加速，卻實際縮短等待時間。
- 難度: 初級
- 學習階段: 核心
- 關聯概念: B-Q8, A-Q17, D-Q7

B-Q21: 檔案與登錄重導在 WOW64 的實作細節？
- A簡: system32 由 32 位應用被重導至 SysWOW64；登錄寫入映射至 Wow6432Node。
- A詳: 原理說明：為隔離 32/64 DLL 與設定，WOW64 對特定路徑與金鑰做透明重導。關鍵步驟：攔截 API→判斷位元→改寫路徑/金鑰→呼叫內核。核心組件：File System Redirector、Registry Redirector、Wow64 DLL。避免 32 位應用誤用 64 位系統檔或註冊金鑰。
- 難度: 中級
- 學習階段: 進階
- 關聯概念: B-Q1, D-Q1, C-Q3

B-Q22: COM 本地伺服器常駐如何影響位元版本？
- A簡: 首次啟動的位元決定伺服器進程，後續連線沿用同一進程，導致「切不過去」。
- A詳: 原理說明：COM LocalServer32 以 EXE 進程承載，註冊表定義路徑。關鍵步驟：首次啟動→建立單例或多實例→ROT 記錄→後續 CoCreateInstance 附著。核心組件：COM SCM、ROT、EXE 伺服器。若先啟 64 位，後續 32 位客戶端可能無法跨附，需終止或重開。
- 難度: 高級
- 學習階段: 進階
- 關聯概念: A-Q23, D-Q3, C-Q4

B-Q23: 為何 VS2008 在 Vista/x64 上相容性更佳？
- A簡: 內建支援 UAC、IIS7 偵測與 64 位除錯，減少手動補丁與權限衝突。
- A詳: 原理說明：VS2008 採用更新的除錯子系統與權限要求，對 Vista 新機制適配。關鍵步驟：安裝→偵測系統→配置除錯服務→必要時提權。核心組件：msvsmon、IIS 整合、UAC 合規。相較 VS2005，開發流程更順暢。
- 難度: 初級
- 學習階段: 核心
- 關聯概念: A-Q24, D-Q6, C-Q10

B-Q24: WIC 如何讀取 CR2 中繼資料（Metadata）？
- A簡: 透過對應 Codec 暴露的 Metadata Query Reader，以路徑鍵查詢 EXIF/XMP 等欄位。
- A詳: 原理說明：WIC 由 Codec 提供 Metadata 讀寫介面。關鍵步驟：建立解碼器→取得 Metadata Reader→以查詢路徑讀取。核心組件：IWICImagingFactory、IWICMetadataQueryReader、Codec。位元需匹配，否則無法取得讀取器。
- 難度: 中級
- 學習階段: 進階
- 關聯概念: C-Q2, A-Q11, D-Q2

B-Q25: Vista x64 的驅動簽章強制對相容性的影響？
- A簡: 強制驅動簽章提高穩定性與安全，但阻擋未簽章舊驅動，需尋找 x64 簽章版本。
- A詳: 原理說明：Code Integrity 驗證驅動簽章，未簽章阻擋載入。關鍵步驟：載入前驗證→拒載/允許。核心組件：CI 驗證、I/O Manager。對相容性意謂著舊版虛擬裝置驅動需更新或替代方案。
- 難度: 初級
- 學習階段: 核心
- 關聯概念: D-Q5, A-Q7, B-Q4

---

### Q&A 類別 C: 實作應用類（10題）

C-Q1: 如何在不影響舊系統下，於新硬碟安裝 Vista x64 並雙開機？
- A簡: 於新碟安裝 Vista，維持舊碟 XP；以 BCD 設定啟動選單與預設系統，驗證無誤後再移轉。
- A詳: 具體實作步驟：1) 安裝新 750G 硬碟；2) 設 BIOS 從新碟安裝 Vista x64；3) 安裝完成後，使用 bcdedit /set 與 /displayorder 設定雙開機；4) 測試兩系統互不影響。關鍵設定：bcdedit /timeout 5、bcdedit /default {GUID}。注意事項：安裝時勿格式化舊系統碟；備份重要資料；驅動以 x64 為主；完成後再逐步轉移資料。最佳實踐：建立 Complete PC 映像備份，便於回復。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: B-Q15, A-Q3, A-Q13

C-Q2: 如何將 .NET 專案改為 x86 以載入 32 位 Canon Raw Codec？
- A簡: 在專案設定將平台目標改為 x86，重新編譯；程式即可於 x64 以 32 位進程載入 32 位 Codec。
- A詳: 具體實作步驟：VS 中右鍵專案→屬性→建置→平台目標選 x86→重建。關鍵程式碼/設定：csproj 可見 <PlatformTarget>x86</PlatformTarget>。注意事項：確認所有相依原生 DLL 亦為 32 位；避免 AnyCPU 導致在 x64 變成 64 位；WPF/WIC 於 32 位才能找 32 位 Codec。最佳實踐：以組態（Debug/Release）分別產生 x86 與 AnyCPU/ x64 版本，依場景選用。
- 難度: 初級
- 學習階段: 核心
- 關聯概念: A-Q20, B-Q12, D-Q2

C-Q3: 如何在 Vista x64 安裝並使用 Canon Raw Codec？
- A簡: 安裝 Canon 32 位 Codec，搭配 32 位宿主（自家 x86 程式或 WLPG 32）即可解 CR2。
- A詳: 具體實作步驟：1) 下載並安裝 Canon Raw Codec；2) 確認 32 位註冊（Wow6432Node）；3) 以 32 位應用（x86 編譯或 WLPG 32）開啟 CR2。關鍵設定：以 regedit 檢查 CLSID 在 Wow6432Node；在程式中使用 WIC 建立解碼器。注意事項：64 位宿主無法載入 32 位 Codec；避免混用位元。最佳實踐：以安裝後測試縮圖與 metadata 讀取驗證成功。
- 難度: 初級
- 學習階段: 核心
- 關聯概念: A-Q10, B-Q17, D-Q1

C-Q4: 如何確保開啟 Windows Live Gallery 的 32 位元版本？
- A簡: 使用 32 位捷徑，必要時先結束常駐進程或重開機，再啟 32 位版本避免錯附。
- A詳: 具體實作步驟：1) 開始功能表選擇「Windows Live Gallery（32-bit）」；2) 若仍是 64 位，開工作管理員結束 WLX.exe/相片庫進程；3) 再以 32 位捷徑啟動。關鍵設定：捷徑路徑指向 Program Files (x86)。注意事項：因 COM/OLE 常駐，首次啟動版本決定後續附著；重開機可重置。最佳實踐：將 32 位捷徑釘選工具列，避免誤點。
- 難度: 初級
- 學習階段: 核心
- 關聯概念: A-Q12, A-Q23, D-Q3

C-Q5: 如何將 IE 32 位元設為預設以相容 ActiveX？
- A簡: 以 32 位 IE 捷徑取代預設瀏覽器連結，或在程式預設改指向 iexplore.exe（x86）。
- A詳: 具體實作步驟：1) 建立指向 C:\Program Files (x86)\Internet Explorer\iexplore.exe 的捷徑；2) 設為預設瀏覽器；3) 檢查外掛載入。關鍵設定：關聯 HTTP/HTML 至 IE 32；群組原則可限制使用 IE64。注意事項：更新與安全設定一致維護；企業環境記錄版本。最佳實踐：標示捷徑名稱為「IE（32-bit）」區分。
- 難度: 初級
- 學習階段: 核心
- 關聯概念: A-Q9, B-Q6, D-Q4

C-Q6: 如何用 Vista Complete PC 建立映像並以 VHDMOUNT 掛載？
- A簡: 建立完整備份產生 VHD，再用 VHDMOUNT 掛載為磁碟存取檔案或驗證備份。
- A詳: 具體實作步驟：1) 控制台→備份與還原中心→建立 Complete PC 備份；2) 完成後取得 .vhd；3) 安裝 Virtual Server 2005 R2 SP1 工具；4) vhdmount /p 路徑.vhd 掛載。關鍵設定/指令：vhdmount /m 路徑.vhd；diskmgmt.msc 指派機碼。注意事項：需管理員權限；卸載 vhdmount /u。最佳實踐：備份前關閉重載 I/O 的服務，提升一致性。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q13, B-Q10, D-Q8

C-Q7: 如何啟用與校正 Vista 的平板/墨跡功能搭配數位板？
- A簡: 安裝數位板驅動，啟用 Tablet PC 元件，校正筆輸入與手寫辨識，即可使用墨跡。
- A詳: 具體實作步驟：1) 安裝數位板驅動；2) 控制台→程式與功能→開啟或關閉 Windows 功能→勾選 Tablet PC Components；3) 校正筆輸入；4) 設定手寫辨識語言；5) 測試 TIP。關鍵設定：Tablet PC 設定面板。注意事項：使用者權限與正確語言包；定期更新驅動。最佳實踐：為常用應用啟用墨跡快捷鍵。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: A-Q22, B-Q16, D-Q5

C-Q8: 如何在 Vista 啟用與設定 IIS7 以便學習？
- A簡: 於「開啟或關閉 Windows 功能」勾選 IIS 元件，設定網站與應用程式集區。
- A詳: 具體實作步驟：1) 控制台→程式→開啟或關閉 Windows 功能→IIS 勾選必要模組（IIS 管理員、ASP.NET、ISAPI 等）；2) 開啟 IIS 管理員，建立網站或應用；3) 設定 App Pool 管線模式。關鍵設定：applicationHost.config；appcmd set apppool /managedPipelineMode:Integrated。注意事項：以標準使用者執行站台；必要時提升權限。最佳實踐：只裝需要的模組，降低攻擊面。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q16, B-Q19, D-Q6

C-Q9: 如何驗證 SuperFetch 帶來的啟動改善？
- A簡: 清空快取後量測冷啟，再連續開啟觀察熱啟差異；記錄啟動時間與記憶體命中率。
- A詳: 具體實作步驟：1) 重開機後先量測應用冷啟時間；2) 重複啟動同應用記錄熱啟；3) 觀察資源監視器硬碟/記憶體；4) 比較差異。關鍵設定/指令：winsat prepop 或以效能監視器追蹤。注意事項：避免其他背景工作干擾；樣本數足夠。最佳實踐：挑選大型應用（VS、Photoshop）測試，差異明顯。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: B-Q8, B-Q20, D-Q7

C-Q10: 如何在 Vista x64 安裝 VS2008 並設定穩定除錯？
- A簡: 正常安裝 VS2008，必要時以管理員執行，設定 IIS 附加與 64/32 位程序調試策略。
- A詳: 具體實作步驟：1) 安裝 VS2008；2) 勾選必要 Web 開發元件；3) 以管理員執行 VS 以附加至受保護進程；4) 設定專案平台目標（x86/x64/AnyCPU）對應相依；5) 測試本機 IIS7 調試。關鍵設定：專案屬性→建置→平台目標；Debug→以系統管理員執行。注意事項：VS2005 需安裝補丁；UAC 下附加需提權。最佳實踐：區分解決方案組態以對應外掛位元。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: B-Q13, A-Q20, D-Q6

---

### Q&A 類別 D: 問題解決類（10題）

D-Q1: Vista x64 無法使用 Canon Raw Codec，怎麼辦？
- A簡: 改用 32 位宿主。安裝 Canon Codec 後，以 32 位程式或 WLPG 32 開啟 CR2。
- A詳: 問題症狀描述：CR2 無法顯示縮圖或開啟，應用找不到 Codec。可能原因分析：Codec 僅提供 32 位，64 位宿主無法載入。解決步驟：1) 安裝 Canon Raw Codec；2) 使用 32 位應用（x86 編譯或 WLPG 32）；3) 測試縮圖與 metadata。預防措施：持續追蹤 64 位 Codec；維持應用 x86 版本以相容。
- 難度: 初級
- 學習階段: 核心
- 關聯概念: A-Q10, C-Q3, B-Q5

D-Q2: .NET AnyCPU 程式找不到 32 位 Codec/COM，如何處理？
- A簡: 將平台目標改為 x86，確保以 32 位進程啟動並載入 32 位相依元件。
- A詳: 問題症狀描述：程式運作正常但特定功能失效，拋出載入失敗例外。可能原因分析：AnyCPU 在 x64 以 64 位啟動，位元不匹配。解決步驟：1) 專案改 x86；2) 確認相依 DLL 為 32 位；3) 重新部署。預防措施：針對需原生相依的功能，固定平台目標；文件化相依元件位元需求。
- 難度: 初級
- 學習階段: 核心
- 關聯概念: C-Q2, B-Q12, A-Q21

D-Q3: Windows Live Gallery 仍顯示不出 CR2 縮圖或總開錯版本？
- A簡: 終止常駐進程後以 32 位捷徑重啟；必要時重開機，確保以 WLPG 32 運作。
- A詳: 問題症狀描述：啟動 32 位捷徑仍無法載入 32 位 Codec。可能原因分析：COM/OLE 本地伺服器常駐，沿用先前 64 位進程。解決步驟：1) 結束 WL Gallery 進程；2) 確認路徑為 Program Files (x86)；3) 重新啟動。預防措施：將 32 位版本釘選；開機後先啟正確版本。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: A-Q23, C-Q4, B-Q22

D-Q4: IE 64 位無法載入 ActiveX，該怎麼辦？
- A簡: 改用 IE 32 位元版本或將其設為預設，以保證外掛相容與功能正常。
- A詳: 問題症狀描述：特定網站功能失效或外掛無法載入。可能原因分析：網站僅提供 32 位 ActiveX。解決步驟：1) 啟動 IE 32；2) 設為預設瀏覽器；3) 測試外掛。預防措施：建立明確捷徑與註記；若外掛有 64 位版，優先採用。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: C-Q5, A-Q9, B-Q6

D-Q5: 軟體虛擬裝置（光碟/磁碟/網卡）在 x64 失效？
- A簡: 多因驅動非 64 位或未簽章；尋找 x64 簽章驅動或改用相容解法。
- A詳: 問題症狀描述：裝置無法啟動或代碼 52/錯誤。可能原因分析：x64 拒載 32 位驅動或未簽章。解決步驟：1) 下載對應 x64 驅動；2) 驗證簽章；3) 安裝重啟。預防措施：升級前盤點驅動；優先選擇具 x64 支援的軟體。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: B-Q4, B-Q25, A-Q2

D-Q6: VS2005 在 Vista x64 除錯不穩定/需補丁怎麼辦？
- A簡: 安裝相容性更新並以管理員執行，或直接升級 VS2008 簡化相容性。
- A詳: 問題症狀描述：附加程序/除錯 IIS7 失敗或權限錯誤。可能原因分析：UAC 限制與舊版整合不良。解決步驟：1) 安裝 VS2005 Vista 補丁；2) 以管理員啟動；3) 設專案平台目標；4) 或升級 VS2008。預防措施：新機直接採用 VS2008 以上版本；文件化權限需求。
- 難度: 初級
- 學習階段: 核心
- 關聯概念: B-Q13, C-Q10, A-Q24

D-Q7: 覺得 Vista 記憶體占用高，是記憶體外洩嗎？
- A簡: 多半是 SuperFetch 快取行為，可回收；非外洩，實際負載時會釋放資源。
- A詳: 問題症狀描述：待機時 RAM 使用率高。可能原因分析：SuperFetch 預取佔用空閒。解決步驟：1) 確認任務管理員快取/可用；2) 啟動應用觀察是否即時回收；3) 調整不必要的啟動項。預防措施：了解快取機制；避免誤關重要服務。
- 難度: 初級
- 學習階段: 基礎
- 關聯概念: A-Q17, B-Q8, C-Q9

D-Q8: VHDMOUNT 掛載失敗該如何排查？
- A簡: 檢查驅動安裝與管理員權限，確認 VHD 未損壞，必要時用磁碟管理指派機碼。
- A詳: 問題症狀描述：vhdmount 報錯或無磁碟出現。可能原因分析：驅動未安裝/無權限/VHD 損壞。解決步驟：1) 以管理員執行安裝工具；2) vhdmount /p 測試；3) diskmgmt.msc 檢查並指派機碼；4) 檢查 VHD 完整性。預防措施：建立備份後驗證；保留校驗與重試策略。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: C-Q6, B-Q10, A-Q15

D-Q9: 32 位應用在 x64 仍只能用 2GB 記憶體，怎麼處理？
- A簡: 啟用 LargeAddressAware 讓 x86 應用在 x64 最多用到 4GB 虛擬位址。
- A詳: 問題症狀描述：記憶體密集程式達 2GB 即失敗。可能原因分析：未設 LAA，預設上限 2GB。解決步驟：1) 編譯時加 LargeAddressAware 旗標；2) 或以工具（editbin /LARGEADDRESSAWARE）設定；3) 測試於 x64 OS。預防措施：規劃記憶體配置與碎片；必要時升級至原生 x64。
- 難度: 中級
- 學習階段: 進階
- 關聯概念: B-Q7, A-Q18, A-Q19

D-Q10: 安裝 Vista 後無法正確列出雙開機選單？
- A簡: 使用 bcdedit 修正 BCD 項目與預設順序；必要時重建啟動項。
- A詳: 問題症狀描述：只進 Vista 或無 XP 選項。可能原因分析：BCD 未新增 XP 項。解決步驟：1) 以管理員開 cmd；2) bcdedit /create {ntldr} /d "Windows XP"；3) bcdedit /set {ntldr} device partition=C:；4) /displayorder 與 /default 調整；5) 重啟測試。預防措施：安裝前備份 BCD；使用圖形工具減少誤操作。
- 難度: 中級
- 學習階段: 核心
- 關聯概念: B-Q15, C-Q1, A-Q3

---

### 學習路徑索引
- 初學者：建議先學習哪 15 題
    - A-Q1: 什麼是 Windows Vista Ultimate x64？
    - A-Q2: 什麼是 32 位元與 64 位元作業系統的差異？
    - A-Q3: 為什麼需要從 XP 升級到 Vista x64？
    - A-Q4: 什麼是 Windows XP Media Center Edition（MCE）與其在 Vista 的延續？
    - A-Q10: 什麼是 Canon Raw Codec？在 x64 環境的重要性？
    - A-Q12: 什麼是 Windows Live Gallery（相片庫）32/64 位元版本的差別？
    - A-Q13: 什麼是 Vista Complete PC Backup？為何實用？
    - A-Q17: 什麼是 SuperFetch？為何常被誤解？
    - A-Q20: 什麼是 .NET 的 AnyCPU、x86、x64 目標平台差異？
    - C-Q2: 如何將 .NET 專案改為 x86 以載入 32 位 Canon Raw Codec？
    - C-Q3: 如何在 Vista x64 安裝並使用 Canon Raw Codec？
    - C-Q4: 如何確保開啟 Windows Live Gallery 的 32 位元版本？
    - D-Q1: Vista x64 無法使用 Canon Raw Codec，怎麼辦？
    - D-Q4: IE 64 位無法載入 ActiveX，該怎麼辦？
    - D-Q7: 覺得 Vista 記憶體占用高，是記憶體外洩嗎？

- 中級者：建議學習哪 20 題
    - A-Q5: 什麼是 WOW64（Windows-on-Windows 64）？
    - A-Q6: 為何同一個程序內不能混用 32 與 64 位元程式碼？
    - A-Q7: 驅動程式與 DLL（含外掛/編解碼器）在 x64 相容性上有何差異？
    - A-Q11: 什麼是 WPF 影像編解碼與其與 WIC 的關係？
    - A-Q18: 為何升級 x64 有助於突破 4GB 記憶體限制？
    - A-Q19: 為何 32 位元應用在 x64 上仍可能受惠？
    - B-Q1: WOW64 相容層如何運作？
    - B-Q5: WIC/WPF 如何尋找並載入影像 Codec？
    - B-Q6: IE 32/64 與 ActiveX 的相容性機制為何？
    - B-Q7: 32 位應用在 x64 的記憶體位址空間如何配置？
    - B-Q8: SuperFetch 的工作機制是什麼？
    - B-Q9: Vista Complete PC 備份影像運作原理？
    - B-Q10: VHDMOUNT 如何將 VHD 掛載為磁碟？
    - B-Q11: 殼層縮圖在 x64 與 x86 的處理管線有何不同？
    - C-Q1: 如何在不影響舊系統下，於新硬碟安裝 Vista x64 並雙開機？
    - C-Q5: 如何將 IE 32 位元設為預設以相容 ActiveX？
    - C-Q6: 如何用 Vista Complete PC 建立映像並以 VHDMOUNT 掛載？
    - C-Q8: 如何在 Vista 啟用與設定 IIS7 以便學習？
    - D-Q2: .NET AnyCPU 程式找不到 32 位 Codec/COM，如何處理？
    - D-Q3: Windows Live Gallery 仍顯示不出 CR2 縮圖或總開錯版本？

- 高級者：建議關注哪 15 題
    - B-Q2: 32 位元應用在 x64 的執行流程為何？
    - B-Q3: 為何載入器禁止混用 32/64 位元模組？
    - B-Q4: 為何 64 位元 Windows 無法載入 32 位元驅動？
    - B-Q12: .NET AnyCPU 在 x64 的 JIT 選擇流程？
    - B-Q14: PAE 與 x64 擴充記憶體的差異？
    - B-Q15: 雙開機（XP+Vista）在啟動管理上的運作？
    - B-Q17: Canon Raw Codec 在 x64 的 COM 註冊與尋址？
    - B-Q18: Explorer 縮圖與 WIC Codec 的互動機制？
    - B-Q19: IIS7 的模組化架構與整合管線如何設計？
    - B-Q21: 檔案與登錄重導在 WOW64 的實作細節？
    - B-Q22: COM 本地伺服器常駐如何影響位元版本？
    - B-Q23: 為何 VS2008 在 Vista/x64 上相容性更佳？
    - B-Q24: WIC 如何讀取 CR2 中繼資料（Metadata）？
    - D-Q5: 軟體虛擬裝置（光碟/磁碟/網卡）在 x64 失效？
    - D-Q9: 32 位應用在 x64 仍只能用 2GB 記憶體，怎麼處理？