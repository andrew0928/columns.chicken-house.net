# 該如何學好「寫程式」#5 – 善用 TRACE / ASSERT

# 問答集 (FAQ, frequently asked questions and answers)

## Q: 為什麼要在程式裡大量使用 TRACE 與 ASSERT？
TRACE / ASSERT 的目的，是在「同一份原始碼」下同時維護 DEBUG 版與 RELEASE 版：  
• DEBUG 版把除錯資訊輸出到視窗或記錄檔，並在條件不符合預期時以 ASSERT 立刻中斷，讓錯誤自動浮出。  
• RELEASE 版則關閉或移除這些檢查，讓最終使用者不受干擾。  
如此就能在開發階段快速找出 BUG，而正式版本仍保持乾淨穩定。

## Q: ASSERT 應該抓「使用者輸入錯誤」還是「程式邏輯錯誤」？
ASSERT 用來抓「程式邏輯錯誤」（BUG）。像是 API 已明訂參數不得為 NULL，但有人硬傳 NULL 進來——這就是 BUG，應由 ASSERT 立刻叫停。  
相反地，使用者在畫面上漏填資料、輸入格式錯誤，屬於執行期錯誤，應以正常的錯誤處理（try/catch、訊息提示等）回應，而不是 ASSERT。

## Q: 要交付給客戶的最終產品如何避免跳出 ASSERT 視窗？
將產品以 RELEASE 模式編譯（或顯式關閉 TRACE / ASSERT）即可。ASSERT 相關程式碼在 RELEASE 組態下會被移除或失效，終端使用者不會看到任何 ASSERT 訊息。

## Q: 什麼是「雙演算法驗算」？它如何配合 ASSERT 抓錯？
在關鍵計算（例如 Excel 的儲存格運算）中，可同時實作：  
1. 一個邏輯簡單、較慢但安全的版本  
2. 一個經過最佳化、速度快的版本  
DEBUG 版時讓兩個演算法對同一份資料各算一次，再用 ASSERT 比對結果；只要答案不同，就能立即偵測到至少有一方實作有誤。

## Q: ASSERT 與單元測試有何關聯？
兩者都是「把錯誤第一時間攔下」的思想：  
• ASSERT 是被動地嵌在程式碼裡，於執行時即時檢查不變條件。  
• 單元測試則把這些檢查抽離成獨立的 Test Case，主動一次跑完所有測試。  
因此單元測試可視為將 ASSERT 系統化、自動化後的進階應用。

## Q: 作者認為，一名軟體工程師寫出可靠程式所需要的心態是什麼？
寫程式時必須「隨時想著減少 BUG」。要主動布下防線（TRACE / ASSERT、錯誤處理、單元測試），而不是只埋頭完成正常流程。這樣不但能大幅提升程式穩定度，也會讓開發者對自己的程式更有信心，進而敢在安全網的保護下衝得更快。