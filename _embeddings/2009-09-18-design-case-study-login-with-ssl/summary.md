# [設計案例] Login With SSL ?

## 摘要提示
- SSL 與加密誤區: SSL 只加密傳輸過程，無法保護資料被下載後外洩。  
- 登入應用場景: SSL 最適合用於帳號、密碼、信用卡號等敏感資訊的「輸入」階段。  
- 效能考量: 站點全程使用 HTTPS 會造成效能負擔，建議僅在登入階段使用。  
- 內賊風險: SSL 防外賊不防內賊，真正需要保護文件流向應考慮 DRM/DPM。  
- HTTP/HTTPS 雙站模型: 可將登入流程獨立在 HTTPS，業務邏輯仍跑在 HTTP。  
- TOKEN 橋接機制: 以一次性 TOKEN 將登入資訊安全轉交給非 SSL 站。  
- 可擴充架構: 隨流量可將 A(HTTPS) 與 B(HTTP) 站分離，甚至做成 Web Farm。  
- 傳輸媒介選擇: 同機可用檔案、跨機可用 DB/WCF 等作為 A、B 站共享登入資訊的管道。  
- 難題一覽: SESSION 不共通、TOKEN 驗證、HASH/EXPIRE 設計等是常被忽略的漏洞。  
- 實務比喻: TOKEN 如同刷卡授權碼，外人就算截取也無法冒用。

## 全文重點
本文聚焦「網站登入流程如何安全地導入 SSL」這一常見卻易被誤解的議題。作者首先澄清企業常把「加 SSL＝資料絕對安全」畫上等號的迷思；實際上 SSL 只有在用戶端與伺服器之間傳輸資料時提供加密，資料一旦送達終端便失去保護，對內部人員或下載後的內容外洩毫無抵禦力，如需永久保護則需 DRM/DPM 類方案。因此，如果僅需防止外部竊聽，將登入表單或信用卡欄位包在 HTTPS 內即可；驗證完成後可立即切回 HTTP，以避免全站 HTTPS 帶來的 CPU 負載與維運成本。

在技術實作上，作者將整體網站拆分成兩個邏輯站點：A 站(HTTPS) 專責接收帳號密碼並產生一次性 TOKEN；B 站(HTTP) 接手 TOKEN、自行向後端存儲取回登入資訊並完成驗證，之後在自己的 SESSION 建立使用者登入狀態。此 TOKEN 採用雜湊＋有效期限控管，具備被竊取也無害的特性，類似實體刷卡時的授權碼。若流量不大，A、B 站可同置一機，透過檔案或記憶體共享資料；流量放大後可分別獨立並以資料庫、WCF 或分散式快取承載跨機通訊需求。作者並簡列常見落點：HTTP/HTTPS SESSION 不共通、TOKEN 驗證流程不嚴謹、HASH 與 EXPIRE 設計欠佳等，提醒讀者在設計時務必補強。

## 段落重點
### 1. 為何談 SSL 與登入
作者以實務客戶案例開場，指出企業常誤以為 SSL 能全面防洩密；實際 SSL 僅加密傳輸，無法阻擋內賊與下載後外傳。若只想防竊聽，應把重點放在登入與金流資料的安全傳輸，而非將整站強制切到 HTTPS。

### 2. SSL 的正確定位與常見誤解
以黑貓宅急便與運鈔車比喻，說明 SSL 僅保障「運送途中」，貨物抵達後即失去保護。真正要持續保護內容需靠 DRM。許多 IT 團隊因混淆概念而導致效能浪費或安全死角。

### 3. HTTP/HTTPS 分層模型
透過圖示解釋：將帳號密碼的提交階段劃入綠色區(HTTPS)，其餘業務流仍跑在橘色區(HTTP)。若視兩協定為兩站，可進一步阻絕外部攻擊，同時兼顧效能。

### 4. TOKEN 式登入流程設計
提出四步驟方案：1) 使用者在 A 站(HTTPS) 輸入帳密；2) A 站存儲資料並產生 HASH＋期限的 TOKEN；3) 將 TOKEN 轉交 B 站；4) B 站驗證 TOKEN 後從儲存取回帳密並走原有驗證邏輯、建立 SESSION。TOKEN 類比刷卡授權碼，不怕外洩。

### 5. 部署與擴充策略
若流量小可同機部署，資料共享方式彈性；量大時需將 A、B 站切分乃至建置 Web Farm，須選用 DB、WCF、分散式快取等可跨機傳輸的媒介。HTTPS 區域屬 CPU bound，需預估擴充性。

### 6. 常見技術盲點
點出 SESSION 不可共用、TOKEN 生成與驗證細節、HASH 方式與過期機制等常被忽視的漏洞，提醒實作人員應在設計階段即納入風險評估並補強。