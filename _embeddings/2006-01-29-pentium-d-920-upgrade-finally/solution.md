## Case #1: 選擇支援 VT 與 EM64T 的 CPU（由 Pentium D 820 到 920）

### Problem Statement（問題陳述）
業務場景：作者長期在單機上承載多角色服務（Web、SMTP、檔案、VM、VPN/NAT、影片轉檔），且偏好讓伺服器長時間執行背景工作。需要在主機上運行虛擬機，以便隔離服務與做測試。原本評估 Pentium D 820，但因不支援 Intel VT，遲遲未更換。
技術挑戰：虛擬化需要硬體輔助（Intel VT）才能獲得更佳相容性與效能；同時需要 64 位元支援（EM64T）以導入 x64 作業系統。
影響範圍：無法順利導入虛擬化，限制服務隔離與測試；無法升上 x64 限制未來擴展性。
複雜度評級：中

### Root Cause Analysis（根因分析）
直接原因：
1. Pentium D 820 缺乏 Intel VT，導致虛擬化平台受限或效能不佳。
2. 舊平台缺乏 x64 支援，限制可用 OS 與應用版本。
3. 多角色共存，缺乏虛擬化隔離，背景載重影響前台服務。

深層原因：
- 架構層面：單機多角色無虛擬化隔離，資源爭奪與變更風險大。
- 技術層面：CPU 選型未對齊虛擬化與 x64 的必要條件。
- 流程層面：硬體評估延誤（「龜半天」）造成升級時程拉長。

### Solution Design（解決方案設計）
解決策略：更換支援 VT 與 EM64T 的處理器（Pentium D 920），搭配 945P 晶片組與 DDR2-533 記憶體，升級至 Windows Server 2003 x64，讓主機具備虛擬化與 64 位元環境的基礎，為後續服務遷移與隔離提供平台。

實施步驟：
1. 硬體選型與安裝
- 實作細節：選擇 Pentium D 920 + 945P + 2GB DDR2-533；更新主機板 BIOS 確保 VT 選項可見。
- 所需資源：主機板、CPU、RAM、散熱器、BIOS 更新工具。
- 預估時間：4-6 小時（含拆裝與穩定性測試）。

2. 驗證 CPU 功能（VT 與 EM64T）
- 實作細節：使用 CPUID 或工具（CPU-Z、Intel Processor ID）驗證 VMX/EM64T。
- 所需資源：系統工具或自建檢測程式。
- 預估時間：0.5 小時。

3. 安裝 Windows Server 2003 x64 並測試基礎相容性
- 實作細節：乾淨安裝，導入必要驅動，確認 x64 模式運行。
- 所需資源：安裝媒體、驅動程式包。
- 預估時間：2-3 小時。

關鍵程式碼/設定：
```c
// C/C++：檢查 CPUID 是否支援 VT (VMX) 與 EM64T
#include <stdio.h>
#ifdef _MSC_VER
#include <intrin.h>
#endif
int main() {
    int cpuInfo[4] = {0};
    __cpuid(cpuInfo, 1);
    int ecx = cpuInfo[2], edx = cpuInfo[3];
    int hasVMX   = (ecx & (1 << 5))  != 0;  // VT-x
    int hasEM64T = (edx & (1 << 29)) != 0;  // EM64T
    printf("VT-x: %s\n", hasVMX ? "Yes" : "No");
    printf("EM64T: %s\n", hasEM64T ? "Yes" : "No");
    return 0;
}
```

實際案例：作者由 820 改為 920，成功導入 x64 OS 與虛擬化用途。
實作環境：Pentium D 920、945P、2GB DDR2-533、Windows Server 2003 x64。
實測數據：
改善前：無 VT、32 位元限制。
改善後：可執行 x64 與硬體輔助虛擬化；（主觀）效能反應更快。
改善幅度：定性改善（文章未提供量化數據）。

Learning Points（學習要點）
核心知識點：
- CPU 指令集與功能對虛擬化與 x64 的影響
- CPUID 檢測方法
- 平台升級對多角色整合的基礎價值

技能要求：
必備技能：硬體選型、OS 安裝、基本韌體設定
進階技能：CPUID/系統工具分析、相容性驗證

延伸思考：
- 也可應用於容器或更現代的虛擬化平台選型。
- 風險：韌體未開啟 VT 造成誤判；驅動相容性問題。
- 可優化：更換更節能架構以兼顧效能與功耗。

Practice Exercise（練習題）
基礎練習：用工具驗證你電腦的 VT 與 x64 支援（30 分鐘）
進階練習：撰寫 CPUID 程式檢測 VMX/EM64T 並輸出結果（2 小時）
專案練習：完成一次從 32 位元到 x64 的伺服器重裝與基本服務上線（8 小時）

Assessment Criteria（評估標準）
功能完整性（40%）：能正確驗證與開啟 VT、安裝 x64 OS
程式碼品質（30%）：CPUID 檢測程式結構清晰、註解完整
效能優化（20%）：安裝後基本效能驗證流程完整
創新性（10%）：硬體選型與驗證工具自動化程度
```

## Case #2: 導入 Windows Server 2003 x64 並整合多服務角色

### Problem Statement（問題陳述）
業務場景：單機承載 Web（ASP.NET 2.0）、SMTP、檔案分享、虛擬機、VPN/NAT、影片轉檔等多角色，需要升級作業系統至 64 位元以提升擴展性與整體反應，並降低舊架構限制。
技術挑戰：確保各角色在 x64 OS 正確運作，處理驅動與應用相容性，規劃 32/64 位元混合應用的併存策略。
影響範圍：所有對外服務，升級不當會導致服務中斷或相容性問題。
複雜度評級：高

### Root Cause Analysis（根因分析）
直接原因：
1. 需要 x64 OS 以支援更現代的服務與效能（EM64T）。
2. 原有應用中含 32 位元相依（如部落格），需處理併存。
3. 驅動程式、IIS、RRAS 等在 x64 的安裝與設定差異。

深層原因：
- 架構層面：多角色整合在同一 OS，依賴正確的位元模式管理。
- 技術層面：x64 與 WOW64 相容性議題。
- 流程層面：需要兼顧不停機與設定一致性。

### Solution Design（解決方案設計）
解決策略：進行乾淨安裝 Windows Server 2003 x64，對每個角色分別做 x64 版本部署；對僅支援 x86 的應用，透過 IIS 6 32 位元應用集區或替換方案處理；完成後進行服務驗證與觀察期。

實施步驟：
1. 安裝 OS 與驅動
- 實作細節：安裝 2003 x64，導入晶片組/網卡/儲存驅動。
- 所需資源：驅動包、KVM 或遠端管理。
- 預估時間：2-3 小時。

2. 部署各角色（Web、SMTP、File、RRAS、VM、Encoder）
- 實作細節：IIS 6、IIS SMTP、檔案分享、RRAS、虛擬化平台、WME9。
- 所需資源：安裝媒體、套件。
- 預估時間：4-6 小時。

3. 規劃 32/64 位元併存
- 實作細節：對特定站台啟用 x86 應用集區（見 Case #3）。
- 所需資源：IIS 管理工具。
- 預估時間：1 小時。

關鍵程式碼/設定：
```cmd
:: 驗證 OS 與 CPU 位元
wmic os get osarchitecture
wmic cpu get Name

:: 確認 ASP.NET 2.0 已註冊
%WINDIR%\Microsoft.NET\Framework64\v2.0.50727\aspnet_regiis.exe -i
```

實際案例：作者完成 2003 x64 安裝並運行多角色，主觀感受比 32 位元快。
實作環境：Pentium D 920、945P、2GB RAM、Windows Server 2003 x64。
實測數據：
改善前：32 位元環境，應用受限。
改善後：多角色在 x64 運行；主觀速度更快。
改善幅度：定性改善（文章未提供量化數據）。

Learning Points（學習要點）
核心知識點：
- x64 與 WOW64 概念與相容策略
- 多角色服務在單機的風險與隔離策略
- 服務逐一驗證與回退計畫的重要性

技能要求：
必備技能：Windows 伺服器管理、IIS、RRAS、檔案服務
進階技能：位元模式併存、驅動與相容性處理

延伸思考：
- 可將部分角色搬入 VM 提升隔離與維護性。
- 風險：單點故障；相容性坑點。
- 優化：自動化安裝與設定管理（例如批次/腳本）。

Practice Exercise（練習題）
基礎練習：安裝 2003 x64 並啟用 IIS 6 + ASP.NET 2.0（30 分鐘）
進階練習：在同機配置 RRAS NAT 與檔案分享（2 小時）
專案練習：完成多角色整機部署手冊與回復程序（8 小時）

Assessment Criteria（評估標準）
功能完整性（40%）：所有角色可用
程式碼品質（30%）：自動化腳本與文件完備
效能優化（20%）：基本調校與觀察
創新性（10%）：併存與隔離策略設計
```

## Case #3: x64 上運行 32 位元部落格的相容性處理（IIS 6 32-bit App Pool）

### Problem Statement（問題陳述）
業務場景：部落格系統僅能在 32 位元模式運行，但主機 OS 已升級至 Windows Server 2003 x64，造成網站無法在預設 64 位元應用集區運作。
技術挑戰：IIS 6 預設在 x64 啟動 64 位元工作行程，32 位元相依會導致載入失敗。
影響範圍：部落格網站對外服務中斷。
複雜度評級：中

### Root Cause Analysis（根因分析）
直接原因：
1. 部落格系統含 32 位元元件（可能為 COM/原生 DLL）。
2. IIS 6 預設 64 位元應用集區與 32 位元模組不相容。
3. 缺少對 x86 應用集區的正確設定。

深層原因：
- 架構層面：應用對平台位元耦合。
- 技術層面：IIS 6 工作者程序位元模式與 ISAPI/模組相依。
- 流程層面：升級前未完成相容性盤點。

### Solution Design（解決方案設計）
解決策略：為該網站建立 32 位元應用集區或臨時啟用整機 32 位元模式，確保網站可運作，並制定後續替換/升級計畫以移除 x86 相依。

實施步驟：
1. 啟用 32-bit Worker Process（IIS 6）
- 實作細節：Enable32bitAppOnWin64 設為 1。
- 所需資源：adsutil.vbs、IIS 6 管理工具。
- 預估時間：15 分鐘。

2. 分離應用集區並指派網站
- 實作細節：為部落格新建 x86 集區，其他站台用 x64 集區。
- 所需資源：IIS MMC。
- 預估時間：15 分鐘。

3. 長期策略：升級/替換部落格為 64 位元相容版本
- 實作細節：評估替代方案（作者選擇更換）。
- 所需資源：新系統評估與資料遷移。
- 預估時間：1-2 天。

關鍵程式碼/設定：
```cmd
:: 全機啟用 32 位元工作行程（若需）
cscript %SystemDrive%\Inetpub\AdminScripts\adsutil.vbs set w3svc/AppPools/Enable32bitAppOnWin64 1

:: 或建立專用 x86 應用集區（IIS MMC 中設定）
:: 並將部落格站台指派到該集區
```

實際案例：作者最終更換部落格系統，避免 x86 依賴。
實作環境：Windows Server 2003 x64、IIS 6、ASP.NET 2.0。
實測數據：
改善前：部落格在 x64 集區無法運行。
改善後：啟用 x86 集區或更換系統可正常提供服務。
改善幅度：可用性由 0% 提升至 100%（功能層面）。

Learning Points（學習要點）
核心知識點：
- IIS 6 在 x64 的 32/64 位元模式
- WOW64 與原生 DLL 相容性
- 實務上分 Pool 管理應用

技能要求：
必備技能：IIS 6 管理、應用相容性分析
進階技能：應用遷移與資料轉換

延伸思考：
- 可應用於其他依賴 x86 COM 的 Web 應用。
- 風險：全機切 x86 會影響其他 x64 網站效能/可用性。
- 優化：盡快移除 x86 依賴，統一 x64。

Practice Exercise（練習題）
基礎練習：在 2003 x64 建立 x86 應用集區並部署簡單 x86 WebApp（30 分鐘）
進階練習：將一個 32 位元網站與 64 位元網站分別跑在不同 Pool（2 小時）
專案練習：將舊部落格資料遷移到新相容系統（8 小時）

Assessment Criteria（評估標準）
功能完整性（40%）：x86 Web 正常運行且不影響 x64 站台
程式碼品質（30%）：配置腳本/文件清晰
效能優化（20%）：分 Pool 隔離良好
創新性（10%）：遷移自動化與最小停機
```

## Case #4: IIS 6 上僅允許 ASP.NET 2.0（移除混用與非必要 ISAPI）

### Problem Statement（問題陳述）
業務場景：Web Server 僅需承載 ASP.NET 2.0 站台，為降低攻擊面與相容性風險，需移除不必要的舊版 ASP/ISAPI 以及無用的 Web 元件。
技術挑戰：IIS 6 預設可能啟用多種 Web 擴充，混用容易帶來相容性與安全風險。
影響範圍：所有 Web 站台的穩定性與安全性。
複雜度評級：低

### Root Cause Analysis（根因分析）
直接原因：
1. 非必要的 ISAPI/擴充被啟用，增加攻擊面。
2. 混用 ASP.NET 1.1/2.0 可能引起衝突。
3. 過多的 IIS 功能影響維護複雜度。

深層原因：
- 架構層面：缺乏最小化原則。
- 技術層面：IIS 擴充管理與版本並存問題。
- 流程層面：部署時未執行基線硬化。

### Solution Design（解決方案設計）
解決策略：僅註冊 ASP.NET 2.0 64 位元（或相應 x86 Pool 的 2.0），停用/移除無需的 ISAPI/擴充，建立基線設定與管控清單。

實施步驟：
1. 註冊 ASP.NET 2.0 並停用其他版本
- 實作細節：使用 aspnet_regiis 指定版本。
- 所需資源：.NET 2.0 工具。
- 預估時間：20 分鐘。

2. 移除不必要的 Web Service Extensions
- 實作細節：IIS 6 MMC -> Web Service Extensions -> 設為 Prohibit。
- 所需資源：IIS 6 MMC。
- 預估時間：20 分鐘。

3. 建立部署基線與稽核
- 實作細節：文件化允許清單。
- 所需資源：文件模板。
- 預估時間：1 小時。

關鍵程式碼/設定：
```cmd
:: 僅註冊 ASP.NET 2.0 (x64)
%WINDIR%\Microsoft.NET\Framework64\v2.0.50727\aspnet_regiis.exe -i

:: 禁用無需的 Web Service Extensions（使用 MMC 或 adsutil 進行）
```

實際案例：作者標明 Web Server 僅承載 ASP.NET 2.0。
實作環境：Windows Server 2003 x64、IIS 6、.NET 2.0。
實測數據：
改善前：潛在混用與擴充暴露。
改善後：縮小攻擊面、降低衝突（定性）。
改善幅度：定性改善。

Learning Points（學習要點）
核心知識點：
- IIS 6 Web Service Extensions 管理
- 版本並存衝突預防
- 安全基線最小化

技能要求：
必備技能：IIS 6 管理、.NET 註冊/版本管理
進階技能：安全基線制定與持續稽核

延伸思考：
- 適用於任何最小化硬化場景。
- 風險：誤禁用造成功能缺失。
- 優化：配置即程式碼（IaC）保存基線。

Practice Exercise（練習題）
基礎練習：僅啟用 ASP.NET 2.0 的最小 IIS 設定（30 分鐘）
進階練習：撰寫批次腳本自動化 IIS 基線（2 小時）
專案練習：建立企業級 Web 基線與稽核流程（8 小時）

Assessment Criteria（評估標準）
功能完整性（40%）：僅必需擴充啟用
程式碼品質（30%）：自動化腳本健全
效能優化（20%）：無多餘模組負擔
創新性（10%）：基線治理與文件化
```

## Case #5: 升級後 100Mbps 網路被塞爆，規劃 Gigabit 乙太網（GBE）

### Problem Statement（問題陳述）
業務場景：升級 CPU 與 x64 後，檔案/網頁傳輸高峰時出現 100Mbps 網路打滿的情況，成為系統新瓶頸。
技術挑戰：現有交換器/網卡僅 100M，無法應對提升後的處理與 IO 能力。
影響範圍：所有透過網路的服務吞吐與延遲。
複雜度評級：中

### Root Cause Analysis（根因分析）
直接原因：
1. 100Mbps 物理上限（實際約 94Mbps）已達頂。
2. 主機升級後，CPU/磁碟不再是瓶頸，使網路成為最弱環節。
3. 網路設備與佈線（Cat5）不支援 GBE。

深層原因：
- 架構層面：端到端容量不一致。
- 技術層面：網卡/交換器規格不足。
- 流程層面：升級規劃未同步網路層。

### Solution Design（解決方案設計）
解決策略：端到端升級至 GBE（伺服器 NIC、交換器、佈線），同步調整 OS 網路設定並進行吞吐測試與觀察，確保網路不再為首要瓶頸。

實施步驟：
1. 網路硬體升級
- 實作細節：更換為 1GbE NIC 與千兆交換器；檢查線材 Cat5e/Cat6。
- 所需資源：Intel/Realtek 1GbE NIC、GbE Switch、線材。
- 預估時間：2-3 小時。

2. OS 調整與測試
- 實作細節：安裝驅動；以 iperf 測試吞吐；必要時調整 Jumbo Frame。
- 所需資源：iperf、驅動工具。
- 預估時間：1-2 小時。

關鍵程式碼/設定：
```cmd
:: 以 iperf 測試（需另行下載 iperf）
iperf -s  :: 伺服器端
iperf -c <server-ip> -P 4 -t 30  :: 客戶端併發測試
```

實際案例：作者觀察到 100M 網路打滿，並計畫升級至 GBE。
實作環境：Windows Server 2003 x64。
實測數據：
改善前：網卡利用率達 100%（100M 被塞爆）。
改善後：預期單向可達數百 Mbps（視磁碟/CPU）。
改善幅度：目標性改善（文章未提供實測 GBE 數據）。

Learning Points（學習要點）
核心知識點：
- 系統瓶頸轉移概念（Amdahl）
- 端到端網路升級要素（NIC/交換器/線材）
- 基準測試方法（iperf）

技能要求：
必備技能：基礎網路、設備安裝
進階技能：吞吐測試與參數調校（MTU、Jumbo）

延伸思考：
- 可應用於備份/檔案伺服器。
- 風險：Jumbo Frames 與設備不相容。
- 優化：LACP 聚合鏈路或 2.5/10GbE。

Practice Exercise（練習題）
基礎練習：用 iperf 測出舊 100M 吞吐（30 分鐘）
進階練習：升級單機到 1GbE 並測試差異（2 小時）
專案練習：規劃整個機櫃的 GBE 升級方案（8 小時）

Assessment Criteria（評估標準）
功能完整性（40%）：端到端 GBE 打通
程式碼品質（30%）：測試腳本與報告
效能優化（20%）：吞吐與延遲改善
創新性（10%）：升級成本效益評估
```

## Case #6: 在 x64 主機上部署虛擬化平台並啟用硬體輔助

### Problem Statement（問題陳述）
業務場景：主機需同時承載多角色，虛擬化可用於隔離與測試。升級 CPU 後具備 VT 與 x64 能力，需落地虛擬化平台。
技術挑戰：確保 BIOS 開啟 VT、選型與部署相容的虛擬化平台、配置資源限制避免干擾主機。
影響範圍：所有在 VM 中的服務與主機穩定性。
複雜度評級：中

### Root Cause Analysis（根因分析）
直接原因：
1. 先前 CPU 不支援 VT，虛擬化受限。
2. BIOS 預設可能關閉 VT。
3. 資源配置不當會影響主機服務。

深層原因：
- 架構層面：多角色需要隔離層。
- 技術層面：虛擬化與硬體輔助依賴 BIOS/CPU。
- 流程層面：資源治理缺乏。

### Solution Design（解決方案設計）
解決策略：安裝虛擬化平台（如 Microsoft Virtual Server 2005 R2 或 VMware Server），在 BIOS 開啟 VT，創建 VM 並設定 CPU/記憶體/網路的資源界限與隔離，確保主機服務穩定。

實施步驟：
1. 開啟 VT 與檢查
- 實作細節：BIOS 內啟用 Intel VT-x；以工具確認。
- 所需資源：主機板 BIOS、檢測工具。
- 預估時間：30 分鐘。

2. 安裝虛擬化平台與建立 VM
- 實作細節：安裝 Virtual Server 2005 R2；用 VBS 自動化建立 VM。
- 所需資源：安裝媒體、管理工具。
- 預估時間：2 小時。

關鍵程式碼/設定：
```vb
' VBScript：建立 Virtual Server VM（概念示例）
Set vs = CreateObject("VirtualServer.Application")
Set vm = vs.CreateVirtualMachine("TestVM", "D:\VMs\TestVM.vmc")
vm.Memory = 512 * 1024 * 1024 ' 512MB
vm.Save
```

實際案例：作者將虛擬機列為主要服務之一。
實作環境：Windows Server 2003 x64、Pentium D 920。
實測數據：
改善前：無法或不宜使用虛擬化。
改善後：能夠在主機上運行 VM 以隔離服務。
改善幅度：功能性達成（文章未提供效能數據）。

Learning Points（學習要點）
核心知識點：
- VT 與虛擬化平台關係
- VM 資源治理與隔離
- 自動化建立 VM

技能要求：
必備技能：虛擬化平台安裝、基本自動化
進階技能：資源限制、隔離與監控

延伸思考：
- 可遷移到更現代平台（Hyper-V/ESXi）。
- 風險：過度分配、I/O 瓶頸。
- 優化：以 QoS/親和性保護主機工作集。

Practice Exercise（練習題）
基礎練習：建立一台最小 VM（30 分鐘）
進階練習：撰寫腳本批量建立 VM 並配置資源（2 小時）
專案練習：把一個輕量服務搬進 VM 並測試隔離（8 小時）

Assessment Criteria（評估標準）
功能完整性（40%）：VM 可正常建立與運行
程式碼品質（30%）：自動化腳本結構清晰
效能優化（20%）：合理資源限制
創新性（10%）：隔離策略設計
```

## Case #7: 在 2003 x64 配置 RRAS 實現 VPN 與 NAT

### Problem Statement（問題陳述）
業務場景：同一台主機需提供 VPN 與 NAT，讓遠端可存取內網，同時讓內網設備透過主機對外。
技術挑戰：正確啟用 RRAS 功能，配置 NAT 與 VPN（PPTP/L2TP），處理基本防火牆與路由。
影響範圍：遠端辦公、內網對外連線。
複雜度評級：中

### Root Cause Analysis（根因分析）
直接原因：
1. 未安裝與啟用 RRAS。
2. 路由/NAT 介面未正確指定。
3. VPN 通道與認證未正確設定。

深層原因：
- 架構層面：單機多角色需要網路邊界能力。
- 技術層面：RRAS 配置細節繁多。
- 流程層面：缺乏自動化與文件化。

### Solution Design（解決方案設計）
解決策略：在 2003 x64 啟用 RRAS，配置一張外網、一張內網 NIC，開啟 NAT 與 VPN，進行通訊測試與基本強化（允許清單、憑證）。

實施步驟：
1. 安裝與啟用 RRAS
- 實作細節：管理工具中啟用，或用 netsh 基本腳本。
- 所需資源：系統元件。
- 預估時間：1 小時。

2. 配置 NAT 與 VPN
- 實作細節：指定外網介面做 NAT，建立 VPN 入口（PPTP）。
- 所需資源：靜態路由規劃、帳號。
- 預估時間：1-2 小時。

關鍵程式碼/設定：
```cmd
:: 啟用 RRAS（需在 GUI 或 routing 命令中完成細節）
netsh routing ip nat install
netsh routing ip nat add interface "WAN" full
netsh routing ip nat add interface "LAN" private

:: 範例：允許 PPTP（TCP 1723）與 GRE（協定 47）通過防火牆/路由
```

實際案例：作者列出 VPN & NAT 為核心服務之一。
實作環境：Windows Server 2003 x64。
實測數據：
改善前：遠端/內網對外能力缺乏。
改善後：提供 VPN 與 NAT 功能。
改善幅度：功能性達成。

Learning Points（學習要點）
核心知識點：
- RRAS NAT 與 VPN 基本概念
- 介面角色（內/外網）的正確指定
- 最小開放原則

技能要求：
必備技能：Windows 網路、基礎路由
進階技能：VPN 安全性（憑證、L2TP/IPsec）

延伸思考：
- 可用專用設備代替以減少單點風險。
- 風險：安全面向不足。
- 優化：隔離到獨立 VM。

Practice Exercise（練習題）
基礎練習：在測試網段配置 NAT（30 分鐘）
進階練習：建立一個 PPTP VPN 並連線成功（2 小時）
專案練習：文件化 RRAS 配置與備援方案（8 小時）

Assessment Criteria（評估標準）
功能完整性（40%）：NAT 與 VPN 可用
程式碼品質（30%）：配置腳本與文件清晰
效能優化（20%）：基本吞吐與穩定
創新性（10%）：安全強化措施
```

## Case #8: 檔案伺服器在 x64 的快取與吞吐優化

### Problem Statement（問題陳述）
業務場景：主機同時扮演檔案伺服器，升級後出現 100M 網路瓶頸，意味著核心瓶頸從 CPU/磁碟轉移到網路。需在 x64 下適當調整檔案快取與網路以達到更穩定吞吐。
技術挑戰：Windows 2003 x64 的檔案快取與 TCP 參數調整。
影響範圍：檔案存取速度、備份/傳輸任務效率。
複雜度評級：中

### Root Cause Analysis（根因分析）
直接原因：
1. x64 增加系統可用 VA 與快取空間，吞吐提升。
2. 網路 100M 成為瓶頸（見 Case #5）。
3. 預設設定未針對檔案伺服器最佳化。

深層原因：
- 架構層面：單機多角色爭用 IO。
- 技術層面：快取/網路參數未調整。
- 流程層面：缺乏基準與監控。

### Solution Design（解決方案設計）
解決策略：透過登錄鍵調整 LargeSystemCache 與檔案伺服器優化，搭配網路升級與基準測試，建立可重現的吞吐曲線。

實施步驟：
1. 啟用檔案伺服器快取優化
- 實作細節：調整 LanmanServer 參數、LargeSystemCache。
- 所需資源：reg.exe、重開機維護窗。
- 預估時間：30 分鐘。

2. 建立吞吐基準與監控
- 實作細節：robocopy/iperf 與 perfmon。
- 所需資源：工具下載。
- 預估時間：1-2 小時。

關鍵程式碼/設定：
```cmd
:: 啟用大型系統快取
reg add HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Memory Management /v LargeSystemCache /t REG_DWORD /d 1 /f

:: Server 服務最佳化為檔案共享
reg add HKLM\SYSTEM\CurrentControlSet\Services\LanmanServer\Parameters /v Size /t REG_DWORD /d 3 /f
```

實際案例：升級後觀察到 100M 網路打滿，印證吞吐提升。
實作環境：Windows Server 2003 x64。
實測數據：
改善前：網路未打滿（推測受限於主機）。
改善後：網路打滿，代表伺服器側吞吐提升。
改善幅度：定性改善。

Learning Points（學習要點）
核心知識點：
- 檔案伺服器快取與網路參數
- 基準測試方法與解讀
- 瓶頸轉移判讀

技能要求：
必備技能：Windows 登錄調整、perfmon
進階技能：吞吐分析與報告

延伸思考：
- 適用於備份/大量檔案服務。
- 風險：過度快取佔用記憶體。
- 優化：升級 GBE 與磁碟陣列。

Practice Exercise（練習題）
基礎練習：套用參數並重啟觀察（30 分鐘）
進階練習：使用 robocopy 建立吞吐曲線（2 小時）
專案練習：撰寫檔案伺服器優化指南（8 小時）

Assessment Criteria（評估標準）
功能完整性（40%）：設定正確生效
程式碼品質（30%）：變更記錄與回復方案
效能優化（20%）：吞吐穩定提升
創新性（10%）：監控與警示設計
```

## Case #9: 影片轉檔到 WMV 的雙核心批次化流程

### Problem Statement（問題陳述）
業務場景：主機需將 DV/DC 影片壓成 WMV。升級為雙核心後，應善用平行處理加速轉檔，同時避免影響前台服務。
技術挑戰：在 x64 環境使用工具鏈（Windows Media Encoder 9）與腳本化批次處理；控制優先級與併發數。
影響範圍：影片轉檔速度與主機響應。
複雜度評級：中

### Root Cause Analysis（根因分析）
直接原因：
1. 單執行緒轉檔無法利用雙核心。
2. 無批量流程導致手動成本高。
3. 背景轉檔與前台服務競爭資源。

深層原因：
- 架構層面：缺乏作業佇列/計劃。
- 技術層面：未使用腳本化與優先級控管。
- 流程層面：缺乏排程與資源治理。

### Solution Design（解決方案設計）
解決策略：以 WME9 提供的自動化腳本進行批次轉碼，控制同時任務數為 2（對應雙核心），將轉碼程序設置為低優先級並於離峰時段執行。

實施步驟：
1. 建立批次轉碼腳本
- 實作細節：使用 wmcmd.vbs 或 WME COM 自動化。
- 所需資源：WME9、VBScript。
- 預估時間：1-2 小時。

2. 排程與優先權控管
- 實作細節：Task Scheduler 於離峰啟動；低優先級/CPU 親和性。
- 所需資源：排程器、批次檔。
- 預估時間：30 分鐘。

關鍵程式碼/設定：
```cmd
:: 以 wmcmd.vbs 進行轉檔（路徑視安裝而定）
cscript wmcmd.vbs -input:input.avi -output:output.wmv -v_codec:WMV9 -a_codec:WMA9

:: 低優先級啟動（避免壓垮前台）
start "" /low cscript wmcmd.vbs -input:%1 -output:%~n1.wmv ...
```

實際案例：作者將影片壓成 WMV 作為核心任務之一。
實作環境：Windows Server 2003 x64、Pentium D 920。
實測數據：
改善前：單線程或手動。
改善後：批次、自動化、並行至雙核心。
改善幅度：定性提升（文章未提供轉檔時間）。

Learning Points（學習要點）
核心知識點：
- 媒體轉碼自動化
- 優先權與親和性控制
- 併發對吞吐的影響

技能要求：
必備技能：批次/腳本、排程器
進階技能：WME COM、自訂佇列

延伸思考：
- 可替換成 ffmpeg 等現代工具。
- 風險：I/O 爭用。
- 優化：將轉碼移到獨立 VM。

Practice Exercise（練習題）
基礎練習：寫一支批次把資料夾所有 AVI 轉 WMV（30 分鐘）
進階練習：控制同時併發數量與優先級（2 小時）
專案練習：做一個可監控/重試的轉碼佇列（8 小時）

Assessment Criteria（評估標準）
功能完整性（40%）：批次成功、結果可用
程式碼品質（30%）：腳本結構與錯誤處理
效能優化（20%）：合理併發與資源控管
創新性（10%）：監控與告警
```

## Case #10: 多角色單機的資源隔離：保護 Web 服務不被背景任務拖慢

### Problem Statement（問題陳述）
業務場景：主機同時跑 Web、轉碼、檔案分享等，作者偏好讓機器「忙一點」。需避免背景工作影響前台 Web 響應。
技術挑戰：在單機上限制背景任務的 CPU/記憶體使用，合理排程與親和性設定。
影響範圍：Web SLA、使用者體驗。
複雜度評級：中

### Root Cause Analysis（根因分析）
直接原因：
1. 背景任務（轉碼等）高耗 CPU。
2. 未設優先級/親和性造成爭用。
3. 無資源上限或監控。

深層原因：
- 架構層面：多角色共機。
- 技術層面：缺乏 OS 層級資源治理。
- 流程層面：缺乏排程策略。

### Solution Design（解決方案設計）
解決策略：對背景程式設定低優先級與 CPU 親和性，必要時限制在單一核心；配合排程器在離峰執行；建立基本監控與告警。

實施步驟：
1. 設定進程優先級與親和性
- 實作細節：透過 start 參數或自製小工具。
- 所需資源：批次/小程式。
- 預估時間：30 分鐘。

2. 排程與監控
- 實作細節：Task Scheduler、perfmon 閾值告警。
- 所需資源：Windows 工具。
- 預估時間：1 小時。

關鍵程式碼/設定：
```cmd
:: 將轉碼程序設為低優先級、限用 CPU 2（十六進位 mask 02）
start "" /low /affinity 2 cscript wmcmd.vbs -input:%1 -output:%~n1.wmv ...
```

實際案例：作者同機跑多角色並長時間執行背景工作。
實作環境：Windows Server 2003 x64。
實測數據：
改善前：可能影響 Web 響應（風險）。
改善後：隔離後 Web 響應較穩定（定性）。
改善幅度：定性改善。

Learning Points（學習要點）
核心知識點：
- Windows 進程優先級/親和性
- 離峰排程策略
- 單機多角色隔離手段

技能要求：
必備技能：批次/排程器、perfmon
進階技能：更細緻的資源治理（例如在 VM 內完成）

延伸思考：
- 適用於備份/報表產生等背景任務。
- 風險：過度限制延長任務時間。
- 優化：將重負載移至 VM。

Practice Exercise（練習題）
基礎練習：對任何 CPU 密集程式套用低優先級（30 分鐘）
進階練習：不同親和性下量測 Web 響應（2 小時）
專案練習：建立背景任務排程與監控方案（8 小時）

Assessment Criteria（評估標準）
功能完整性（40%）：背景任務不影響前台
程式碼品質（30%）：腳本化與文件化完整
效能優化（20%）：響應時間穩定
創新性（10%）：隔離策略設計
```

## Case #11: 程式化偵測進程位元架構（.NET 2.0 上的 32/64 位元判斷）

### Problem Statement（問題陳述）
業務場景：在 x64 OS 上需要判斷某應用是否以 32 位元或 64 位元執行，以決定載入對應元件或採取容錯（與部落格相容議題對應）。
技術挑戰：.NET 2.0 尚無內建 Is64BitProcess 屬性，需要透過 Win32 API 判斷。
影響範圍：相容性與錯誤處理。
複雜度評級：低

### Root Cause Analysis（根因分析）
直接原因：
1. .NET 2.0 不提供直接屬性。
2. 需要透過 IsWow64Process 判斷。
3. 載入錯誤可能導致應用崩潰。

深層原因：
- 架構層面：二進位相依性。
- 技術層面：x64/WOW64 行為理解不足。
- 流程層面：缺乏啟動前檢查。

### Solution Design（解決方案設計）
解決策略：在應用啟動時偵測進程位元模式，針對 x86/x64 做相容性分支或提示，避免載入不相容模組。

實施步驟：
1. 實作偵測函式
- 實作細節：P/Invoke IsWow64Process。
- 所需資源：.NET 2.0、C#。
- 預估時間：30 分鐘。

2. 併入啟動邏輯
- 實作細節：決定載入路徑或給予提示。
- 所需資源：應用程式碼基。
- 預估時間：30 分鐘。

關鍵程式碼/設定：
```csharp
using System;
using System.Runtime.InteropServices;

class Bitness
{
    [DllImport("kernel32.dll", SetLastError=true, CallingConvention=CallingConvention.Winapi)]
    [return: MarshalAs(UnmanagedType.Bool)]
    static extern bool IsWow64Process(IntPtr hProcess, out bool wow64);

    public static bool Is64BitProcess()
    {
        if (IntPtr.Size == 8) return true; // 原生 x64
        bool isWow64;
        if (IsWow64Process(System.Diagnostics.Process.GetCurrentProcess().Handle, out isWow64))
            return !isWow64; // x86 on x64 -> wow64 = true
        return false; // 無法判斷時視為 x86
    }
}
```

實際案例：對應作者 x64 上需以 32 位元運行之網站。
實作環境：Windows Server 2003 x64、.NET 2.0。
實測數據：功能性判斷成功率 100%（API 層面）。
改善幅度：避免不相容載入導致的故障。

Learning Points（學習要點）
核心知識點：
- WOW64 判斷機制
- 啟動時的環境檢查
- 相容性分支策略

技能要求：
必備技能：P/Invoke、C#
進階技能：動態載入策略

延伸思考：
- 可用於記錄與告警，提示誤用位元架構。
- 風險：API 不存在於更舊系統。
- 優化：升 .NET 版本使用內建屬性。

Practice Exercise（練習題）
基礎練習：寫一個工具回報當前位元模式（30 分鐘）
進階練習：依位元模式載入不同 DLL（2 小時）
專案練習：將此檢查整合到部署健康檢查（8 小時）

Assessment Criteria（評估標準）
功能完整性（40%）：準確回報位元模式
程式碼品質（30%）：錯誤處理與註解
效能優化（20%）：啟動時不增加負擔
創新性（10%）：自動化報告
```

## Case #12: 無 EIST 的 Pentium D 920 前期版本之功耗/溫度治理

### Problem Statement（問題陳述）
業務場景：作者購買的 920 為早期版本，不支援 Enhanced SpeedStep（EIST），導致無法動態降頻降壓，可能帶來較高功耗與溫度。
技術挑戰：在無 EIST 的情況下降低功耗與溫度，維持穩定度。
影響範圍：電費、散熱噪音、硬體壽命。
複雜度評級：中

### Root Cause Analysis（根因分析）
直接原因：
1. 2006 Q2 前的 920 不支援 EIST。
2. 主機板/BIOS 無法提供動態節能。
3. 24/7 背景運算增加發熱。

深層原因：
- 架構層面：老舊製程與高 TDP。
- 技術層面：CPU Stepping 限制。
- 流程層面：購買前未確認規格（「功課沒做好」）。

### Solution Design（解決方案設計）
解決策略：短期採用 BIOS 手動降壓/固定較低倍頻（若主板支援）、優化散熱與機箱風道、限制背景任務利用率；中期考慮更換支援 EIST 的後期 920 或升級平台。

實施步驟：
1. 散熱與電源優化
- 實作細節：高效散熱器、導熱膏、風道管理。
- 所需資源：散熱器、風扇。
- 預估時間：1-2 小時。

2. 手動降壓/限頻（視主板）
- 實作細節：BIOS Offset Undervolt、關閉自動超頻。
- 所需資源：BIOS。
- 預估時間：30 分鐘。

3. 任務治理
- 實作細節：背景任務 CPU 使用率上限/低優先級（見 Case #10）。
- 所需資源：腳本。
- 預估時間：30 分鐘。

關鍵程式碼/設定：
```cmd
:: 以低優先級啟動耗能任務，間接降低平均功耗
start "" /low cscript wmcmd.vbs -input:%1 -output:%~n1.wmv ...
```

實際案例：作者指出其 920 不支援 EIST。
實作環境：Pentium D 920（早期版）。
實測數據：
改善前：無動態節能能力。
改善後：透過散熱/治理降低熱點（定性）。
改善幅度：定性改善（文章未提供量化）。

Learning Points（學習要點）
核心知識點：
- CPU 節能技術（EIST）與 Stepping 差異
- 散熱與功耗治理策略
- 背景任務對溫度/功耗的影響

技能要求：
必備技能：硬體散熱、BIOS 設定
進階技能：功耗監控與曲線分析

延伸思考：
- 適用於任何缺乏 DVFS 的平台。
- 風險：過度降壓不穩定。
- 優化：升級更高效率 CPU。

Practice Exercise（練習題）
基礎練習：改善風道與溫度監控（30 分鐘）
進階練習：嘗試微幅降壓並做穩定性測試（2 小時）
專案練習：建立溫度/功耗日誌與調校方案（8 小時）

Assessment Criteria（評估標準）
功能完整性（40%）：溫度在安全範圍
程式碼品質（30%）：治理腳本與文件
效能優化（20%）：噪音/功耗降低
創新性（10%）：監測可視化
```

## Case #13: 以 PerfMon 偵測並證明網路瓶頸（100M 塞滿）

### Problem Statement（問題陳述）
業務場景：需要客觀證據證明 100M 網路已成瓶頸，以支持升級至 GBE 的決策。
技術挑戰：收集與視覺化性能數據，避免只靠主觀感受。
影響範圍：IT 預算與升級時程。
複雜度評級：低

### Root Cause Analysis（根因分析）
直接原因：
1. 缺乏長期的網路介面利用率資料。
2. 未對高峰期做好記錄。
3. 無基準對照。

深層原因：
- 架構層面：監控不足。
- 技術層面：對 PerfMon/計數器不熟悉。
- 流程層面：缺少例行性能報告。

### Solution Design（解決方案設計）
解決策略：建立 PerfMon 記錄工作，持續記錄 Network Interface(*)\% Network Utilization、Bytes Total/sec 等，導出報表與圖表，以數據支撐升級。

實施步驟：
1. 建立 Data Collector
- 實作細節：使用 logman 或 GUI 建立計數器日誌。
- 所需資源：內建工具。
- 預估時間：30 分鐘。

2. 報表與決策支持
- 實作細節：定期匯出 CSV、生成圖表。
- 所需資源：Excel/腳本。
- 預估時間：1 小時。

關鍵程式碼/設定：
```cmd
:: 建立網路性能記錄（每 5 秒取樣）
logman create counter NetLog -c "\Network Interface(*)\Bytes Total/sec" "\Network Interface(*)\Output Queue Length" -si 00:00:05 -o C:\Perf\NetLog.blg
logman start NetLog
:: ...觀察一段時間後
logman stop NetLog
relog C:\Perf\NetLog.blg -f csv -o C:\Perf\NetLog.csv
```

實際案例：作者張貼 100M 網卡打滿的圖。
實作環境：Windows Server 2003 x64。
實測數據：
改善前：缺乏連續數據。
改善後：有圖有真相，支撐升級。
改善幅度：決策效率提升（定性）。

Learning Points（學習要點）
核心知識點：
- PerfMon 基礎與 logman
- 指標選擇與解讀
- 數據驅動的升級決策

技能要求：
必備技能：Windows 監控工具
進階技能：自動化報表

延伸思考：
- 可擴展至 CPU/IO/記憶體監控。
- 風險：指標解讀錯誤。
- 優化：建立門檻告警。

Practice Exercise（練習題）
基礎練習：建立網路計數器日誌（30 分鐘）
進階練習：產生周報圖表（2 小時）
專案練習：建一套最小化監控方案（8 小時）

Assessment Criteria（評估標準）
功能完整性（40%）：成功記錄與匯出
程式碼品質（30%）：腳本化、可重複
效能優化（20%）：正確指標選擇
創新性（10%）：報表自動化
```

## Case #14: 部署 SMTP 伺服器（IIS 6 SMTP）於 x64 環境

### Problem Statement（問題陳述）
業務場景：主機提供 SMTP 服務，用於系統通知與郵件轉送。需確保在 x64 環境可用與安全。
技術挑戰：IIS 6 SMTP 在 x64 為 32 位元元件，需處理相依與基本防濫發設定。
影響範圍：郵件可靠性與信譽。
複雜度評級：中

### Root Cause Analysis（根因分析）
直接原因：
1. SMTP 元件為 x86，需確認相容。
2. Relay/匿名設定容易誤用成開放中繼。
3. DNS 反查/SPF 設定不足導致退信。

深層原因：
- 架構層面：多角色共存需最小暴露。
- 技術層面：SMTP 配置細節。
- 流程層面：缺乏寄出監控。

### Solution Design（解決方案設計）
解決策略：安裝 IIS 6 SMTP，設定受信來源、限制 Relay，配置退信處理與基本 DNS/SPF，建立投遞佇列監控。

實施步驟：
1. 安裝與基本配置
- 實作細節：指定 Smart Host 或 DNS，限制 Relay。
- 所需資源：IIS 元件、DNS。
- 預估時間：1 小時。

2. 安全與監控
- 實作細節：啟用日誌、監控 Queue 長度。
- 所需資源：事件檢視器/自動化腳本。
- 預估時間：1 小時。

關鍵程式碼/設定：
```cmd
:: 啟用 SMTP 服務（透過「新增/移除 Windows 元件」）
:: 日誌位置與格式於 MMC 設定；
:: 定期檢查 C:\Inetpub\Mailroot\Queues 的佇列堆積
```

實際案例：SMTP 是作者列舉的主機服務之一。
實作環境：Windows Server 2003 x64、IIS 6 SMTP。
實測數據：功能性可用（文章未提供量化）。
改善幅度：確保郵件投遞可靠。

Learning Points（學習要點）
核心知識點：
- SMTP 基本配置與安全
- DNS/SPF/反查對送達率的影響
- 佇列監控

技能要求：
必備技能：IIS SMTP 管理、DNS
進階技能：投遞最佳化與黑名單處理

延伸思考：
- 可遷移到專門的 MTA。
- 風險：誤設為開放中繼。
- 優化：DKIM/DMARC。

Practice Exercise（練習題）
基礎練習：配置本機 SMTP 並成功寄信（30 分鐘）
進階練習：限制 Relay 與設定 SPF（2 小時）
專案練習：建立寄送監控與重試策略（8 小時）

Assessment Criteria（評估標準）
功能完整性（40%）：郵件可投遞
程式碼品質（30%）：配置文件完整
效能優化（20%）：退信率下降
創新性（10%）：監控與告警
```

## Case #15: 驗證 CPU 功能的程式化工具（CPUID：VT/EM64T）與部署前檢核

### Problem Statement（問題陳述）
業務場景：在硬體採購/部署前需快速驗證處理器是否支援 VT 與 EM64T，以避免像 820 那樣不支援 VT 的情況。
技術挑戰：跨機器快速準確檢測，並產出報告。
影響範圍：硬體選型與部署效率。
複雜度評級：低

### Root Cause Analysis（根因分析）
直接原因：
1. 人工查表易誤。
2. 無統一檢測腳本。
3. 多台主機需盤點。

深層原因：
- 架構層面：前置檢核流程缺失。
- 技術層面：對 CPUID 與工具不熟。
- 流程層面：採購前驗證未制度化。

### Solution Design（解決方案設計）
解決策略：提供可攜小工具（C/C++ 或 PowerShell+WMI）批量檢測 VT/EM64T，將結果輸出 CSV 供決策參考。

實施步驟：
1. 製作檢測程式
- 實作細節：使用 __cpuid 或第三方工具調用。
- 所需資源：編譯環境。
- 預估時間：1-2 小時。

2. 批量盤點與報告
- 實作細節：透過登入腳本/管理工具收集結果。
- 所需資源：網域/SMB。
- 預估時間：2 小時。

關鍵程式碼/設定：
```c
// 參考 Case #1 的 CPUID 程式，輸出 CSV 行：Host,VT,EM64T
```

實際案例：回應作者對 VT/EM64T 的關鍵需求。
實作環境：任意 Windows。
實測數據：減少誤選 CPU 的機率（流程改善）。
改善幅度：決策效率與正確性提升。

Learning Points（學習要點）
核心知識點：
- CPUID 與功能位
- 自動化盤點
- 部署前檢核

技能要求：
必備技能：C/C++ 或腳本
進階技能：批量收集與報表

延伸思考：
- 可擴展檢查 NX、SSE4 等特性。
- 風險：權限不足。
- 優化：加入 BIOS VT 狀態檢測（若可）。

Practice Exercise（練習題）
基礎練習：單機輸出 VT/EM64T 狀態（30 分鐘）
進階練習：批次掃描數台機器（2 小時）
專案練習：建立硬體評估報表生成器（8 小時）

Assessment Criteria（評估標準）
功能完整性（40%）：正確檢測
程式碼品質（30%）：結構與註解
效能優化（20%）：批量效率
創新性（10%）：報表呈現
```

## Case #16: 規劃端到端 GBE 升級與驗證（含佈線、設備與測試）

### Problem Statement（問題陳述）
業務場景：100M 網路已成瓶頸，需落地端到端 GBE 升級並驗證，避免「升級不完全」導致效益不彰。
技術挑戰：確保 NIC/交換器/線材/驅動全數達標與相容；建立標準驗證流程。
影響範圍：所有網路服務的吞吐與延遲。
複雜度評級：中

### Root Cause Analysis（根因分析）
直接原因：
1. 任一環節未升級都會回落至 100M。
2. 驅動與設定（如 Jumbo）未對齊。
3. 缺乏標準驗證步驟。

深層原因：
- 架構層面：端到端思維不足。
- 技術層面：設備異廠相容議題。
- 流程層面：缺乏驗證清單。

### Solution Design（解決方案設計）
解決策略：制定升級清單與驗證順序，包含硬體更換、驅動更新、OS 設定、iperf/SMB 實測；保留回退計畫。

實施步驟：
1. 清單與現況盤點
- 實作細節：列出路徑所有節點與規格。
- 所需資源：資產清冊。
- 預估時間：1 小時。

2. 分段升級與測試
- 實作細節：逐段以 iperf 驗證；最後以 SMB 實測。
- 所需資源：iperf、測試檔。
- 預估時間：2-4 小時。

關鍵程式碼/設定：
```cmd
:: NIC 進階設定（視驅動程式 GUI）
:: ipconfig /all 確認連線速率與雙工
:: iperf 同步雙向測試：iperf -c <server> -P 4 -t 30 -d
```

實際案例：呼應 Case #5 的升級計畫。
實作環境：Windows Server 2003 x64、GBE 硬體。
實測數據：
改善前：100M 打滿。
改善後：預期數百 Mbps 以上。
改善幅度：目標性改善（文章未提供實測）。

Learning Points（學習要點）
核心知識點：
- 端到端驗證方法
- 速率/雙工/MTU 協商
- 分段測試策略

技能要求：
必備技能：網路設備設定
進階技能：性能測試方法學

延伸思考：
- 擴展至 LACP、VLAN。
- 風險：混用舊線纜。
- 優化：自動化測試報告。

Practice Exercise（練習題）
基礎練習：驗證任一鏈路速率與雙工（30 分鐘）
進階練習：分段 iperf 驗證與瓶頸定位（2 小時）
專案練習：完成端到端升級與報告（8 小時）

Assessment Criteria（評估標準）
功能完整性（40%）：升級達成且驗證通過
程式碼品質（30%）：測試腳本/報告清晰
效能優化（20%）：吞吐大幅提升
創新性（10%）：驗證自動化
```

----------------
案例分類

1. 按難度分類
- 入門級（適合初學者）
  - Case 4、11、13、14、15
- 中級（需要一定基礎）
  - Case 1、3、5、6、7、8、9、10、16
- 高級（需要深厚經驗）
  - Case 2、12

2. 按技術領域分類
- 架構設計類
  - Case 1、2、6、7、10、12、16
- 效能優化類
  - Case 5、8、9、10、13、16
- 整合開發類
  - Case 3、4、9、11、15
- 除錯診斷類
  - Case 3、11、13、15
- 安全防護類
  - Case 4、7、14

3. 按學習目標分類
- 概念理解型
  - Case 1、2、4、11、12、13
- 技能練習型
  - Case 3、5、6、7、8、9、10、14、16
- 問題解決型
  - Case 3、5、7、8、10、12、15
- 創新應用型
  - Case 6、9、15、16

----------------
案例關聯圖（學習路徑建議）

- 先學：
  - Case 1（CPU/VT/EM64T 選型）→ Case 2（x64 OS 導入）
  - Case 13（PerfMon 監控基礎）作為全程支撐

- 依賴關係：
  - Case 2 → Case 3/4（IIS x86/x64 併存與 ASP.NET 2.0）
  - Case 1 → Case 6（虛擬化平台部署）→ Case 7（RRAS 可放入 VM）
  - Case 2 → Case 8（檔案伺服器優化）、Case 9/10（轉碼與資源隔離）
  - Case 5（100M 瓶頸辨識）→ Case 16（GBE 端到端升級）
  - Case 11（位元偵測）支援 Case 3（相容性分支）
  - Case 12（功耗治理）橫向支援所有重負載案例

- 完整學習路徑建議：
  1) Case 1 → 2（打好平台基礎）
  2) Case 13（建立監控）並行
  3) Web 子線：Case 4 → 3 → 11（安全最小化 → 併存與兼容 → 位元判斷）
  4) 虛擬化/網路子線：Case 6 → 7 → 5 → 16（VM 部署 → RRAS → 瓶頸辨識 → GBE 升級）
  5) 檔案/轉碼子線：Case 8 → 9 → 10（檔案優化 → 轉碼流程 → 資源隔離）
  6) 能效治理與硬體驗證：Case 12、15（全程輔助）
  7) 最後總整：回頭以 Case 13 的數據驗證整體成效，形成閉環

此學習路徑從平台打底、相容與安全、到性能與監控，逐步建立實戰能力，亦與原文情境嚴密對齊。