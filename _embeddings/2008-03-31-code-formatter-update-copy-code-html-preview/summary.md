# Code Formatter 更新：複製 CODE 及 HTML 預覽

## 摘要提示
- Live Writer外掛: 作者再次動手更新自製 Code Formatter，讓貼程式碼更便利。  
- COPY CODE: 參考 MSDN 範例區做法，一鍵將區塊程式碼複製到剪貼簿。  
- HTML PREVIEW: 同步顯示 HTML 原始碼與瀏覽效果，省去雙重貼上的麻煩。  
- C# 範例: 文章內嵌入簡易 C# 方法作示範，測試新按鈕功能。  
- HTML 範例: 利用多個 H3 標籤展示預覽成品與原始碼。  
- 使用情境: 適合常在部落格分享程式片段或前端標籤教學的作者。  
- 開發心態: 純屬「自己好用」的 side project，功能雖小卻提升效率。  
- 版控現況: 尚未打包上傳，有需求者須主動向作者索取。  
- 未來可能: 仍可追加更多貼文輔助工具，累積外掛開發經驗。  
- 讀者互動: 作者好奇是否有人使用，藉本文公開徵詢意見。  

## 全文重點
作者自稱「無聊的宅男」，再度修改 Windows Live Writer 所使用的 Code Formatter 外掛，希望貼程式碼時能更貼近 MSDN 與個人工作流程。新版核心在於「COPY CODE」與「HTML PREVIEW」兩項小功能：前者在程式碼區塊上方加入按鈕，讀者按一下即可將整段程式碼複製到剪貼簿，免去反白、右鍵或 Ctrl-C 的步驟；後者則允許作者在同一篇文章同時貼出 HTML 原始碼與它實際渲染出的畫面，不必再切到 HTML 編輯模式複製貼上。文章以簡單 C# 範例展示「COPY CODE」，另以重複 H3 標籤示範「HTML PREVIEW」。作者坦言更新並無突破性創新，只是讓自己寫技術文章更省力，目前未將安裝檔公開下載，若讀者有興趣可直接向他索取，並歡迎提供實際使用回饋。

## 段落重點
### 改版動機與整體說明
作者在使用先前版本的 Code Formatter 外掛時，發現雖然能自動幫程式碼加上框線與基本樣式，但仍缺少貼文時真正想要的「省時」功能，因此決定再次動手改寫。Live Writer 具備外掛機制，可讓作者以 .NET 開發語言快速增修需求，這次針對「複製程式碼」與「顯示 HTML 預覽」兩個情境下手。一方面參考 MSDN 網站的操作體驗，一方面滿足自己在寫教學文時常遇到的一次貼兩份（原始碼與結果）問題。整體改版維持原有介面，只在程式碼區塊上方額外插入功能按鈕，讓使用者操作上幾乎無痛升級。

### COPY CODE 功能
「COPY CODE」靈感來自 MSDN 技術文件常見的「複製」小圖示，點擊即可把範例程式碼存入剪貼簿。作者將相同概念移植到 Live Writer，當外掛偵測到程式碼區塊（以 ``` 語法或選單插入）時，就自動生成一顆按鈕並加掛 JavaScript；該腳本呼叫剪貼簿 API，支援主流瀏覽器直接寫入文字。文章中示範了一段簡短的 C# 方法 CountLeadingSpaces，讀者若於部落格前端按下 COPY CODE，即可立即複製整段 C# 內容，方便貼到 Visual Studio 或其他編輯器，不必再拖曳反白。此功能特別適合經常需要複製貼上參考程式碼的新手讀者，也減少作者在留言區重新貼範例的機率。

### HTML PREVIEW 功能
對前端相關文章而言，只顯示 HTML 原始碼往往無法直觀呈現最終效果；作者過去需要先貼原始碼，再切到 HTML 模式複製一次，或額外放截圖，非常繁瑣。新版外掛於偵測到語言型別為 html 時，除了插入 Code Formatter 區塊外，會再附帶一個包覆 div 的「即時預覽」區段，將剛才的 HTML 字串 decode 後直接渲染。如此一來，讀者能同時看到原始碼與成品，高度符合教學需求。文中例子使用五個 H3 標籤示範，透過黑色實線框住預覽區，明確區隔與正文。這個作法在畫面上不花俏，但大幅降低作者切換模式、複製貼上的時間，尤其對需要展示 CSS 或 DOM 操作效果的文章格外實用。

### 結語與釋出方式
作者強調此次僅屬微幅功能補強，並未涉及演算法或大型 UI 改造，但實務上已大幅提升個人撰寫技術文章的速度與便利性。由於仍屬「自己爽」階段，尚未整理成正式安裝檔上傳官網或 NuGet，暫時採取「需要就私訊」方式分享。作者也好奇是否真有人使用這組外掛，因此在文末呼籲有興趣的讀者可留言索取或提供意見；後續若收到正面反饋，或許會再包裝、加入設定面板與更進一步的語法糖。整體而言，此次更新再次驗證了小工具在部落格寫作流程中的巨大價值，也為作者累積了 Live Writer 外掛開發的經驗與成就感。