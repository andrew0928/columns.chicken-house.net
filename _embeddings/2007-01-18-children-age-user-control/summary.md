# 皮哥皮妹的年齡 user control

## 摘要提示
- 動機: 想在部落格自動顯示孩子的「幾歲幾個月」資訊，而不必每篇手動更新。  
- 曆法複雜度: 月份天數差異與閏年規則（四年一潤、百年不潤、四百年又潤）讓年齡計算不如想像中簡單。  
- 誤差問題: 先把出生至今換算成「總天數」再分別除以 365 與 30 的簡化算法，會造成歲、月、日皆不精準。  
- User Control 實作: 以 ASP.NET 自訂 Web User Control 名為 Age，集中處理所有複雜邏輯。  
- 介面設計: 透過屬性 birthday 與 pattern 設定生日與輸出格式，使用方式直覺簡潔。  
- 範例用法: `<CH:Age ... birthday="2000/05/20" pattern="阿扁當總統已經 {0} 年 {1} 個月了" />`。  
- 顯示結果: 依目前日期輸出「阿扁當總統已經 6 年 7 個月了」等動態文字。  
- 成就感: 作者體會到撰寫元件的「爽度」，並讓自家部落格多了一點與眾不同的客製化。  
- 實際部署: 控制項已放上「皮哥&皮妹的小天地」首頁左上角，隨時自動更新年齡。  

## 全文重點
作者時常在朋友 sea 的文章中看到「小皮幾歲幾個月、妹妹幾個月」的註記，覺得每篇手動改寫實在麻煩，遂決定利用 ASP.NET 寫一個可重複使用的 Web User Control，讓系統自動計算並顯示年齡。起初作者以為只是簡單把「出生日期到今天」換算成天數，再分別以 365 與 30 去除即可得出歲與月，但實際實作才發現曆法規則錯綜複雜：月份天數長短不一，還要考量「四年一潤、百年不潤、四百年又潤」等閏年條件。一旦忽略這些細節，歲月換算便會累積明顯誤差，最後剩餘的天數更可能全然錯誤。  

為了精準處理這些例外情況，作者把整套邏輯封裝成 Age 這個控制項，並設計兩個關鍵屬性：  
1. birthday – 指定生日字串（例如 2000/05/20）。  
2. pattern – 指定輸出格式，透過 {0}、{1} 兩個參數分別代入「年」與「月」。  

開發完成後，實際範例 `<CH:Age runat="server" birthday="2000/05/20" pattern="阿扁當總統已經 {0} 年 {1} 個月了" />` 會在網頁上即時產生「阿扁當總統已經 6 年 7 個月了」之類的結果。如此一來，部落格左上角就能自動展示皮哥與皮妹的即時年齡，日後也不用再手動修改任何數字；作者對於「寫好一次、到處使用」的元件化精神深感滿足，也讓自己的家庭部落格多了獨特的小巧思。  

## 段落重點
### 寫作動機與曆法難題
作者看到朋友 sea 常在文章標題旁標示孩子年齡，於是萌生「寫一個能自動更新的年齡控制項」的想法。實作前原以為只需簡單以天數換算，但實際思考後，意識到月份天數不一、閏年規則複雜；如果僅用 365 與 30 的平均值去除，最終歲、月、日都會出現不小誤差，無法達到精準顯示的需求。

### User Control 實作與成果展示
面對上述困難，作者選擇用 ASP.NET 寫一個名為 Age 的 Web User Control，將所有曆法邏輯封裝其中，僅透過 birthday 與 pattern 兩個屬性對外開放設定。測試範例顯示控制項能動態輸出「阿扁當總統已經 6 年 7 個月了」等字串。控制項完成後已部署在「皮哥&皮妹的小天地」首頁左上角，未來會自動隨日期變動更新年齡，省去手動改版麻煩，也讓作者享受到元件化開發帶來的成就感與客製化樂趣。